import{r as g,R as u}from"./index.da6908f5.js";import{m as c,h as S,d as J,o as _,u as ue,f as Ne,B as y,n as Te,c as Be,U as ge,P as $,r as w,F as Ee,A as Ae,C as we}from"./App.11263b70.js";import{C as xe}from"./CommonButton.0b792d77.js";import{C as W}from"./CommonDatePicker.d7bc57f8.js";import{C as te}from"./CodeHelperPopup.3932fdb9.js";import{A as Se}from"./Approval.69c4f070.js";import{A as Ve}from"./Attachments.19d97d2b.js";import"./index.6f186c21.js";import"./EvidenceViewer.5aab9677.js";const Pe=[{fieldName:"Accunit",dataType:c.exports.ValueType.TEXT},{fieldName:"Factory",dataType:c.exports.ValueType.TEXT},{fieldName:"CreditNo",dataType:c.exports.ValueType.TEXT},{fieldName:"CreditDate",dataType:c.exports.ValueType.DATE,datetimeFormat:"yyyyMMdd"},{fieldName:"DeptCd",dataType:c.exports.ValueType.TEXT},{fieldName:"DeptNm",dataType:c.exports.ValueType.TEXT},{fieldName:"Pno",dataType:c.exports.ValueType.TEXT},{fieldName:"PnoNm",dataType:c.exports.ValueType.TEXT},{fieldName:"Remark",dataType:c.exports.ValueType.TEXT},{fieldName:"CrePno",dataType:c.exports.ValueType.TEXT},{fieldName:"CreDate",dataType:c.exports.ValueType.TEXT},{fieldName:"ModPno",dataType:c.exports.ValueType.TEXT},{fieldName:"ModDate",dataType:c.exports.ValueType.TEXT},{fieldName:"ApprDocProg",dataType:c.exports.ValueType.TEXT},{fieldName:"DocStatus",dataType:c.exports.ValueType.TEXT}],Ie=[{fieldName:"ApprDocProg",Type:"data",width:80,header:{text:"\uACB0\uC7AC\uAD6C\uBD84"},styleName:"center-column"},{fieldName:"CreditDate",type:"data",width:90,datetimeFormat:"yyyy-MM-dd",styleName:"center-column",header:{text:"\uC694\uCCAD\uC77C"}},{fieldName:"CreditNo",type:"data",width:90,header:{text:"\uC694\uCCAD\uBC88\uD638"},styleName:"center-column"},{name:"DeptNm",fieldName:"DeptNm",width:75,styleName:"left-column",header:{text:"\uC694\uCCAD\uBD80\uC11C"}}],Fe=[{fieldName:"Accunit",dataType:c.exports.ValueType.TEXT},{fieldName:"Factory",dataType:c.exports.ValueType.TEXT},{fieldName:"CreditNo",dataType:c.exports.ValueType.TEXT},{fieldName:"CreditSeq",dataType:c.exports.ValueType.TEXT},{fieldName:"No",dataType:c.exports.ValueType.TEXT},{fieldName:"OldPayment",dataType:c.exports.ValueType.NUMBER},{fieldName:"NewPayment",dataType:c.exports.ValueType.NUMBER},{fieldName:"OldTerms",dataType:c.exports.ValueType.TEXT},{fieldName:"OldTermsNm",dataType:c.exports.ValueType.TEXT},{fieldName:"NewTerms",dataType:c.exports.ValueType.TEXT},{fieldName:"NewTermsNm",dataType:c.exports.ValueType.TEXT},{fieldName:"CustCd",dataType:c.exports.ValueType.TEXT},{fieldName:"CustNm",dataType:c.exports.ValueType.TEXT},{fieldName:"CustPno",dataType:c.exports.ValueType.TEXT},{fieldName:"CustPnoNm",dataType:c.exports.ValueType.TEXT},{fieldName:"DeptName",dataType:c.exports.ValueType.TEXT},{fieldName:"Remark",dataType:c.exports.ValueType.TEXT},{fieldName:"CreditDate",dataType:c.exports.ValueType.TEXT},{fieldName:"ExportYn",dataType:c.exports.ValueType.TEXT},{fieldName:"ChPay",dataType:c.exports.ValueType.TEXT},{fieldName:"ChTerm",dataType:c.exports.ValueType.TEXT}],ve=[{fieldName:"No",width:50,styleName:"center-column",editable:!1,header:{text:"NO",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{fieldName:"ExportYn",type:"data",width:55,values:["D","E"],labels:["\uB0B4\uC218","\uC218\uCD9C"],group:"exportyn",header:{text:"\uC218\uCD9C\uC5C5\uCCB4"},renderer:{type:"check",trueValues:"E",falseValues:"D"}},{fieldName:"CustNm",width:180,styleName:"left-column",button:"action",header:{text:"\uAC70\uB798\uCC98",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{fieldName:"ChPay",type:"data",width:55,header:{text:"\uD55C\uB3C4\uBCC0\uACBD"},renderer:{type:"check",trueValues:"Y",falseValues:"N"}},{fieldName:"OldPayment",width:110,styleName:"right-column rg-disable-cell",editable:!1,header:{text:"\uAE30\uC874 \uC124\uC815\uD55C\uB3C4",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{type:"number",editFormat:"#,##0"},numberFormat:"#,##0"},{fieldName:"NewPayment",width:110,styleName:"right-column ",header:{text:"\uBCC0\uACBD \uC694\uCCAD\uD55C\uB3C4",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{type:"number",editFormat:"#,##0"},numberFormat:"#,##0"},{fieldName:"ChTerm",type:"data",width:80,header:{text:"\uACB0\uC81C\uC870\uAC74 \uBCC0\uACBD"},renderer:{type:"check",trueValues:"Y",falseValues:"N"}},{fieldName:"OldTermsNm",width:130,styleName:"center-column rg-disable-cell",editable:!1,header:{text:"\uAE30\uC874 \uACB0\uC81C\uC870\uAC74",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{maxLength:60}},{fieldName:"NewTermsNm",width:130,styleName:"center-column ",button:"action",header:{text:"\uBCC0\uACBD\uC694\uCCAD \uACB0\uC81C\uC870\uAC74",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{maxLength:15}},{fieldName:"CustPnoNm",width:90,styleName:"center-column rg-disable-cell",editable:!1,header:{text:"\uAC70\uB798\uCC98 \uB2F4\uB2F9\uC790",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{maxLength:15}},{fieldName:"CreditDate",width:100,styleName:"center-column rg-disable-cell",editable:!1,header:{text:"\uC694\uCCAD\uC77C\uC790"},renderer:{type:"text"}},{fieldName:"Remark",width:210,styleName:"left-column",placeHolder:"\uCD5C\uB30050\uC790",header:{text:"\uBE44\uACE0",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{maxLength:50}}],ke={Scroll:{"& .mainCon":{height:"700px",padding:"10px"}},SA1:{width:70,height:25,margin:"3px 3px",backgroundColor:"#e0ecff",color:"#163971",paddingTop:3,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SA2:{marginTop:-2,marginLeft:5,alignItems:"center",textAlign:"center"},SA4:{width:100,height:25,"& input":{fontSize:"12px !important"}},SA5:{marginLeft:5,width:140,height:25,"& input":{fontSize:"12px !important"}},SC1:{width:90,height:25,margin:"3px 10px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SC2:{width:80},SC3:{width:200,height:25,"& input":{fontSize:"12px !important"}},SC4:{display:"flex",alignItems:"center"},RadioLabel:{width:75,fontSize:12,marginLeft:2},Radio:{width:15,height:15}};function re(){const[e,m]=g.exports.useState({SchAccunit:"",SchFactory:"",SchFrDate:new Date,SchToDate:new Date,ChkApprDocProg:"Y",SchType:"0",SchText:""}),[N,s]=g.exports.useState({Accunit:"",Factory:"",CreditNo:"",CreditDate:"",DeptCd:"",DeptNm:"",Pno:"",PnoNm:"",Remark:"",CrePno:"",CreDate:"",ModPno:"",ModDate:"",ApprDocProg:"",DocStatus:""}),[D]=g.exports.useState({DeptCd:"required",DeptNm:"required",Pno:"required",PnoNm:"required",CreditDate:"required"}),[f,l]=g.exports.useState(""),[n,A]=g.exports.useState({visible:!1,desc:"",type:"N"}),[k,E]=g.exports.useState({visible:!1,desc:"",id:""}),[M,Y]=g.exports.useState(!1),P=["No","CustNm"],[I,L]=g.exports.useState({visible:!1,description:"",value:"",datas:{},id:"",viewId:"",selectedData:{}}),[U]=g.exports.useState([{value:"0",text:"\uC694\uCCAD\uBC88\uD638"},{value:"1",text:"\uC694\uCCAD\uC77C\uC790"},{value:"2",text:"\uBD80\uC11C\uBA85"}]);return String.prototype.DateValidation=function(O){return new Date(this)instanceof Date&&!isNaN(new Date(this))?S(this).format(O):null},{searchVO:e,setSearchVO:m,headerVO:N,setHeaderVO:s,gridFocus:f,setGridFocus:l,alert:n,setAlert:A,confirm:k,setConfirm:E,codeClassInputs:I,setCodeClassInputs:L,ValidationRules:D,attachView:M,setAttachView:Y,validationFields:P,cboSchType:U}}const Me=async(e,m,N)=>{e({SchAccunit:"",SchFactory:"",SchFrDate:S().clone().startOf("month").toDate(),SchToDate:new Date,ChkApprDocProg:"Y",SchType:"0",SchText:""},50),m({Accunit:"",Factory:"",CreditNo:"",CreditDate:new Date,DeptCd:N.user.deptcd,DeptNm:N.user.deptnm,Pno:N.user.userid,PnoNm:N.user.username.trim(),Remark:"",CrePno:"",CreDate:"",ModPno:"",ModDate:"",ApprDocProg:"",DocStatus:"\uACB0\uC7AC \xB7 \uBBF8\uC0C1\uC2E0",DocSource:"CC"},50)},be=(e,m)=>{m({Accunit:"",Factory:"",CreditNo:"",CreditDate:new Date,DeptCd:e.User.user.deptcd,DeptNm:e.User.user.deptnm,Pno:e.User.user.userid,PnoNm:e.User.user.username.trim(),Remark:"",CrePno:"",CreDate:"",ModPno:"",ModDate:"",ApprDocProg:"",DocStatus:"\uACB0\uC7AC \xB7 \uBBF8\uC0C1\uC2E0",DocSource:"CC"})},H=async(e,m,N,s,D,f,l)=>{if(e.Util.Common.fValidate(!S(m.SchFrDate,"YYYY-MM-DD").isValid()||!S(m.SchToDate,"YYYY-MM-DD").isValid(),"\uC870\uD68C\uAE30\uAC04\uC744 \uBC14\uB974\uAC8C \uC785\uB825\uD574 \uC8FC\uC138\uC694.")||e.Util.Common.fValidate(S(m.SchFrDate).format("YYYYMMDD")>S(m.SchToDate).format("YYYYMMDD"),"\uC870\uD68C\uAE30\uAC04\uC744 \uD655\uC778\uD574 \uC8FC\uC138\uC694."))return;const n={...m};if(l!=null){const A=S(l.current).format("YYYY-MM-DD"),k=S(m.SchFrDate).format("YYYY-MM-DD"),E=S(m.SchToDate).format("YYYY-MM-DD");A<k?(n.SchFrDate=S(A).format("YYYYMMDD"),ae(A,"fr",e,N)):A>E&&(n.SchToDate=S(A).format("YYYYMMDD"),ae(A,"to",e,N))}f&&(n.ChkApprDocProg=f.current==="\uACB0\uC7AC \xB7 \uC9C4\uD589\uC911"?"N":m.ChkApprDocProg),n.SchAccunit=e.User.user.accunit,n.SchFactory=e.User.user.factory,n.UserId=e.User.user.userid,n.SchFrDate=S(n.SchFrDate).format("YYYYMMDD"),n.SchToDate=S(n.SchToDate).format("YYYYMMDD"),await e.Util.Command.fSearch(s,"/@api/business/custCreditMng/selectByList",n,D)},ae=(e,m,N,s)=>{m==="fr"?N.Util.Common.fFieldChange(s,"SchFrDate",e):N.Util.Common.fFieldChange(s,"SchToDate",e)},Ce=async(e,m,N,s,D)=>{const f={...m};f.Factory=e.User.user.factory,f.Accunit=e.User.user.accunit,f.UserId=e.User.user.userid,f.CreditNo=D;try{const l=await e.Util.Command.fSearchByReturn("/@api/business/custCreditMng/selectByDetailList",f);l===void 0||l.length<1?e.Util.Grid.fNewRow(N,{No:"001"}):N.setRows(l),s.clearCurrent()}catch{e.setAlert({visible:!0,desc:"\uC0C1\uC138\uB0B4\uC5ED \uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}},Ye=async(e,m,N,s,D,f,l,n,A,k)=>{n.commit();const E={...s};E.CreditDate=S(s.CreditDate).format("YYYYMMDD"),E.Accunit=e.User.user.accunit,E.Factory=e.User.user.factory,E.UserId=e.User.user.userid;let M=[];if(e.Util.Grid.fCheckGridData(f,M,A,"\uC0C1\uC138")===void 0)try{const I=(await J.post("/@api/business/custCreditMng/updateByList",{header:E,detail:M})).data;if(I.errmess!=="")return e.setAlert({visible:!0,desc:I.errmess,type:"E"}),I.CreditNo;const L=I.CreditNo?I.CreditNo.trim():s.CreditNo.trim();e.setAlert({visible:!0,desc:"\uBB38\uC11C \uC800\uC7A5\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),H(e,m,N,D,"\uAC70\uB798\uCC98 \uC2E0\uC6A9\uAD00\uB9AC","",k).then(()=>{const U=D.searchData({fields:["CreditNo"],value:L,partialMatch:!0});U!=null&&l.setCurrent({dataRow:U.dataRow,column:0})})}catch(P){e.setAlert({visible:!0,desc:`\uC800\uC7A5 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.
${P}`})}},Re=async(e,m,N,s,D)=>{const f={...m};f.Accunit=e.User.user.accunit,f.Factory=e.User.user.factory;try{const n=(await J.post("/@api/business/custCreditMng/deleteByList",{data:f})).data;if(n.errmess!=""){e.setAlert({visible:!0,desc:n.errmess,type:"E"});return}else await e.Util.Command.fDeleteFiles("custCreditMng",n.List),e.setAlert({visible:!0,desc:"\uAC70\uB798\uCC98\uBCC4 \uC2E0\uC6A9\uD55C\uB3C4 \uAD00\uB9AC\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."});setTimeout(async()=>{await H(e,N,"",s,"\uAC70\uB798\uCC98\uBCC4 \uC2E0\uC6A9\uD55C\uB3C4 \uAD00\uB9AC"),D.setCurrent({itemIndex:0,column:0})},100)}catch(l){e.setAlert({visible:!0,desc:`\uC0AD\uC81C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.
 ${l}`})}},Ue=async(e,m,N,s,D,f)=>{const l={...m};l.Accunit=e.User.user.accunit,l.Factory=e.User.user.factory,await e.Util.Command.fDeleteCheckItem(D,s,"/@api/business/custCreditMng/deleteByItem",l,"\uAC70\uB798\uCC98\uBCC4 \uC5EC\uC2E0\uD55C\uB3C4 \uAD00\uB9AC \uC0C1\uC138\uB0B4\uC5ED"),setTimeout(async()=>{await Ce(e,N,s,D,f)},100)},Ge=_(e=>{const m="CUSTCREDITMNG",N=g.exports.useRef(null),s=g.exports.useRef(0),{$CommonStore:D,$UserStore:f}=ue(),{codeClassInputs:l,setCodeClassInputs:n,validationFields:A}=re(),k=["NewTermsNm","CustNm"],E=async(o,C,t)=>{if(!!C){try{const d=(await J.get("/@api/business/custCreditMng/searchOldCredit",{params:{SchAccunit:f.user.accunit,SchCustCd:C,ExportYn:t,SchFactory:f.user.factory}})).data;d&&e.Util.Grid.fSetMultiDataProvider(r,o,{OldPayment:d[0].OldPayment,NewPayment:d[0].OldPayment,OldTerms:d[0].OldTerms,OldTermsNm:d[0].OldTermsNm,NewTerms:d[0].OldTerms,NewTermsNm:d[0].OldTermsNm,CustPnoNm:d[0].CustPnoNm,DeptName:d[0].DeptNm})}catch{e.setAlert({visible:!0,desc:"\uAE30\uC874 \uC124\uC815\uD55C\uB3C4 \uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.",type:"E"})}T.validateCells()}},M=async()=>{T.commit(!0);const o=l.selectedData,C=D.Codeclass.selData,t=o.dataRow,p=r.getValue(t,"ExportYn");if(o.column==="CustNm")e.Util.Grid.fSetMultiDataProvider(r,o.dataRow,{CustCd:C.custcd,CustNm:C.custnm}),E(t,C.custcd,p);else if(o.column==="NewTermsNm"){const d=r.getValue(t,"OldTerms").trim();e.Util.Grid.fSetMultiDataProvider(r,o.dataRow,{NewTerms:C.minorcd,NewTermsNm:C.minornm}),d===C.minorcd.trim()&&(e.setAlert({visible:!0,desc:"\uAE30\uC874 \uACB0\uC81C\uC870\uAC74\uACFC \uAC19\uC2B5\uB2C8\uB2E4.",type:"W"}),r.setValue(t,"NewTermsNm",""),r.setValue(t,"NewTerms",""))}n({visible:!1,desc:"",value:"",datas:{},selectedData:{},id:"",viewId:""}),T.commit(!0),T.setFocus(),T.validateCells()},Y=o=>{const C=T.getCurrent().itemIndex;o.target==="CustNm"&&e.Util.Grid.fSetDataProvider(r,C,["CustNm","CustCd"],void 0),T.setCurrent({itemIndex:C,fieldName:T.getCurrent().fieldName}),T.setFocus(),T.validateCells(),n({visible:!1})},P=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),r=new c.exports.LocalDataProvider(!1),T=new c.exports.GridView(N.current),e.Util.Grid.fInitGridDetail(T,r,e.GridFields,e.GridColumns,I,L,O),T.displayOptions.rowHeight=25,T.setRowIndicator({visible:!1}),T.onItemChecked=()=>{e.setGridFocus("R")},T.onShowEditor=function(o,C){if(C.column==="NewPayment"&&r.getValue(C.dataRow,"ChPay")==="N"||C.column==="NewTermsNm"&&r.getValue(C.dataRow,"ChTerm")==="N")return!1},T.onCellClicked=function(o){const{fieldName:C,itemIndex:t}=o.getCurrent();if(C==="ChPay"&&r.getValue(t,"ChPay")==="Y")r.setValue(t,"NewPayment",0);else if(C==="ChTerm"&&r.getValue(t,"ChTerm")==="Y")r.setValue(t,"NewTermsNm",""),r.setValue(t,"NewTerms","");else if(C==="ChPay"&&r.getValue(t,"ChPay")==="N")r.setValue(t,"NewPayment",r.getValue(t,"OldPayment"));else if(C==="ChTerm"&&r.getValue(t,"ChTerm")==="N")r.setValue(t,"NewTerms",r.getValue(t,"OldTerms")),r.setValue(t,"NewTermsNm",r.getValue(t,"OldTermsNm"));else if(C==="ExportYn"&&r.getValue(t,"ExportYn")==="E"){const p=r.getValue(t,"CustCd");E(t,p,"E")}else if(C==="ExportYn"&&r.getValue(t,"ExportYn")==="D"){const p=r.getValue(t,"CustCd");E(t,p,"D")}},T.onValidateColumn=(o,C,t,p)=>{const d={},{dataRow:h}=o.getCurrent(),V=["No","CustNm","NewPayment"],F=["No","CustNm","NewTermsNm"];return A.includes(C.fieldName)&&(!p||p===void 0)&&(d.level="warning",d.message="\uD544\uC218 \uC785\uB825 \uAC12\uC785\uB2C8\uB2E4."),o.getValue(h,"ChPay")==="Y"&&V.includes(C.fieldName)&&(!p||p===void 0||p===0)&&(d.level="warning",d.message="\uD544\uC218 \uC785\uB825 \uAC12\uC785\uB2C8\uB2E4."),o.getValue(h,"ChTerm")==="Y"&&F.includes(C.fieldName)&&(!p||p===void 0)&&(d.level="warning",d.message="\uD544\uC218 \uC785\uB825 \uAC12\uC785\uB2C8\uB2E4."),d},r.onRowInserted=(o,C)=>{e.Util.Grid.fSetMultiDataProvider(o,C,{No:Te(C+1).format("000"),Accunit:f.user.accunit,Factory:f.user.factory,CreditDate:S(e.CreDate.current).format("YYYY-MM-DD"),ExportYn:"D",ChPay:"N",ChTerm:"N"})},e.DataProviderBind(r),e.GridViewBind(T),T.getDataSource().addRow([])},I=async o=>{o.commit(),e.setGridFocus("R");const{fieldName:C,itemIndex:t}=o.getCurrent(),p=o.getValue(t,C);let d={};if(C==="CustNm")d=await e.Util.Grid.gridCodeClass(o.getCurrent(),e.Util.CodeHelper.helperCust,m,p,!0);else if(r.getValue(t,"ChTerm")==="Y"&&C==="NewTermsNm")d=await e.Util.Grid.gridCodeClass(o.getCurrent(),e.Util.CodeHelper.helperCustTerms,m,p,!0);else return;let h=0;d.datas[0].map(V=>{h+=Number(V.Size)}),s.current=h<470?470:h+80,n(d)},L=o=>{o.commit(),e.setGridFocus("R");const{column:C,dataRow:t}=o.getCurrent(),p=o.getValue(t,C);if(p===null||p==="")(C==="CustCd"||C==="CustNm")&&e.Util.Grid.fSetDataProvider(r,t,["CustNm","CustCd"],void 0);else if(C){if(C==="NewPayment"&&r.getValue(t,"ChPay")==="N")r.setValue(t,"NewPayment",r.getValue(t,"OldPayment"));else if(C==="NewTermsNm"&&r.getValue(t,"ChTerm")==="N")r.setValue(t,"NewTerms",r.getValue(t,"OldTerms")),r.setValue(t,"NewTermsNm",r.getValue(t,"OldTermsNm"));else if(C==="ChPay"&&r.getValue(t,"ChPay")==="N")r.setValue(t,"NewPayment",r.getValue(t,"OldPayment"));else if(C==="ChTerm"&&r.getValue(t,"ChTerm")==="N")r.setValue(t,"NewTerms",r.getValue(t,"OldTerms")),r.setValue(t,"NewTermsNm",r.getValue(t,"OldTermsNm"));else if(C==="ChPay"&&r.getValue(t,"ChPay")==="Y")r.setValue(t,"NewPayment",0);else if(C==="ChTerm"&&r.getValue(t,"ChTerm")==="Y")r.setValue(t,"NewTerms",""),r.setValue(t,"NewTermsNm","");else if(C==="ExportYn"&&r.getValue(t,"ExportYn")==="E"){const d=r.getValue(t,"CustCd");E(t,d,"E")}else if(C==="ExportYn"&&r.getValue(t,"ExportYn")==="D"){const d=r.getValue(t,"CustCd");E(t,d,"D")}else if(C==="NewPayment"&&r.getValue(t,"ChPay")==="Y"){const d=r.getValue(t,"NewPayment"),h=r.getValue(t,"OldPayment");d===h&&(e.setAlert({visible:!0,desc:"\uAE30\uC874 \uC124\uC815\uD55C\uB3C4\uC640 \uAC19\uC2B5\uB2C8\uB2E4.",type:"W"}),r.setValue(t,"NewPayment",0))}}T.validateCells()},U=async(o,C,t)=>{o.setCurrent({itemIndex:t,fieldName:C});const p=o.getValue(t,C);let d={};const h=r.getValue(t,"ExportYn");if(p!==""||k.includes(C)){if(C==="CustNm"){if(d=await e.Util.Grid.gridCodeClass(o.getCurrent(),e.Util.CodeHelper.helperCust,m,p,!1),!d.visible){const F=d.res;e.Util.Grid.fSetMultiDataProvider(r,t,{CustCd:F.custcd,CustNm:F.custnm}),E(t,F.custcd,h)}}else if(C==="NewTermsNm"&&r.getValue(t,"ChTerm")==="Y"){if(d=await e.Util.Grid.gridCodeClass(o.getCurrent(),e.Util.CodeHelper.helperCustTerms,m,p,!1),!d.visible){const F=d.res;e.Util.Grid.fSetMultiDataProvider(r,t,{NewTerms:F.minorcd,NewTermsNm:F.minornm})}}else return;let V=0;d.datas[0].map(F=>{V+=Number(F.Size)}),s.current=V<470?470:V+80,n(d)}},O=async(o,C)=>{const t="Remark",p=o.getDataSource().getRowCount(),{fieldName:d}=o.getCurrent(),{itemIndex:h}=o.getCurrent();switch(e.setGridFocus("R"),C.key){case"Enter":e.setAlert({visible:!1,desc:""}),o.commit(!0),d===t?e.Util.Grid.fEnterLastField(o,h,p,i()===0):(o.getDataSource().getValue(h,d)||k.includes(d))&&U(o,d,h),o.setFocus();break;case"Escape":e.Util.Grid.fEscape(o,h,p,"No");break;case"Insert":e.Util.Grid.fKeyInsert(o,h,i()===0,"No");break;case"ArrowDown":e.Util.Grid.fArrowDown(o,h,p,i()===0,"No");break;case"ArrowUp":e.Util.Grid.fArrowUp(o,h,p,i(h)>0);break;case(C.shiftKey&&"Tab"):C.preventDefault(),document.getElementById(e.Util.Common.fMakeId("Remark")).focus();break;case"Tab":C.preventDefault(),document.getElementById(e.Util.Common.fMakeId("Factorynm")).focus();break;case(C.ctrlKey&&" "):I(o);break}},i=o=>{const C=r.getAllStateRows().created,{dataRow:t}=T.getCurrent();if(C.length>0){let p=0;return C.map(d=>{if(o===void 0||d>=o){const h=T.getValues(d);r.getValue(t,"ChPay")==="Y"?(!h.CustNm||h.CustNm===void 0||!h.NewPayment||h.NewPayment===void 0)&&(p+=1):r.getValue(t,"ChTerm")==="Y"?(!h.CustNm||h.CustNm===void 0||!h.NewTerms||h.NewTerms===void 0)&&(p+=1):(!h.CustNm||h.CustNm===void 0)&&(p+=1)}}),p}return 0};return g.exports.useEffect(()=>{P()},[]),u.createElement(u.Fragment,null,u.createElement(Ne,{visible:l.visible,description:l.desc,value:l.value,datas:l.datas,id:l.id,viewId:l.viewId,selectedData:l.selectedData,width:s.current,onConfirm:M,onCancel:()=>Y({target:l.id})}),u.createElement(y,{ref:N,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:405}}))});let r,T;const Le=_(e=>{const m=g.exports.useRef(null),N=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),q=new c.exports.LocalDataProvider(!1),X=new c.exports.GridView(m.current),e.Util.Grid.fInitGridHeader(X,q,e.GridFields,e.GridColumns,30,s,D,f,e.GridTitle),X.setRowIndicator({visible:!1}),X.onCellDblClicked=function(){document.getElementById(e.Util.Common.fMakeId("Remark")).focus()},X.setRowStyleCallback((l,n)=>{if(l.getValue(n.index,"ApprDocProg")==="\uBC18\uB824")return"rg-column-color-1";if(l.getValue(n.index,"ApprDocProg")==="\uC644\uACB0")return"rg-column-color-3";if(l.getValue(n.index,"ApprDocProg")==="\uC9C4\uD589\uC911")return"rg-column-color-2"}),e.DataProviderBind(q),e.GridViewBind(X)},s=async(l,n,A)=>{A>=0&&e.RowChanged(l,A)},D=(l,n)=>{e.currentIndex.current===n.dataRow&&n.dataRow>=0&&e.RowChanged(l,n.dataRow)},f=async(l,n)=>{switch(n.key){case(n.shiftKey&&"Tab"):n.preventDefault(),document.getElementById(e.Util.Common.fMakeId("SchText")).focus();break;case"Tab":n.preventDefault(),document.getElementById(e.Util.Common.fMakeId("SchFrDate")).focus();break}};return g.exports.useEffect(()=>{N()},[]),u.createElement(u.Fragment,null,u.createElement(y,{ref:m,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:e.Height}}))});let q,X;const je=_(()=>{const e="CUSTCREDITMNG",{$CommonStore:m,$UserStore:N}=ue(),s=Oe(),{searchVO:D,setSearchVO:f,headerVO:l,setHeaderVO:n,gridFocus:A,setGridFocus:k,alert:E,setAlert:M,confirm:Y,setConfirm:P,ValidationRules:I,cboSchType:L,attachView:U,setAttachView:O}=re(),i=new ge(e,M,!0,!0,!0,!0,!0),o=g.exports.useRef(""),C=g.exports.useRef(0),t=g.exports.useRef(new Date),p=g.exports.useRef(null),d=g.exports.useRef(!0),h=async()=>{m.fSetBinding(!0),await Me(f,n,N),m.fSetBinding(!1),o.current="",i.Common.fSetTabIndex(),document.getElementById(i.Common.fMakeId("Remark")).maxLength=120},[V]=g.exports.useState({Util:i,User:N,fInit:h,setAlert:M,setHeaderVO:n}),F=a=>{G=a},oe=a=>{x=a},ie=a=>{R=a},le=a=>{b=a},se=(a,B)=>{b.commit(!0),k("H"),x.clearRows();const v=G.getJsonRow(B);o.current===v.CreditNo&&(d.current=!d.current),o.current=v.CreditNo,t.current=v.CreditDate,n(v),Ce(V,D,x,b,v.CreditNo),setTimeout(()=>{C.current=B},100)},K=(a,B)=>{B&&f({...D,ChkApprDocProg:a})},ne=a=>{const B=D.ChkApprDocProg;a.key==="ArrowRight"?(B==="Y"&&f({...D,ChkApprDocProg:"N"}),B==="N"&&f({...D,ChkApprDocProg:"Y"})):a.key==="ArrowLeft"?(B==="N"&&f({...D,ChkApprDocProg:"Y"}),B==="Y"&&f({...D,ChkApprDocProg:"N"})):a.shiftKey&&a.key==="Tab"?(a.preventDefault(),document.getElementById(i.Common.fMakeId("SchFrDate")).focus()):a.key==="Tab"&&(a.preventDefault(),document.getElementById(i.Common.fMakeId("SchType")).focus())},j=(a,B,v)=>{switch(a){case"DeptNm":i.Common.fMultiFieldChange(n,{DeptCd:B,DeptNm:v});return;case"PnoNm":i.Common.fMultiFieldChange(n,{Pno:B,PnoNm:v})}},de=a=>{p.current=a,n({...l,DocStatus:a}),K("N","checked"),H(V,D,f,G,"\uC5EC\uC2E0\uD55C\uB3C4 \uAD00\uB9AC \uBAA9\uB85D",p,t),setTimeout(()=>{const B=G.searchData({fields:["CreditNo"],value:o.current,partialMatch:!0});B!=null&&R.setCurrent({dataRow:B.dataRow,column:0})},300)},ce=()=>{i.Common.fValidate(o.current==="",`\uC5EC\uC2E0\uD55C\uB3C4 \uAD00\uB9AC\uBC88\uD638\uAC00 \uC120\uD0DD\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4. 
\uD655\uC778\uD574 \uC8FC\uC2ED\uC2DC\uC624.`)||O(!0)},me=()=>{O(!1)},fe=a=>{i.Common.fFieldChange(n,"CreditDate",a),t.current=a,x.getJsonRows().forEach((v,he)=>{x.setValue(he,"CreditDate",S(a).format("YYYY-MM-DD"))})},pe=async()=>{P({visible:!1,desc:"",id:""});const{dataRow:a}=b.getCurrent();let B={};if(a>=0?x.getValue(a,"ChPay")==="Y"&&x.getValue(a,"ChTerm")==="Y"?B={CustNm:"\uAC70\uB798\uCC98",NewTerms:"\uBCC0\uACBD\uC694\uCCAD \uACB0\uC81C\uC870\uAC74",NewPayment:"\uBCC0\uACBD\uC694\uCCAD\uD55C\uB3C4"}:x.getValue(a,"ChPay")==="Y"&&x.getValue(a,"ChTerm")==="N"?B={CustNm:"\uAC70\uB798\uCC98",NewPayment:"\uBCC0\uACBD\uC694\uCCAD\uD55C\uB3C4"}:x.getValue(a,"ChPay")==="N"&&x.getValue(a,"ChTerm")==="Y"&&(B={CustNm:"\uAC70\uB798\uCC98",NewTerms:"\uBCC0\uACBD\uC694\uCCAD \uACB0\uC81C\uC870\uAC74"}):B={CustNm:"\uAC70\uB798\uCC98"},Y.id==="SAVE"){const v=await Ye(V,D,f,l,G,x,R,b,B,t);o.current=v,i.Common.fFieldChange(n,"CreditNo",v)}else Y.id==="DELETE"?await Re(V,l,D,G,R):Y.id==="DELETE_ITEM"&&await Ue(V,l,D,x,b,o.current)},De=()=>{P({visible:!1,desc:"",id:""})},z=async()=>{setTimeout(()=>{document.getElementById(i.Common.fMakeId("CreditDate")).focus()},100),be(V,n),x.clearRows(),t.current=new Date,o.current="",i.Grid.fNewRow(x,{No:"001"})},Q=async()=>{z(),i.Grid.fNewRow(x,{No:"001"}),await H(V,D,f,G,"\uAC70\uB798\uCC98\uBCC4 \uC5EC\uC2E0\uAD00\uB9AC \uBAA9\uB85D"),setTimeout(()=>{document.getElementById(i.Common.fMakeId("SchText")).focus()},100)},Z=async()=>{i.Common.fValidate(!l.CreditDate,"\uC791\uC131\uC77C\uC790\uAC00 \uC81C\uB300\uB85C \uC785\uB825\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4")||i.Common.fValidate(!l.DeptCd,"\uC601\uC5C5\uB2F4\uB2F9\uBD80\uC11C\uAC00 \uC81C\uB300\uB85C \uC785\uB825\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4")||i.Common.fValidate(!l.Pno,"\uC601\uC5C5\uB2F4\uB2F9\uC790\uAC00 \uC81C\uB300\uB85C \uC785\uB825\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4")||((t.current===null||t.current==="")&&(t.current=l.CreditDate),b.commit(),P({visible:!0,desc:"\uC800\uC7A5\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",id:"SAVE"}))},ee=async()=>{if(!i.Common.fValidate(!l.CreditNo,"\uC5EC\uC2E0\uD55C\uB3C4 \uAD00\uB9AC\uAC00 \uC120\uD0DD\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.")){if(b.commit(!0),A==="H")P({visible:!0,desc:`\uC8FC\uC758) ${o.current} \uBB38\uC11C\uB97C \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`,id:"DELETE"});else if(A==="R"){if(i.Common.fValidate(b.getCheckedItems(!0).length<1,"\uC0AD\uC81C\uD55C \uC138\uBD80\uB0B4\uC5ED\uC744 \uC120\uD0DD\uD558\uC138\uC694."))return;P({visible:!0,desc:`${o.current} \uC138\uBD80\uB0B4\uC5ED\uC744 \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`,id:"DELETE_ITEM"})}}},ye=async()=>{};return g.exports.useEffect(()=>{i.Common.fHotKey(m,m.isPopup,z,Q,Z,ee)},[m.HotKey]),g.exports.useEffect(()=>(h(),document.getElementById(i.Common.fMakeId("SchFrDate")).focus(),()=>{m.fSetHotKey()}),[]),u.createElement(u.Fragment,null,u.createElement(xe,{pgmid:e,visible:"111101",onNew:z,onSearch:Q,onSave:Z,onDelete:ee,onPrint:ye,onAttachment:ce}),u.createElement($,{className:"mainCon"},u.createElement(w.exports.Layout,{style:{width:"100%",height:775}},u.createElement(w.exports.LayoutPanel,{region:"west",split:!0,style:{minWidth:370,maxWidth:480,height:775}},u.createElement($,{className:s.Scroll},u.createElement(y,{style:{marginLeft:5,marginTop:5}},u.createElement(y,{display:"flex",alignItems:"center"},u.createElement(y,{className:s.SA1},u.createElement(y,{className:s.SA2},"\uAE30\uAC04")),u.createElement(y,{style:{marginLeft:5},onKeyDown:a=>{a.shiftKey&&a.keyCode===9?(a.preventDefault(),R.setFocus()):a.keyCode===9&&(a.preventDefault(),document.getElementById(i.Common.fMakeId("SchToDate")).focus())}},u.createElement(W,{inputCls:"inputCls",selected:D.SchFrDate,inputId:i.Common.fMakeId("SchFrDate"),onHandleDateChange:a=>i.Common.fFieldChange(f,"SchFrDate",a)})),u.createElement(y,{style:{margin:"0 3px",width:"10px"}},"~"),u.createElement(W,{inputCls:"inputCls",selected:D.SchToDate,inputId:i.Common.fMakeId("SchToDate"),onHandleDateChange:a=>i.Common.fFieldChange(f,"SchToDate",a)})),u.createElement(y,{display:"flex",alignItems:"center"},u.createElement(y,{className:s.SA1},u.createElement(y,{className:s.SA2},"\uACB0\uC7AC\uC0C1\uD0DC")),u.createElement(y,{id:i.Common.fMakeId("radioBox"),onKeyDown:a=>ne(a),className:"inputCls",style:{display:"flex",flexDirection:"row",border:"1px solid #9ac9ed",borderRadius:5,height:27,width:235,alignItems:"center",justifyContent:"center",marginLeft:5}},u.createElement(y,{style:{marginLeft:5}},u.createElement(w.exports.RadioButton,{className:s.Radio,inputId:i.Common.fMakeId("all"),value:"Y",groupValue:D.ChkApprDocProg,onChange:a=>K("Y",a),inputCls:"inputCls"}),u.createElement(w.exports.Label,{htmlFor:i.Common.fMakeId("all"),className:s.RadioLabel,style:{width:100}},"\uC791\uC131\uC911+\uBC18\uB824")),u.createElement(y,{style:{marginLeft:5}},u.createElement(w.exports.RadioButton,{className:s.Radio,inputId:i.Common.fMakeId("complated"),value:"N",groupValue:D.ChkApprDocProg,onChange:a=>K("N",a),inputCls:"inputCls"}),u.createElement(w.exports.Label,{htmlFor:i.Common.fMakeId("complated"),className:s.RadioLabel},"\uC804\uCCB4")))),u.createElement(y,{display:"flex",alignItems:"center"},u.createElement(y,{className:s.SA1},u.createElement(y,{className:s.SA2},"\uAC80\uC0C9")),u.createElement(w.exports.ComboBox,{inputCls:"inputCls",inputId:i.Common.fMakeId("SchType"),data:L,value:D.SchType,editable:!1,onChange:a=>i.Common.fFieldChange(f,"SchType",a),onSelectionChange:a=>{i.Common.fGridSort(R,a.value,{0:"CreditNo",1:"CreditDate",2:"DeptNm"})},className:s.SA4,panelStyle:{height:100},style:{marginLeft:5}}),u.createElement(y,{onKeyDown:a=>{a.shiftKey&&a.keyCode===9?(a.preventDefault(),document.getElementById(i.Common.fMakeId("SchType")).focus()):a.keyCode===9&&(a.preventDefault(),R.setFocus())}},u.createElement(w.exports.TextBox,{inputCls:"inputCls",inputId:i.Common.fMakeId("SchText"),onChange:a=>{R.commit(),i.Common.fFieldChange(f,"SchText",a),i.Common.fSearchMatch(R,G,D.SchType,{0:"CreditNo",1:"CreditDate",2:"DeptNm"},a)},value:D.SchText,className:s.SA5,style:{width:130}})))),u.createElement(y,{style:{marginTop:5}},u.createElement(Le,{Util:i,Id:"Grid1",GridTitle:"\uD5E4\uB354",Height:670,currentIndex:C,GridFields:Pe,GridColumns:Ie,RowChanged:se,DataProviderBind:F,GridViewBind:ie})))),u.createElement(w.exports.LayoutPanel,{region:"center",style:{height:775}},u.createElement($,null,u.createElement(w.exports.Form,{style:{maxWidth:"100%",marginTop:5},model:l,rules:I},u.createElement(y,{style:{display:"flex",flexDirection:"column"}},u.createElement(y,{className:s.SC4,onKeyDown:a=>{a.shiftKey&&a.keyCode===9?(a.preventDefault(),b.setFocus()):a.keyCode===9&&(a.preventDefault(),document.getElementById(i.Common.fMakeId("DeptNm")).focus())}},u.createElement(y,{className:s.SC1},"\uACF5\uC7A5\uBA85"),u.createElement(w.exports.TextBox,{inputId:i.Common.fMakeId("Factorynm"),inputCls:"inputCls",value:N.user.factorynm,editable:!1,className:s.SC3})),u.createElement(y,{className:s.SC4},u.createElement(y,{className:s.SC1},"\uC791\uC131\uBC88\uD638"),u.createElement(w.exports.TextBox,{inputCls:"inputCls",name:"CreditNo",inputId:i.Common.fMakeId("CreditNo"),value:l.CreditNo,onChange:a=>i.Common.fFieldChange(n,"CreditNo",a),className:s.SC3,editable:!1})),u.createElement(y,{className:s.SC4},u.createElement(y,{className:s.SC1},u.createElement(y,{className:s.SC2},"\uC791\uC131\uC77C\uC790"),u.createElement(Ee,{style:{color:"#ffa8a8"},size:12})),u.createElement(W,{inputId:i.Common.fMakeId("CreditDate"),inputCls:"inputCls",selected:l.CreditDate,onHandleDateChange:a=>{fe(a)},disabled:!!o.current,inputRequired:!0,style:{width:160}})),u.createElement(te,{title:"\uC601\uC5C5\uB2F4\uB2F9\uBD80\uC11C",inputCls:"inputCls",pgmid:e,inputType:"Dept",id:"DeptNm",helper:i.CodeHelper.helperDeptNm,ComponentCode:l.DeptCd,ComponentValue:l.DeptNm,SetValue:j,labelStyles:{width:90,height:25,margin:"3px 10px 5px 10px",padding:5,fontSize:12,display:"flex",alignItems:"center",fontWeight:600},inputStyles:{width:200,margin:"0px 0px 5px 0px"},inputRequired:!0,onConfirm:()=>{}}),u.createElement(te,{title:"\uC601\uC5C5\uB2F4\uB2F9\uC790",inputCls:"inputCls",pgmid:e,inputType:"Pno",id:"PnoNm",helper:i.CodeHelper.helperPnoNm2,ComponentCode:l.Pno,ComponentValue:l.PnoNm,SetValue:j,labelStyles:{width:90,height:25,margin:"3px 10px 5px 10px",padding:5,fontSize:12,display:"flex",alignItems:"center",fontWeight:600},inputStyles:{width:200,margin:"0px 0px 5px 0px"},inputRequired:!0,onConfirm:()=>{}}),u.createElement(y,{className:s.SC4},u.createElement(y,{className:s.SC1},"\uCD5C\uCD08\uC791\uC131\uC77C"),u.createElement(w.exports.TextBox,{inputCls:"inputCls",name:"CreDate",inputId:i.Common.fMakeId("CreDate"),value:l.CreDate,onChange:a=>i.Common.fFieldChange(n,"CreDate",a),className:s.SC3})),u.createElement(y,{className:s.SC4},u.createElement(y,{className:s.SC1},"\uCD5C\uC885\uC218\uC815\uC77C"),u.createElement(w.exports.TextBox,{inputCls:"inputCls",name:"ModDate",inputId:i.Common.fMakeId("ModDate"),value:l.ModDate,onChange:a=>i.Common.fFieldChange(n,"ModDate",a),className:s.SC3})),u.createElement(y,{className:s.SC4,style:{marginBottom:5},onKeyDown:a=>{a.shiftKey&&a.key==="Tab"?(a.preventDefault(),document.getElementById(i.Common.fMakeId("ModDate")).focus()):a.key==="Tab"&&(a.preventDefault(),b.setFocus())}},u.createElement(y,{className:s.SC1},"\uBE44\uACE0"),u.createElement(w.exports.TextBox,{inputCls:"inputCls",name:"Remark",inputId:i.Common.fMakeId("Remark"),value:l.Remark,onChange:a=>i.Common.fFieldChange(n,"Remark",a),className:s.SC3,placeholder:"\uCD5C\uB300 60\uC790",multiline:!0,style:{width:500}})),u.createElement(y,null))),u.createElement(y,{style:{marginTop:100}},u.createElement(Ge,{Util:i,Id:"Grid2",GridTitle:"\uBA85\uC138",GridFields:Fe,GridColumns:ve,setGridFocus:k,setAlert:M,DataProviderBind:oe,GridViewBind:le,CreDate:t,UserStore:N})))),u.createElement(w.exports.LayoutPanel,{region:"east",title:l.DocStatus,collapsible:!0,collapsed:!0,expander:!0,style:{width:400}},u.createElement(y,{style:{marginTop:10}},u.createElement(Se,{PGMID:e,ApprovalType:"A",ApprovalDocNo:o.current,ApprovalDocSource:"CC",ApprovalDocFlag:"C",AttachmentsKeyName:"\uC5EC\uC2E0\uD55C\uB3C4 \uAD00\uB9AC\uBC88\uD638",RetrieveFlag:d.current,MaxRevNo:0,RevNo:0,SetTitle:de,isImageComponent:!0,isAttachments:!0,filepath:"custCreditMng"}))))),U&&u.createElement(Ve,{PGMID:e,FileTitle:"\uC5EC\uC2E0\uAD00\uB9AC \uBC88\uD638",FileType:"CC",FileNo:o.current,FilePath:"custCreditMng",setClose:me}),u.createElement(Ae,{visible:E.visible,description:E.desc,type:E.type,onConfirm:()=>M({visible:!1})}),u.createElement(we,{visible:Y.visible,description:Y.desc,onCancel:De,onConfirm:pe}))});let G,x,R,b;const Oe=Be(ke);export{je as default};
