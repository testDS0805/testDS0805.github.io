import{R as e,r as s}from"./index.da6908f5.js";import{o as Q,x as Z,B as r,r as b,y as K,z as J,m as P,u as ae,U as se,f as ie,A as te,E as ce,H as Ce,I as me,C as pe,d as O,R as de,P as fe,q as Be}from"./App.11263b70.js";import{E as ye}from"./EvidenceViewer.5aab9677.js";import{A as Ee}from"./Attachments.19d97d2b.js";const Ae=Q(({classes:C,ApprovalDisabled:v,ApprovalCancelDisabled:F,ApprovalRemarkDisabled:p,ApprovalReturnDisabled:E,onClickApproval:m,onClickApprovalCancel:A,onClickApprovalRemark:x,onClickApprovalReturn:g,isReturnButton:o})=>e.createElement(e.Fragment,null,e.createElement(r,{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(b.exports.LinkButton,{style:{width:o?90:100,color:"#424242",borderRadius:3,marginRight:o?5:15},disabled:v,onClick:m},e.createElement(r,{style:{width:o?90:100,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(K,{size:18}),e.createElement(r,{className:C.Box1},"\uACB0\uC7AC\uC0C1\uC2E0"),e.createElement(J,{size:18}))),e.createElement(b.exports.LinkButton,{style:{width:o?90:100,color:"#424242",borderRadius:3,marginRight:o?5:15},disabled:F,onClick:A},e.createElement(r,{style:{width:o?90:100,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(K,{size:18}),e.createElement(r,{className:C.Box1},"\uC0C1\uC2E0\uCDE8\uC18C"),e.createElement(J,{size:18}))),o&&e.createElement(b.exports.LinkButton,{style:{width:o?90:100,color:"#424242",borderRadius:3,marginRight:o?5:15},disabled:E,onClick:g},e.createElement(r,{style:{width:o?90:100,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(K,{size:18}),e.createElement(r,{className:C.Box1},"\uBC18\uB824"),e.createElement(J,{size:18}))),e.createElement(b.exports.LinkButton,{style:{width:o?90:100,color:"#424242",borderRadius:3},disabled:p,onClick:x},e.createElement(r,{style:{width:o?90:100,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(K,{size:18}),e.createElement(r,{className:C.Box1},"\uCCA8\uC5B8\uBCF4\uAE30"),e.createElement(J,{size:18})))))),ge={Box1:{fontSize:12,paddingBottom:2,fontWeight:500}},he=Z(ge)(Ae),xe=[{fieldName:"ApprGubun",dataType:P.exports.ValueType.TEXT},{fieldName:"ApprId",dataType:P.exports.ValueType.TEXT},{fieldName:"ApprNm",dataType:P.exports.ValueType.TEXT},{fieldName:"ApprPos",dataType:P.exports.ValueType.TEXT},{fieldName:"ApprPosNm",dataType:P.exports.ValueType.TEXT},{fieldName:"ApprSeq",dataType:P.exports.ValueType.NUMBER},{fieldName:"CloseFlag",dataType:P.exports.ValueType.TEXT},{fieldName:"ProcessYmd",dataType:P.exports.ValueType.TEXT},{fieldName:"Seq",dataType:P.exports.ValueType.NUMBER},{fieldName:"isNewFlag",dataType:P.exports.ValueType.TEXT}],De=[{name:"ApprSeq",fieldName:"ApprSeq",width:35,styleName:"center-column",editable:!1,header:{text:"\uC21C\uBC88",showTooltip:!0},renderer:{type:"text",showTooltip:!0},numberFormat:"#,##0"},{name:"ApprNm",fieldName:"ApprNm",width:70,styleName:"left-column",button:"action",editable:!0,header:{text:"\uACB0\uC7AC\uC790",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"ApprPosNm",fieldName:"ApprPosNm",width:90,styleName:"left-column",button:"action",editable:!0,header:{text:"\uC9C1\uCC45",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"CloseFlag",fieldName:"CloseFlag",width:35,editable:!1,styleName:"center-column",header:{text:"\uC804\uACB0",showTooltip:!0},renderer:{type:"check",trueValues:"Y",falseValues:"N"}},{name:"ProcessYmd",fieldName:"ProcessYmd",width:90,styleName:"center-column",editable:!1,header:{text:"\uCC98\uB9AC\uC77C\uC2DC",showTooltip:!0},renderer:{type:"text",showTooltip:!0}}],we=Q(({classes:C,PGMID:v,Init:F,ApprovalType:p,ApprovalDocNo:E,ApprovalDocSource:m,Retrieve:A,GetDataSource:x})=>{const{$CommonStore:g,$UserStore:o}=ae(),[I,U]=s.exports.useState({visible:!1,desc:"",type:"N"}),a=new se(v,U,!0,!0,!0,!0,!1),M=s.exports.useRef(null),W=["ApprNm","ApprPosNm"],[D,L]=s.exports.useState({visible:!1,description:"",value:"",datas:{},id:"",viewId:"",selectedData:{}}),z=()=>{a.Grid.fContainerInit(a.Common.fMakeId("Grid1")),y=new P.exports.LocalDataProvider(!1),S=new P.exports.GridView(M.current),a.Grid.fInitGridDetail(S,y,xe,De,d,j,R),S.setRowIndicator({visible:!1}),S.setCheckBar({visible:!1}),y.onRowInserted=(t,n)=>{a.Grid.fSetMultiDataProvider(t,n,{ApprGubun:"A",ApprSeq:n+1,CloseFlag:"N"})}},d=async(t,n)=>{t.commit();const h=t.getValue(t.getCurrent().itemIndex,n.fieldName);let B={};n.fieldName==="ApprNm"?(B=await a.Grid.gridCodeClass(t.getCurrent(),a.CodeHelper.helperPnoNm2,v,h,!0),L(B)):n.fieldName==="ApprPosNm"&&(B=await a.Grid.gridCodeClass(t.getCurrent(),a.CodeHelper.helperApprPosNm,v,h,!0),L(B))},j=t=>{let n=0;const h=t.getCurrent(),B=t.getValue(h.itemIndex,h.column);if(t.commit(),h.column==="ApprNm")(B===null||B==="")&&a.Grid.fSetMultiDataProvider(y,h.dataRow,{ApprId:void 0,ApprNm:void 0});else if(h.column==="ApprPosNm")(B===null||B==="")&&a.Grid.fSetMultiDataProvider(y,h.dataRow,{ApprPos:void 0,ApprPosNm:void 0});else if(h.column==="CloseFlag"){const f=t.getDataSource().getJsonRows();if(f.forEach(l=>{l.CloseFlag==="Y"&&(n+=1)}),n>1){f.forEach((l,i)=>{a.Grid.fSetMultiDataProvider(y,i,{CloseFlag:"N"})}),a.Grid.fSetMultiDataProvider(y,h.dataRow,{CloseFlag:"Y"});return}}S.validateCells()},R=async(t,n)=>{const h="ProcessYmd",B=t.getDataSource().getRowCount(),{fieldName:f}=t.getCurrent(),{itemIndex:l}=t.getCurrent();switch(n.key){case"Enter":if(U({visible:!1,desc:""}),t.commit(!0),f===h)a.Grid.fEnterLastField(t,l,B,$()===0);else if((t.getDataSource().getValue(l,f)||W.includes(f))&&(f==="ApprNm"||f==="ApprPosNm")){t.setCurrent({itemIndex:l,fieldName:f});const i=t.getValue(l,f);let c={};(i!==""||W.includes(f))&&(f==="ApprNm"?(c=await a.Grid.gridCodeClass(t.getCurrent(),a.CodeHelper.helperPnoNm2,v,i,!1),c.visible||a.Grid.fSetMultiDataProvider(y,l,{ApprId:c.res.pno,ApprNm:c.res.name})):f==="ApprPosNm"&&(c=await a.Grid.gridCodeClass(t.getCurrent(),a.CodeHelper.helperApprPosNm,v,i,!1),c.visible||a.Grid.fSetDataProvider(y,l,["ApprPos","ApprPosNm"],c.res)),L(c))}t.setFocus();break;case"Escape":a.Grid.fEscape(t,l,B,"ApprSeq",!1);break;case"Insert":a.Grid.fKeyInsert(t,l,$()===0,"ApprSeq",!1);break;case"ArrowDown":a.Grid.fArrowDown(t,l,B,$()===0,"ApprSeq",!1);break;case"ArrowUp":a.Grid.fArrowUp(t,l,B,$(l)>0);break}},$=t=>{const n=y.getAllStateRows().created;if(n.length>0){let h=0;return n.map(B=>{if(t===void 0||B>=t){const f=S.getValues(B);(!f.ApprId||f.ApprId===void 0)&&(h+=1)}}),h}return 0},X=async()=>{S.commit(!0);const t=D.selectedData;t.column==="ApprNm"?a.Grid.fSetMultiDataProvider(y,t.dataRow,{ApprId:a.Common.fTrim(g.Codeclass.selData.pno),ApprNm:a.Common.fTrim(g.Codeclass.selData.name)}):t.column==="ApprPosNm"&&a.Grid.fSetMultiDataProvider(y,t.dataRow,{ApprPos:a.Common.fTrim(g.Codeclass.selData.minorcd),ApprPosNm:a.Common.fTrim(g.Codeclass.selData.minornm)}),L({visible:!1,desc:"",value:"",datas:{},selectedData:{},id:"",viewId:""}),S.commit(!0),S.setFocus(),S.validateCells()},V=t=>{const n=S.getCurrent().itemIndex;t.target==="ApprNm"?a.Grid.fSetDataProvider(y,n,["ApprId","ApprNm"],void 0):t.target==="ApprPosNm"&&a.Grid.fSetDataProvider(y,n,["ApprPos","ApprPosNm"],void 0),S.setCurrent({itemIndex:n,fieldName:S.getCurrent().fieldName}),S.setFocus(),L({visible:!1})},q=async()=>{const t={};t.ApprovalType=p,t.ApprovalDocNo=E,t.ApprovalDocSource=m,t.UserPno=o.user.userid,t.Factory=o.user.factory;try{const n=await a.Command.fSearchByReturnTrim("/@api/common/appr/selectByApprovalLine",t);if(!n){a.Grid.fNewRow(y,{ApprSeq:"1"}),x(y);return}y.setRows(n),x(y),n[0].isNewFlag==="Y"&&y.getRows().forEach((B,f)=>{y.setRowState(f,"created",!1,!1)})}catch(n){U({visible:!0,desc:`\uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4..${n}`})}};return s.exports.useEffect(()=>{z()},[]),s.exports.useEffect(()=>{if(a.Common.fEmptyReturn(E)===""){y.clearRows();return}q()},[E]),s.exports.useEffect(()=>{if(a.Common.fEmptyReturn(E)===""){y.clearRows();return}q()},[F]),s.exports.useEffect(()=>{a.Common.fEmptyReturn(E)!==""&&q()},[A]),e.createElement(e.Fragment,null,e.createElement(r,{style:{marginTop:10,marginLeft:10,width:"95%",display:"flex",alignItems:"center",justifyContent:"flex-end"}},e.createElement(r,{style:{width:"100%"}},e.createElement(r,{className:C.BoxTitle},"\uACB0\uC7AC\uB77C\uC778"),e.createElement(r,{ref:M,id:a.Common.fMakeId("Grid1"),style:{width:"100%",height:110}}))),e.createElement(ie,{visible:D.visible,description:D.desc,value:D.value,datas:D.datas,id:D.id,viewId:D.viewId,selectedData:D.selectedData,onConfirm:X,onCancel:()=>V({target:D.id})}),e.createElement(te,{visible:I.visible,description:I.desc,type:I.type,onConfirm:()=>U({visible:!1})}))});let y,S;const be={BoxTitle:{backgroundColor:"#fccf76",color:"#163971",fontWeight:600,fontSize:"12px",width:"100%",display:"flex",justifyItems:"center",alignItems:"center",marginTop:1}},ve=Z(be)(we),ke=Q(({classes:C,PGMID:v,ApprovalDocSource:F,ApprovalDocNo:p,filepath:E})=>{const{$UserStore:m}=ae(),A=s.exports.useRef(""),x=s.exports.useRef(null),g=s.exports.useRef(!1),[o,I]=s.exports.useState({}),[U,a]=s.exports.useState(!1),[M,W]=s.exports.useState({}),[D,L]=s.exports.useState({visible:!1,desc:"",id:""}),[z,d]=s.exports.useState({visible:!1,desc:"",type:"N"}),[j,R]=s.exports.useState(),[$,X]=s.exports.useState(0);s.exports.useEffect(()=>{const c=setInterval(()=>{X(k=>k+1)},1e3);return()=>{clearInterval(c)}});const V=new se(v,d,!1,!1,!0,!1,!1),q=()=>{A.current=V.Common.fGetFilePath(E),I({})},t=async c=>{const k=c[0].name;if(V.Common.fValidate(!p,"\uC2E0\uADDC \uC790\uB8CC\uB294 \uC800\uC7A5 \uD6C4 \uC774\uBBF8\uC9C0\uB97C \uB4F1\uB85D\uD558\uC5EC \uC8FC\uC138\uC694."))return;if(c&&k.length>76){d({visible:!0,desc:"\uD30C\uC77C\uBA85\uC774 \uB108\uBB34 \uAE41\uB2C8\uB2E4. \uD30C\uC77C\uBA85\uC744 \uBCC0\uACBD\uD558\uC5EC \uC8FC\uC138\uC694.",type:"W"});return}if(c&&!V.Common.fFileExtensionCheck(k,["gif","jpg","jpeg","png"])){d({visible:!0,desc:"\uD5C8\uC6A9\uB418\uB294 \uC774\uBBF8\uC9C0 \uD655\uC7A5\uC790 \uD30C\uC77C\uC774 \uC544\uB2D9\uB2C8\uB2E4.",type:"W"});return}if(c&&!V.Common.fFileSizeCheck(c[0].size,"MB",10)){d({visible:!0,desc:"\uC774\uBBF8\uC9C0 \uC6A9\uB7C9\uC774 10MB\uB97C \uCD08\uACFC\uD569\uB2C8\uB2E4. \uC774\uBBF8\uC9C0\uB97C \uD3B8\uC9D1\uD558\uC5EC \uC62C\uB824\uC8FC\uC138\uC694.",type:"W"});return}let N=new FormData;c&&c.length>0&&N.append("file",c[0]);try{const Y=(await O.post("/@api/common/appr/insertByPhotoFile",N,{headers:{"Content-Type":"multipart/form-data"},params:{upath:E}})).data.find(re=>re.originalname===k).filename,H={DocNo:p,DocSource:F,Factory:m.user.factory,Photo:Y,Path:E,UserId:m.user.userid},_=(await O.post("/@api/common/appr/insertByPhoto",{data:H})).data;_.errmess===""?(d({visible:!0,desc:"\uB4F1\uB85D\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),x.current=_.rtnSeq,setTimeout(()=>{l()},1500)):d({visible:!0,desc:_.errmess,type:"W"})}catch{d({visible:!0,desc:"\uC774\uBBF8\uC9C0 \uB4F1\uB85D\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}},n=()=>{V.Common.fValidate(!o.Seq,"\uC0AD\uC81C\uD560 \uC774\uBBF8\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.")||L({visible:!0,desc:"\uD574\uB2F9 \uC774\uBBF8\uC9C0\uB97C \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",id:"DELETE_IMAGE"})},h=async()=>{L({visible:!1,desc:"",id:""}),D.id==="DELETE_IMAGE"&&B()},B=async()=>{const c={DocSource:F,DocNo:p,Factory:m.user.factory,Seq:o.Seq,Photo:o.Photo,Path:E,UserId:m.user.userid};try{const N=(await O.post("/@api/common/appr/deleteByPhoto",{data:c})).data;N.errmess===""?(d({visible:!0,desc:"\uC0AD\uC81C\uAC00 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),x.current=N.rtnSeq,setTimeout(()=>{l()},1500)):d({visible:!0,desc:N.errmess,type:"W"})}catch{d({visible:!0,desc:"\uC774\uBBF8\uC9C0 \uC0AD\uC81C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}},f=()=>{L({visible:!1,desc:"",id:""})},l=async c=>{if(!x.current||!p)return;const k={};k.Factory=m.user.factory,k.DocSource=F,k.DocNo=p,k.Tag=c,k.Seq=x.current;try{const G=(await O.get("/@api/common/appr/selectByImage",{params:k})).data;V.Common.fTrim(G.errmess)!==""?d({visible:!0,desc:G.errmess}):G.list===void 0||G.list===null?I({}):(await I(G.list[0]),c==="B"?x.current=x.current-1:c==="N"&&(x.current=x.current+1))}catch{d({visible:!0,desc:"\uC774\uBBF8\uC9C0 \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}},i=()=>{const N=window.screenX+(window.outerWidth-790)/2,G=window.screenY+(window.outerHeight-900)/2,ee=`/imagePopup?DocSource=${F}&DocNo=${p}&FilePath=${E}`,Y=window.open(ee,"ImagePopup",`width=${790},height=${900},left=${N},top=${G}`);R(Y)};return s.exports.useEffect(()=>{q()},[]),s.exports.useEffect(()=>{q(),V.Common.fEmptyReturn(p)!==""&&(x.current=1,l(),g.current&&i())},[p]),s.exports.useEffect(()=>{if(j)j.closed?(R(),g.current=!1):g.current=!0;else{g.current=!1;return}},[$]),e.createElement(e.Fragment,null,e.createElement(r,{style:{width:"95%",height:300,marginLeft:10,marginTop:10}},e.createElement(r,{className:C.BoxTitle},"\uC99D\uBE59\uC790\uB8CC"),e.createElement(r,{style:{margin:1,display:"flex",alignItems:"end"}},e.createElement(r,{style:{marginTop:5,width:260,height:280,border:"1px solid #95b8e7",overflow:"hidden"}},e.createElement("img",{src:`${A.current}/${o.Photo}`,alt:"\uCCA8\uBD80\uC774\uBBF8\uC9C0",style:{width:"100%",height:"100%",objectFit:"cover"}})),e.createElement(r,{style:{width:98,marginLeft:10}},e.createElement(b.exports.FileButton,{style:{width:95,borderRadius:3,marginLeft:5},onSelect:c=>t(c),onClick:c=>{c.target.value=null},accept:"image/gif, image/jpg, image/jpeg, image/png",disabled:!p},e.createElement(r,{style:{width:95,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(ce,{size:18}),e.createElement(r,{className:C.Button1},"\uC774\uBBF8\uC9C0\uB4F1\uB85D"))),e.createElement(b.exports.LinkButton,{disabled:!p,style:{width:95,color:"#424242",borderRadius:3,marginLeft:5,marginTop:10},onClick:()=>n()},e.createElement(r,{style:{width:95,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(Ce,{size:18}),e.createElement(r,{className:C.Button1},"\uC774\uBBF8\uC9C0\uC0AD\uC81C"))),e.createElement(b.exports.LinkButton,{disabled:!p,style:{width:95,color:"#424242",borderRadius:3,marginLeft:5,marginTop:20},onClick:()=>i()},e.createElement(r,{style:{width:95,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(me,{size:18}),e.createElement(r,{className:C.Button1,style:{marginRight:8}},"\uD06C\uAC8C\uBCF4\uAE30"))),e.createElement(r,{style:{marginLeft:5,display:"grid"}},e.createElement(b.exports.TextBox,{style:{width:95},className:C.Box2,editable:!1,value:o.Seq}),e.createElement(r,{style:{display:"flex",marginTop:10}},e.createElement(b.exports.LinkButton,{disabled:!p,style:{width:45,height:30,color:"#424242",borderRadius:3},onClick:()=>l("B")},e.createElement(r,{style:{width:45,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(K,{size:18}))),e.createElement(b.exports.LinkButton,{disabled:!p,style:{width:45,height:30,color:"#424242",borderRadius:3,marginLeft:5},onClick:()=>l("N")},e.createElement(r,{style:{width:45,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(J,{size:18})))))))),e.createElement(te,{visible:z.visible,description:z.desc,type:z.type,onConfirm:()=>d({visible:!1})}),e.createElement(pe,{visible:D.visible,description:D.desc,onCancel:f,onConfirm:h}),e.createElement(ye,{visible:U,docVO:M,onCancel:()=>{a(!1)},onUpdate:()=>{a(!1),l()}}))}),Te={Box1:{fontSize:12,paddingBottom:2,fontWeight:500},Box2:{width:150,height:25,marginTop:20,"& input":{fontSize:"12px !important",textAlign:"center"}},BoxTitle:{backgroundColor:"#fccf76",color:"#163971",fontWeight:600,fontSize:"12px",width:"100%",display:"flex",justifyItems:"center",alignItems:"center",marginTop:1},Button1:{fontSize:12,paddingBottom:2,fontWeight:500,marginLeft:5}},Ie=Z(Te)(ke),Fe=Q(({classes:C,PGMID:v,FileType:F,FileNo:p,IsRevision:E,RevNo:m,FilePath:A,AttachmentsKeyName:x,AttachmentCount:g})=>{const[o,I]=s.exports.useState(!1),[U,a]=s.exports.useState(0),M=()=>{I(!0)},W=D=>{a(D),I(!1)};return s.exports.useEffect(()=>{g!==void 0&&a(g)},[g]),e.createElement(e.Fragment,null,e.createElement(r,{style:{width:"95%",height:50,marginLeft:10,marginTop:10}},e.createElement(b.exports.LinkButton,{style:{width:"100%",color:"#424242",borderRadius:3,background:U?"#ffb3b3":"#a9cff9"},onClick:M},e.createElement(r,{style:{width:100,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(de,{size:18}),e.createElement(r,{className:C.Box1},"\uCCA8\uBD80\uD30C\uC77C")))),o&&e.createElement(Ee,{PGMID:v,FileTitle:x,FileType:F,FileNo:p,IsRevision:E,RevNo:m,FilePath:A,setClose:W}))}),Re={Box1:{fontSize:12,paddingBottom:2,fontWeight:500},Box2:{width:150,height:25,marginTop:20,"& input":{fontSize:"12px !important",textAlign:"center"}},BoxTitle:{backgroundColor:"#fccf76",color:"#163971",fontWeight:600,fontSize:"12px",width:"100%",display:"flex",justifyItems:"center",alignItems:"center",marginTop:1},Button1:{fontSize:12,paddingBottom:2,fontWeight:500,marginLeft:5}},Se=Z(Re)(Fe),Ne=({visible:C,docVO:v,onCancel:F})=>{const[p,E]=s.exports.useState([]),[m,A]=s.exports.useState({visible:!1,desc:"",type:"N"}),x=async()=>{try{const I=(await O.get("/@api/common/apprremarkviewer/selectByInfo",{params:{DocNo:v.DocNo,DocSource:v.DocSource,Factory:v.Factory}})).data;E(I||[])}catch{A({visible:!0,desc:"\uCCA8\uC5B8 \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}};s.exports.useEffect(()=>{C&&(E([]),x())},[C]);const g=()=>e.createElement(r,{key:"title",style:{display:"flex",alignItems:"center"}},e.createElement("img",{src:Be,alt:"logo",style:{marginLeft:5,width:27}}),e.createElement(r,{disabled:!0,style:{margin:"3px 10px",fontWeight:"bold",color:"#898989"}},"\uCCA8\uC5B8\uBCF4\uAE30"));return C?e.createElement(e.Fragment,null,e.createElement(b.exports.Dialog,{header:g,style:{width:400,height:400},bodyCls:"f-column",closable:!1,modal:!0},e.createElement(r,{className:"f-full",style:{display:"flex",alignItems:"center"}},e.createElement(r,{style:{display:"flex",flexDirection:"column",paddingLeft:3}},e.createElement(fe,{style:{minHeight:300,maxHeight:300}},e.createElement(r,{style:{width:380,height:300,display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start"}},p.map(o=>e.createElement(r,{key:o.Seq},o.ApprComment)))))),e.createElement(r,{className:"dialog-button",style:{display:"flex",flexDirection:"row",justifyContent:"center"}},e.createElement(b.exports.LinkButton,{style:{width:"80px"},onClick:F},"\uB2EB\uAE30"))),e.createElement(te,{visible:m.visible,description:m.desc,type:m.type,onConfirm:()=>A({visible:!1})})):null},Pe=Q(({classes:C,PGMID:v,Init:F,ApprovalType:p="A",ApprovalDocFlag:E="A",ApprovalDocNo:m,ApprovalDocSource:A,AttachmentsKeyName:x,MaxRevNo:g,RevNo:o,isImageComponent:I,isAttachments:U,isRevision:a,filepath:M,SetTitle:W,isReturnButton:D,RetrieveFlag:L})=>{const z=v+"_APPROVAL",{$UserStore:d}=ae(),j=s.exports.useRef(null),R=s.exports.useRef(),[$,X]=s.exports.useState(!1),[V,q]=s.exports.useState({}),[t,n]=s.exports.useState({DocRemark:"",AcctRemark:"",ApprDocFlag:"",ApprRemFlag:"",DocApprUrl1:"",ApprovalDisabled:!0,ApprovalCancelDisabled:!0,ApprovalRemarkDisabled:!0,ApprovalReturnDisabled:!0}),[h,B]=s.exports.useState(0),[f,l]=s.exports.useState({visible:!1,desc:"",type:"N"}),i=new se(z,l,!0,!0,!0,!0,!0),c=()=>{n({DocRemark:"",AcctRemark:"",ApprDocFlag:"",ApprRemFlag:"",DocApprUrl1:"",ApprovalDisabled:!0,ApprovalCancelDisabled:!0,ApprovalRemarkDisabled:!0,ApprovalReturnDisabled:!0},50)},k=u=>{u!=null&&u!=null&&(j.current=u)},N=()=>{i.Common.fValidate(j.current.getRowCount()<1,"\uACB0\uC7AC\uB77C\uC778\uC774 \uC9C0\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.")||i.Common.fValidate(g!==o,"\uB9C8\uC9C0\uB9C9 \uB9AC\uBE44\uC804\uC774 \uC544\uB2D9\uB2C8\uB2E4. \uACB0\uC7AC\uC0C1\uC2E0 \uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")||_()},G=()=>{i.Common.fValidate(g!==o,"\uB9C8\uC9C0\uB9C9 \uB9AC\uBE44\uC804\uC774 \uC544\uB2D9\uB2C8\uB2E4. \uC0C1\uC2E0\uCDE8\uC18C \uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")||re()},ee=()=>{q({DocSource:A,DocNo:m,Factory:d.user.factory}),X(!0)},Y=()=>{i.Common.fValidate(g!==o,"\uB9C8\uC9C0\uB9C9 \uB9AC\uBE44\uC804\uC774 \uC544\uB2D9\uB2C8\uB2E4. \uBC18\uB824 \uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")||le()},H=async u=>{if(!m)return;const T={};T.ApprovalType=p,T.ApprovalDocNo=m,T.ApprovalDocSource=A,T.RevNo=o,T.UserPno=d.user.userid,T.Factory=d.user.factory;const w=await i.Command.fSearchByReturn("/@api/common/appr/selectByApprovalInfo",T);if(w.List===null){i.Common.fMultiFieldChange(n,{DocRemark:void 0,AcctRemark:void 0,DocApprUrl1:void 0,ApprovalDisabled:!1,ApprovalCancelDisabled:!0,ApprovalRemarkDisabled:!0,ApprovalReturnDisabled:!0}),B(i.Common.fTrim(w.ReturnNo));return}else i.Common.fMultiFieldChange(n,{DocRemark:w.List[0].DocRemark,AcctRemark:w.List[0].AcctRemark,DocApprUrl1:w.List[0].DocApprUrl1,ApprovalDisabled:!(w.List[0].ApprovalDisabled&&m),ApprovalCancelDisabled:!(w.List[0].ApprovalCancelDisabled&&m),ApprovalRemarkDisabled:!(w.List[0].ApprovalRemarkDisabled&&m),ApprovalReturnDisabled:!(w.List[0].ApprovalReturnDisabled&&m)}),u&&W(w.List[0].DocStatus),B(i.Common.fTrim(w.ReturnNo))},ue=()=>{t.DocApprUrl1.startsWith("http")?window.open(t.DocApprUrl1,"_blank"):l({visible:!0,desc:`\uC8FC\uC18C\uAC00 \uC798\uBABB\uB418\uC5C8\uC2B5\uB2C8\uB2E4.
URL \uC8FC\uC18C\uB97C \uD655\uC778\uD558\uC5EC \uC8FC\uC138\uC694.`})},_=async()=>{const u={...t};u.Factory=d.user.factory,u.iUserPno=d.user.userid,u.ApprovalType=p,u.ApprovalDocNo=m,u.ApprovalDocSource=A,u.ApprovalDocFlag=E;let T=[];if(i.Grid.fCheckGridDataAll(j.current,T,{ApprId:"\uACB0\uC7AC\uC790",ApprPos:"\uC9C1\uCC45"},"\uACB0\uC7AC\uB77C\uC778")===void 0)try{const ne=(await O.post("/@api/common/appr/updateByApproval",{header:u,detail:T})).data;if(ne.errmess!==""){l({visible:!0,desc:ne.errmess,type:"E"});return}l({visible:!0,desc:"\uACB0\uC7AC\uC0C1\uC2E0\uC774 \uC644\uB8CC \uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),setTimeout(()=>{H(!0),R.current=!R.current},700)}catch(oe){l({visible:!0,desc:`\uACB0\uC7AC\uC0C1\uC2E0 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${oe}`,type:"E"})}},re=async()=>{const u={...t};u.Factory=d.user.factory,u.iUserPno=d.user.userid,u.ApprovalType=p,u.ApprovalDocNo=m,u.ApprovalDocSource=A;try{const w=(await O.post("/@api/common/appr/deleteByApproval",{header:u})).data;if(w.errmess!==""){l({visible:!0,desc:w.errmess,type:"E"});return}l({visible:!0,desc:"\uC0C1\uC2E0\uCDE8\uC18C\uAC00 \uC644\uB8CC \uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),setTimeout(()=>{H(!0),R.current=!R.current},700)}catch(T){l({visible:!0,desc:`\uC0C1\uC2E0\uCDE8\uC18C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${T}`,type:"E"})}},le=async()=>{const u={...t};u.Factory=d.user.factory,u.iUserPno=d.user.userid,u.ApprovalType=p,u.ApprovalDocNo=m,u.ApprovalDocSource=A;try{const w=(await O.post("/@api/common/appr/returnByApproval",{header:u})).data;if(w.errmess!==""){l({visible:!0,desc:w.errmess,type:"E"});return}l({visible:!0,desc:"\uBC18\uB824\uAC00 \uC644\uB8CC \uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),setTimeout(()=>{H(!0),R.current=!R.current},700)}catch(T){l({visible:!0,desc:`\uBC18\uB824 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${T}`,type:"E"})}};return s.exports.useEffect(()=>{if(i.Common.fEmptyReturn(m)===""){c();return}H()},[m]),s.exports.useEffect(()=>{if(i.Common.fEmptyReturn(A)===""){c();return}H(),R.current=!R.current},[L]),e.createElement(e.Fragment,null,e.createElement(he,{ApprovalDisabled:t.ApprovalDisabled,ApprovalCancelDisabled:t.ApprovalCancelDisabled,ApprovalRemarkDisabled:t.ApprovalRemarkDisabled,ApprovalReturnDisabled:t.ApprovalReturnDisabled,onClickApproval:N,onClickApprovalCancel:G,onClickApprovalRemark:ee,onClickApprovalReturn:Y,isReturnButton:D}),e.createElement(ve,{PGMID:z,Init:F,ApprovalType:p,ApprovalDocNo:m,ApprovalDocSource:A,Retrieve:R.current,GetDataSource:k}),!D&&e.createElement(r,null,e.createElement(r,{className:C.Box},e.createElement(r,{className:C.BoxTitle},"\uC0C1\uC2E0\uC790\uC758\uACAC")),e.createElement(r,null,e.createElement(b.exports.TextBox,{key:i.Common.fMakeId("DocRemark"),name:"DocRemark",inputId:i.Common.fMakeId("DocRemark"),multiline:!0,className:C.TextArea,value:t.DocRemark,onChange:u=>i.Common.fFieldChange(n,"DocRemark",u)}))),D&&e.createElement(r,null,e.createElement(r,{className:C.Box2},e.createElement(r,{className:C.BoxTitle},"\uC0C1\uC2E0\uC790\uC758\uACAC")),e.createElement(r,null,e.createElement(b.exports.TextBox,{key:i.Common.fMakeId("DocRemark"),name:"DocRemark",inputId:i.Common.fMakeId("DocRemark"),multiline:!0,className:C.TextArea2,value:t.DocRemark,onChange:u=>i.Common.fFieldChange(n,"DocRemark",u)})),e.createElement(r,{className:C.Box2},e.createElement(r,{className:C.BoxTitle},"\uBC18\uB824\uC758\uACAC")),e.createElement(r,null,e.createElement(b.exports.TextBox,{key:i.Common.fMakeId("AcctRemark"),name:"AcctRemark",inputId:i.Common.fMakeId("AcctRemark"),multiline:!0,className:C.TextArea2,value:t.AcctRemark,onChange:u=>i.Common.fFieldChange(n,"AcctRemark",u)}))),e.createElement(r,null,e.createElement(r,{className:C.Box},e.createElement(r,{className:C.BoxTitle},"\uC804\uC790\uACB0\uC7AC\uBB38\uC11C")),e.createElement(r,{style:{marginLeft:10}},e.createElement(b.exports.TextBox,{key:i.Common.fMakeId("DocApprUrl1"),name:"DocApprUrl1",inputId:i.Common.fMakeId("DocApprUrl1"),value:t.DocApprUrl1,className:C.TextBox2,style:{width:296,height:30},onChange:u=>i.Common.fFieldChange(n,"DocApprUrl1",u)}),e.createElement(b.exports.LinkButton,{style:{width:70,color:"#424242",borderRadius:3,marginLeft:10},disabled:!m,onClick:()=>{t.DocApprUrl1&&ue()}},e.createElement(r,{style:{width:70,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(r,{className:C.ButtonText},"\uBB38\uC11C\uBCF4\uAE30"))))),e.createElement(Ne,{visible:$,docVO:V,onCancel:()=>{X(!1)}}),e.createElement(r,null,I&&e.createElement(Ie,{PGMID:z,ApprovalDocSource:A,ApprovalDocNo:m,filepath:M})),e.createElement(r,null,U&&e.createElement(Se,{PGMID:z,AttachmentCount:h,FileType:A,FileNo:m,RevNo:o,IsRevision:a,FilePath:M,AttachmentsKeyName:x})),e.createElement(te,{visible:f.visible,description:f.desc,type:f.type,onConfirm:()=>l({visible:!1})}))}),Le={BoxTitle:{backgroundColor:"#fccf76",color:"#163971",fontWeight:600,fontSize:"12px",width:"100%",display:"flex",justifyItems:"center",alignItems:"center",marginTop:1},Box:{marginLeft:10,marginTop:10,width:"95%",display:"flex",alignItems:"center",justifyContent:"flex-end"},Box2:{marginLeft:10,marginTop:5,width:"95%",display:"flex",alignItems:"center",justifyContent:"flex-end"},TextArea:{width:"95%",height:100,marginLeft:10,display:"flex","& .textbox-text ":{fontSize:"12px !important",backgroundColor:"#e0ffff"}},TextArea2:{width:"95%",height:42,marginLeft:10,display:"flex","& .textbox-text ":{fontSize:"12px !important",backgroundColor:"#e0ffff"}},ButtonText:{fontSize:12,paddingBottom:2,fontWeight:500},TextBox1:{width:200,height:25,"& input":{fontSize:"12px !important"}},TextBox2:{width:200,height:25,"& input":{fontSize:"12px !important",backgroundColor:"#e0ffff"}}},Me=Z(Le)(Pe);export{Me as A};
