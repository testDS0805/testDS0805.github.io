import{r as l,R as t}from"./index.da6908f5.js";import{m as i,h as J,d as q,o as F,B as C,c as Q,u as Z,U as _,P as R,r as x,A as ee,C as te}from"./App.11263b70.js";import{C as ae}from"./CommonButton.0b792d77.js";import{C as U}from"./CodeHelperPopup.3932fdb9.js";import{H as ie}from"./HeaderList.b90f1652.js";const re=[{fieldName:"Factory",dataType:i.exports.ValueType.TEXT},{fieldName:"KeyNo",dataType:i.exports.ValueType.TEXT},{fieldName:"MenuName",dataType:i.exports.ValueType.TEXT},{fieldName:"PgmId",dataType:i.exports.ValueType.TEXT},{fieldName:"PgmNm",dataType:i.exports.ValueType.TEXT},{fieldName:"PgmGb",dataType:i.exports.ValueType.TEXT},{fieldName:"PgmGbNm",dataType:i.exports.ValueType.TEXT},{fieldName:"Above",dataType:i.exports.ValueType.TEXT},{fieldName:"AboveNm",dataType:i.exports.ValueType.TEXT},{fieldName:"Path",dataType:i.exports.ValueType.TEXT},{fieldName:"Dept",dataType:i.exports.ValueType.TEXT},{fieldName:"SortNo",dataType:i.exports.ValueType.NUMBER},{fieldName:"UseYn",dataType:i.exports.ValueType.TEXT},{fieldName:"Checked",dataType:i.exports.ValueType.TEXT}],se=[{name:"MenuName",fieldName:"MenuName",type:"data",width:"300",header:{text:"\uBA54\uB274\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"PgmId",fieldName:"PgmId",type:"data",width:"300",header:{text:"\uD504\uB85C\uADF8\uB7A8ID",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"}],ne=[{fieldName:"Pno",dataType:i.exports.ValueType.TEXT},{fieldName:"PnoNm",dataType:i.exports.ValueType.TEXT},{fieldName:"PgmId",dataType:i.exports.ValueType.TEXT},{fieldName:"PgmNm",dataType:i.exports.ValueType.TEXT},{fieldName:"Dept",dataType:i.exports.ValueType.TEXT},{fieldName:"DeptNm",dataType:i.exports.ValueType.TEXT},{fieldName:"UseYn",dataType:i.exports.ValueType.TEXT}],oe=[{name:"Pno",fieldName:"Pno",type:"data",width:"120",editable:!1,header:{text:"\uC0AC\uC6A9\uC790ID",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"PnoNm",fieldName:"PnoNm",type:"data",width:"150",editable:!1,header:{text:"\uC0AC\uC6A9\uC790\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"DeptNm",fieldName:"DeptNm",type:"data",width:"150",editable:!1,header:{text:"\uBD80\uC11C\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"UseYn",fieldName:"UseYn",type:"data",width:"80",editable:!1,styleName:"center-column",header:{text:"\uC0AC\uC6A9\uC720\uBB34",showTooltip:!0},renderer:{type:"check",trueValues:"Y",falseValues:"N"}}],le={DateTitleBox:{margin:"5px 10px 0px 15px",backgroundColor:"#e0ecff",padding:5,color:"#163971",height:25,fontSize:"12px",display:"flex",width:85,alignItems:"center",fontWeight:600},TitleBox4:{backgroundColor:"#fccf76",color:"#163971",padding:5,height:20,fontSize:"12px",display:"flex",alignItems:"center",width:"100%",fontWeight:600},TitleText3:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},InputBox3:{marginTop:5,width:120,height:25,"& input":{fontSize:"12px !important"}},Scroll:{"& .mainCon":{height:"700px",padding:"10px"}}};function de(){const[e,r]=l.exports.useState({SchPgmGb:"",SchPgmGbNm:"",SchDept:"",SchDeptNm:""}),[c,n]=l.exports.useState(""),[a,s]=l.exports.useState({visible:!1,desc:"",type:"N"}),[f,m]=l.exports.useState({visible:!1,desc:"",id:""}),[d,N]=l.exports.useState({visible:!1,description:"",value:"",datas:{},id:"",viewId:"",selectedData:{}});return String.prototype.DateValidation=function(o){return new Date(this)instanceof Date&&!isNaN(new Date(this))?J(this).format(o):null},{searchVO:e,setSearchVO:r,gridFocus:c,setGridFocus:n,alert:a,setAlert:s,confirm:f,setConfirm:m,codeClassInputs:d,setCodeClassInputs:N}}const ue=async e=>{e({SchPgmGb:"",SchPgmGbNm:""},50)},ce=async(e,r,c,n)=>{const a={...r},s=await e.Util.Command.fSearchByReturn("/@api/admin/menuRoleAuth/selectByList",a);s!==void 0&&(c.setRows(s,"KeyNo",!0,"","iconField"),n.expandAll())},X=async(e,r,c,n)=>{const a={};a.Factory=e.User.user.factory,a.PgmId=c,a.Dept=n;const s=await e.Util.Command.fSearchByReturn("/@api/admin/menuRoleAuth/selectByDetailList",a);s!==void 0&&r.setRows(s)},me=async(e,r,c,n)=>{c.commit(!0);const a={};a.PgmId=n,a.Factory=e.User.user.factory,a.iUserPno=e.User.user.userid;let s=[];if(e.Util.Grid.fCheckGridDataAll(r,s,{},"\uC0AC\uC6A9\uC790")===void 0)try{const d=(await q.post("/@api/admin/menuRoleAuth/updateByList",{header:a,detail:s})).data;if(d.errmess!==""){e.setAlert({visible:!0,desc:d.errmess,type:"E"});return}e.setAlert({visible:!0,desc:"\uBB38\uC11C \uC800\uC7A5\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),setTimeout(async()=>{X(e,r,n)},500)}catch(m){e.setAlert({visible:!0,desc:`\uC800\uC7A5 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${m}`})}},pe=F(e=>{const r=l.exports.useRef(null),c=[""],n=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),D=new i.exports.LocalTreeDataProvider(!1),h=new i.exports.TreeView(r.current),e.Util.Grid.fInitGridTree(h,D,e.GridFields,e.GridColumns),h.displayOptions.rowHeight=25,h.onValidateColumn=(a,s,f,m)=>{const d={};return c[0].includes(s.fieldName)&&(!m||m===void 0)&&(d.level="warning",d.message="\uD544\uC218 \uC785\uB825 \uAC12\uC785\uB2C8\uB2E4."),d},h.onCurrentRowChanged=(a,s,f)=>{f>=0&&e.RowChanged(a,f)},h.onCellClicked=(a,s)=>{e.currentIndex===s.dataRow&&s.dataRow>=0&&e.RowChanged(a,s.dataRow)},e.DataProviderBind(D),e.GridViewBind(h)};return l.exports.useEffect(()=>{n()},[]),t.createElement(t.Fragment,null,t.createElement(C,{ref:r,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:e.Height}}))});let D,h;const ge=F(()=>{const e="MENUROLEAUTH",{$CommonStore:r,$UserStore:c}=Z(),n=fe(),{searchVO:a,setSearchVO:s,alert:f,setAlert:m,confirm:d,setConfirm:N}=de(),o=new _(e,m,!0,!0,!0,!0,!0),w=l.exports.useRef(""),A=l.exports.useRef(""),k=l.exports.useRef(0),L=l.exports.useRef(0),E=l.exports.useRef(null),P=async()=>{r.fSetBinding(!0),await ue(s),r.fSetBinding(!1),w.current="",o.Common.fSetTabIndex()},[b]=l.exports.useState({Util:o,User:c,fInit:P,setAlert:m}),H=p=>{B=p},M=p=>{g=p},O=p=>{S=p,S.onKeyDown=(u,y)=>{switch(u.commit(),y.code){case"Tab":r.fGetShift()||T.setFocus();break}}},Y=p=>{T=p,T.setStateBar({visible:!0}),p.setEditOptions({insertable:!1,appendable:!1,editable:!0,useTabKey:!1}),T.setDisplayOptions({fitStyle:"none"}),T.onKeyDown=(u,y)=>{switch(u.commit(),y.code){case"Space":{const W=u.getCurrent().itemIndex,j=u.getValue(u.getCurrent().itemIndex,"UseYn");o.Grid.fSetMultiDataProvider(g,W,{UseYn:j==="Y"?"N":"Y"})}break;case"Tab":r.fGetShift()&&S.setFocus();break}}},K=async(p,u)=>{T.commit(),o.Common.fProviderClearRows(g);var y=B.getJsonRow(u);w.current=y.PgmId,await X(b,g,w.current,A.current)},$=async()=>{N({visible:!1,desc:"",id:""}),d.id==="SAVE"&&await me(b,g,T,w.current)},z=()=>{N({visible:!1,desc:"",id:""}),E.current.focus()},V=(p,u,y)=>{if(!r.fGetBinding())switch(p){case"SchPgmGbNm":o.Common.fMultiFieldChange(s,{SchPgmGb:u,SchPgmGbNm:y});break;case"SchDeptNm":o.Common.fMultiFieldChange(s,{SchDept:u,SchDeptNm:y}),A.current=u;break}},G=async()=>{P(),o.Common.fProviderClearRows(B),o.Common.fProviderClearRows(g)},I=async()=>{await ce(b,a,B,S)},v=async()=>{E.current=document.activeElement,N({visible:!0,desc:"\uC800\uC7A5 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",id:"SAVE"})};return l.exports.useEffect(()=>{o.Common.fHotKey(r,r.isPopup,G,I,v)},[r.HotKey]),l.exports.useEffect(()=>(P(),()=>{r.fSetHotKey()}),[]),t.createElement(t.Fragment,null,t.createElement(ae,{pgmid:e,visible:"111000",onNew:G,onSearch:I,onSave:v}),t.createElement(R,{className:"mainCon"},t.createElement(x.exports.Layout,{style:{width:"100%",height:775}},t.createElement(x.exports.LayoutPanel,{region:"north",style:{height:47}},t.createElement(R,{className:n.Scroll},t.createElement(C,{style:{marginTop:5}},t.createElement(C,{display:"flex",alignItems:"center"},t.createElement(C,{style:{display:"flex",alignItems:"center"}},t.createElement(U,{inputCls:"inputCls",pgmid:e,inputType:"",id:"SchPgmGbNm",title:"\uBAA8\uB4C8",helper:o.Common.fCreateHelper("M003"),ComponentCode:a.SchPgmGb,ComponentValue:a.SchPgmGbNm,SetValue:V,labelStyles:{margin:"0px 0px 0px 10px",width:85},inputStyles:{margin:"0px 0px 0px 10px",width:150}}),t.createElement(U,{inputCls:"inputCls",pgmid:e,inputType:"Dept",id:"SchDeptNm",title:"\uBD80\uC11C",helper:o.Common.fCreateHelper("B002","001"),ComponentCode:a.SchDept,ComponentValue:a.SchDeptNm,SetValue:V,labelStyles:{margin:"0px 0px 0px 10px",width:85},inputStyles:{margin:"0px 0px 0px 10px",width:150}})))))),t.createElement(x.exports.LayoutPanel,{region:"center"},t.createElement(x.exports.Layout,null,t.createElement(x.exports.LayoutPanel,{region:"west",style:{width:700,height:775}},t.createElement(C,{className:n.TitleBox4,style:{width:"100%"}},t.createElement(C,{className:n.TitleText3},"\uC804\uCCB4\uBA54\uB274")),t.createElement(C,null,t.createElement(pe,{Util:o,Id:"Grid1",GridTitle:"\uD5E4\uB354",Height:707,currentIndex:k,GridFields:re,GridColumns:se,RowChanged:K,DataProviderBind:H,GridViewBind:O}))),t.createElement(x.exports.LayoutPanel,{region:"center",style:{marginLeft:20,height:775}},t.createElement(C,{className:n.TitleBox4,style:{width:"100%"}},t.createElement(C,{className:n.TitleText3},"\uC0AC\uC6A9\uC790")),t.createElement(C,null,t.createElement(ie,{Util:o,Id:"Grid2",GridTitle:"\uC0AC\uC6A9\uC790",Height:707,currentIndex:L,GridFields:ne,GridColumns:oe,DataProviderBind:M,GridViewBind:Y}))))))),t.createElement(ee,{visible:f.visible,description:f.desc,type:f.type,onConfirm:()=>{m({visible:!1}),E.current&&E.current.focus()}}),t.createElement(te,{visible:d.visible,description:d.desc,onCancel:z,onConfirm:$}))});let B,g,S,T;const fe=Q(le);export{ge as default};
