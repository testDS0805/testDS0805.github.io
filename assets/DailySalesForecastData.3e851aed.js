import{r as o,R as i}from"./index.da6908f5.js";import{m,h as F,o as P,B as S,c as Y,u as W,U as $,P as K,r as E,A as X,C as _}from"./App.11263b70.js";import{C as j}from"./CommonButton.0b792d77.js";import{C as q}from"./CommonDatePicker.d7bc57f8.js";import"./index.6f186c21.js";const G=[{fieldName:"Deptname",dataType:m.exports.ValueType.TEXT},{fieldName:"Pnonm",dataType:m.exports.ValueType.TEXT},{fieldName:"Custnm",dataType:m.exports.ValueType.TEXT}],A=[{name:"Deptname",fieldName:"Deptname",type:"data",width:75,header:{text:"\uB2F4\uB2F9\uBD80\uC11C",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"center-column"},{name:"Pnonm",fieldName:"Pnonm",type:"data",width:90,header:{text:"\uB2F4\uB2F9\uC790",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"center-column"},{name:"Custnm",fieldName:"Custnm",type:"data",width:180,header:{text:"\uAC70\uB798\uCC98\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"}],J={DateTitleBox:{margin:"5px 10px 0px 15px",backgroundColor:"#e0ecff",padding:5,color:"#163971",height:25,fontSize:"12px",display:"flex",width:85,alignItems:"center",fontWeight:600},TitleBox4:{backgroundColor:"#fccf76",color:"#163971",padding:5,height:20,fontSize:"12px",display:"flex",alignItems:"center",width:"100%",fontWeight:600},TitleText3:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},InputBox3:{width:120,height:25,"& input":{fontSize:"12px !important"}},Scroll:{"& .mainCon":{height:"700px",padding:"10px"}},SA1:{width:80,height:25,margin:"3px 3px",backgroundColor:"#e0ecff",color:"#163971",paddingTop:3,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SA2:{marginTop:-2,marginLeft:5,alignItems:"center",textAlign:"center"},SA3:{width:"15px!important",height:"15px!important",border:"1px solid #3c96ff",marginTop:"1px","& .checkbox-checked":{border:0,background:"#3c96ff"}},SA4:{width:90,height:25,"& input":{fontSize:"12px !important"}},SA5:{marginLeft:5,width:140,height:25,"& input":{fontSize:"12px !important"}},SA6:{width:70,height:25,margin:"3px 3px",backgroundColor:"#fccf76",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600},SB1:{width:253,height:32,"& input":{fontSize:"16px !important",textAlign:"center",color:"#0070c0"}},SB2:{fontSize:12,paddingBottom:2,fontWeight:500},SC1:{width:90,height:25,margin:"3px 10px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SC2:{width:80},SC3:{width:200,height:25,"& input":{fontSize:"12px !important"}},SC4:{width:200,height:25,"& input":{fontSize:"12px !important",textAlign:"right"}},SC5:{fontSize:12,paddingBottom:2,fontWeight:500,marginLeft:5},SC6:{width:150,height:25,"& input":{fontSize:"12px !important",textAlign:"center"}},SC7:{width:80,height:29,margin:"3px 1px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SC8:{"& textarea":{fontSize:"12px !important"}}};function Q(){const[e,t]=o.exports.useState({SchDate:new Date}),[n,a]=o.exports.useState(""),[f,h]=o.exports.useState({visible:!1,desc:"",type:"N"}),[p,s]=o.exports.useState({visible:!1,desc:"",id:""}),[c,C]=o.exports.useState([]),[y,w]=o.exports.useState([]);return String.prototype.DateValidation=function(b){return new Date(this)instanceof Date&&!isNaN(new Date(this))?F(this).format(b):null},{searchVO:e,setSearchVO:t,gridFocus:n,setGridFocus:a,alert:f,setAlert:h,confirm:p,setConfirm:s,changedGridFields:c,setChangedGridFields:C,changedGridColumns:y,setChangedGridColumns:w}}const Z=async(e,t)=>{e({SchDate:new Date},50)},ee=async(e,t)=>{const n={...e};n.Accunit=t.User.user.accunit,n.Factory=t.User.user.factory,n.Pno=t.User.user.userid,n.SchDate=F(n.SchDate).format("YYYYMMDD");try{const a=await t.Util.Command.fSearchByReturn("/@api/business/dailySalesForecastData/selectByList",n);return a===void 0||a.length<1?(t.setAlert({visible:!0,desc:"\uC870\uD68C\uAC12\uC774 \uC5C6\uC2B5\uB2C8\uB2E4."}),null):a}catch(a){t.setAlert({visible:!0,desc:`\uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.
${a}`,type:"E"})}},te=P(e=>{const t=o.exports.useRef(null),n=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),D=new m.exports.LocalDataProvider(!1),u=new m.exports.GridView(t.current),e.Util.Grid.fInitGridHeader(u,D,e.GridFields,e.GridColumns,25,f,a,h),u.setDisplayOptions({focusVisible:!0,selectionStyle:"rows",selectionMode:"none",columnMovable:!1,fitStyle:"none",rowHeight:25}),u.onItemChecked=()=>{e.setGridFocus("R")},u.onContextMenuItemClicked=async(p,s)=>{s.label==="\uC5D1\uC140 \uB2E4\uC6B4\uB85C\uB4DC"&&D.getRowCount()&&u.exportGrid({compatibility:!0,type:"excel",target:"local",applyDynamicStyles:!0,fileName:`HSE \uC77C\uBCC4\uB9E4\uCD9C\uC608\uC0C1\uC790\uB8CC_${F(new Date).format("YYYYMMDD")}.xlsx`})},e.DataProviderBind(D),e.GridViewBind(u)},a=async(p,s)=>{},f=async(p,s,c)=>{},h=async(p,s)=>{switch(e.setGridFocus("R"),s.key){case"Enter":break;case"Escape":break;case"Insert":break;case"ArrowDown":break;case"ArrowUp":break;case(s.ctrlKey&&" "):break}};return o.exports.useEffect(()=>{n()},[e.GridColumns]),i.createElement(i.Fragment,null,i.createElement(S,{ref:t,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:739}}))});let D,u;const le=P(()=>{const e="DAILYSALESFORECASTDATA",{$CommonStore:t,$UserStore:n}=W(),a=ie(),{searchVO:f,setSearchVO:h,gridFocus:p,setGridFocus:s,alert:c,setAlert:C,confirm:y,setConfirm:w,changedGridFields:b,setChangedGridFields:B,changedGridColumns:U,setChangedGridColumns:T}=Q(),g=new $(e,C,!0,!0,!0,!0,!0),V=o.exports.useRef(0),k=async()=>{t.fSetBinding(!0),await Z(h),t.fSetBinding(!1),B(G),T(A),g.Common.fSetTabIndex()},[v]=o.exports.useState({Util:g,User:n,fInit:k,setAlert:C}),z=r=>{I=r},M=r=>{},H=async()=>{w({visible:!1,desc:"",id:""}),y.id},R=()=>{w({visible:!1,desc:"",id:""})},L=async(r,x)=>{let d=[...r];return x.forEach(l=>{l.substring(0,1)==="_"&&d.push({fieldName:l,dataType:m.exports.ValueType.NUMBER})}),d.push({fieldName:"Total",dataType:m.exports.ValueType.NUMBER}),d},O=async(r,x)=>{let d=[...r];return x.forEach(l=>{l.substring(0,1)==="_"&&d.push({name:l,fieldName:l,type:"data",width:70,header:{text:l.substring(5,7)+"/"+l.substring(7,9),showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"right-column",numberFormat:"#,###"})}),d.push({name:"Total",fieldName:"Total",type:"data",width:70,header:{text:"\uD569\uACC4",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"right-column",numberFormat:"#,###"}),d},N=async()=>{const r=await ee(f,v);if(r===null){B(G),T(A),I.clearRows();return}let x=Object.keys(r[0]);const d=await L(G,x),l=await O(A,x);B(d),T(l),setTimeout(()=>{I.setRows(r)},400)};return o.exports.useEffect(()=>{g.Common.fHotKey(t,t.isPopup,null,N)},[t.HotKey]),o.exports.useEffect(()=>{k()},[]),i.createElement(i.Fragment,null,i.createElement(j,{pgmid:e,visible:"010000",onSearch:N}),i.createElement(K,{className:"mainCon"},i.createElement(E.exports.Layout,{style:{width:"100%",height:775}},i.createElement(E.exports.LayoutPanel,{region:"north",style:{height:"4.5%"}},i.createElement(S,{style:{display:"flex",alignItems:"center"}},i.createElement(S,{className:a.SA1,style:{marginLeft:15}},i.createElement(S,{className:a.SA2},"\uAE30\uC900\uC77C\uC790")),i.createElement(q,{inputeCls:"inputCls",selected:f.SchDate,inputId:g.Common.fMakeId("SchDate"),onHandleDateChange:r=>g.Common.fFieldChange(h,"SchDate",r)}))),i.createElement(E.exports.LayoutPanel,{region:"center",split:!0,style:{width:"100%",height:"100%"}},i.createElement(S,{style:{width:"100%"}},i.createElement(te,{Util:g,Id:"HeaderGrid",GridTitle:"Main",GridFields:b,GridColumns:U,currentIndex:V,setGridFocus:s,setAlert:C,DataProviderBind:z,GridViewBind:M}))))),i.createElement(X,{visible:c.visible,description:c.desc,type:c.type,onConfirm:()=>C({visible:!1})}),i.createElement(_,{visible:y.visible,description:y.desc,onCancel:R,onConfirm:H}))});let I;const ie=Y(J);export{le as default};
