import{r as c,R as t}from"./index.da6908f5.js";import{u as U,h,o as A,B as d,m as r,d as q,c as _,U as j,P as J,r as x,C as Z,A as ee}from"./App.11263b70.js";import{C as te}from"./CommonButton.0b792d77.js";import{C as M}from"./CommonDatePicker.d7bc57f8.js";import{C as ae}from"./CodeHelperPopup.3932fdb9.js";import"./index.6f186c21.js";const re={SC1:{width:100,height:25,margin:"3px 10px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SC4:{display:"flex",alignItems:"center"},Radio:{width:15,height:15},RadioLabel:{width:50,marginLeft:5,fontSize:"14px"},SC3:{width:180,height:25,"& input":{fontSize:"12px !important"}}};function ie(){const{$UserStore:e}=U(),[a,m]=c.exports.useState({SchAccunit:e.user.accunit,SchFactory:e.user.factory,SchPno:e.user.userid,SchCustCd:"",SchCustCdNm:"",SchFrDate:h().subtract(1,"month"),SchToDate:new Date,SchDelvYn:"1",DeptCd:e.user.deptcd}),[n,o]=c.exports.useState({visible:!1,desc:"",type:"N"}),[i,p]=c.exports.useState({visible:!1,desc:"",id:""});return{searchVO:a,setSearchVO:m,alert:n,setAlert:o,confirm:i,setConfirm:p}}const oe=A(e=>{const a=c.exports.useRef(null),m=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),N=new r.exports.LocalDataProvider(!1),T=new r.exports.GridView(a.current),e.Util.Grid.fInitGridHeader(T,N,e.GridFields,e.GridColumns,30,o,i,p,e.GridTitle),T.setCheckBar({visible:!0}),T.setDisplayOptions({fitStyle:"none",rowHeight:25}),T.setFooters({visible:!0}),e.DataProviderBind(N),e.GridViewBind(T),T.setCheckableCallback(n)},n=function(C,l){if(N.getValue(l._dataRow,"Qcyn")==="\uAC80\uC0AC\uC644\uB8CC"&&N.getValue(l._dataRow,"DelvNo")==="")return!0},o=async(C,l,D)=>{D>=0&&e.RowChanged(C,D)},i=(C,l)=>{e.currentIndex.current===l.dataRow&&l.dataRow>=0&&e.RowChanged(C,l.dataRow)},p=async(C,l)=>{};return c.exports.useEffect(()=>{m()},[]),t.createElement(d,{ref:a,key:e.Util.Common.fMakeId(e.id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:350}})});let N,T;const ue=A(e=>{const a=c.exports.useRef(null),m=async()=>{w=new r.exports.LocalDataProvider(!1),f=new r.exports.GridView(a.current),e.Util.Grid.fInitGridDetail(f,w,e.GridFields,e.GridColumns,n,o,i),f.setStateBar({visible:!1}),f.displayOptions.rowHeight=25,f.setFooters({visible:!0}),f.setCheckBar({visible:!1}),f.displayOptions.fitStyle="none",e.DataProviderBind(w),e.GridViewBind(f)},n=()=>{},o=()=>{},i=()=>{};return c.exports.useEffect(()=>{m()},[]),t.createElement(d,{ref:a,key:e.Util.Common.fMakeId(e.id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:375}})});let w,f;const ne=[{fieldName:"SupplyDate",dataType:r.exports.ValueType.TEXT},{fieldName:"CustNm",dataType:r.exports.ValueType.TEXT},{fieldName:"CustCd",dataType:r.exports.ValueType.TEXT},{fieldName:"SupNo",dataType:r.exports.ValueType.TEXT},{fieldName:"Amount",dataType:r.exports.ValueType.NUMBER},{fieldName:"Tax",dataType:r.exports.ValueType.NUMBER},{fieldName:"OkAmt",dataType:r.exports.ValueType.NUMBER},{fieldName:"DelvNo",dataType:r.exports.ValueType.TEXT},{fieldName:"VatCd",dataType:r.exports.ValueType.TEXT},{fieldName:"VatCdNm",dataType:r.exports.ValueType.TEXT},{fieldName:"Accunit",dataType:r.exports.ValueType.TEXT},{fieldName:"Factory",dataType:r.exports.ValueType.TEXT},{fieldName:"Qcyn",dataType:r.exports.ValueType.TEXT}],le=[{name:"SupplyDate",fieldName:"SupplyDate",width:"100",header:{text:"\uC785\uACE0\uC77C\uC790",showTooltip:!0}},{name:"CustNm",fieldName:"CustNm",type:"data",width:"150",styleName:"center-column",header:{text:"\uAC70\uB798\uCC98\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"SupNo",fieldName:"SupNo",type:"data",width:"100",header:{text:"\uBA85\uC138\uC11C\uBC88\uD638",showTooltip:!0}},{name:"Amount",fieldName:"Amount",type:"data",width:"100",styleName:"right-column",header:{text:"\uACF5\uAE09\uAC00\uC561",showTooltip:!0},footer:{text:"",expression:"sum",numberFormat:"#,##0"},numberFormat:"#,##0"},{name:"Tax",fieldName:"Tax",type:"data",width:"100",styleName:"right-column",header:{text:"\uBD80\uAC00\uC138",showTooltip:!0},footer:{text:"",expression:"sum",numberFormat:"#,##0"},numberFormat:"#,##0"},{name:"OkAmt",fieldName:"OkAmt",type:"data",width:"90",header:{text:"\uD569\uACC4",showTooltip:!0},footer:{text:"",expression:"sum",numberFormat:"#,##0"},styleName:"right-column",numberFormat:"#,##0"},{name:"Qcyn",fieldName:"Qcyn",type:"data",width:"60",header:{text:"\uAC80\uC0AC\uAD6C\uBD84"}},{name:"DelvNo",fieldName:"DelvNo",type:"data",width:"120",header:{text:"\uAD6C\uB9E4\uC785\uACE0\uBC88\uD638",showTooltip:!0}}],se=[{fieldName:"GoodNo",dataType:r.exports.ValueType.TEXT},{fieldName:"UnitNm",dataType:r.exports.ValueType.TEXT},{fieldName:"BalQty",dataType:r.exports.ValueType.NUMBER},{fieldName:"NapQty",dataType:r.exports.ValueType.NUMBER},{fieldName:"Weight",dataType:r.exports.ValueType.NUMBER},{fieldName:"Su",dataType:r.exports.ValueType.NUMBER},{fieldName:"MiQty",dataType:r.exports.ValueType.NUMBER},{fieldName:"Price",dataType:r.exports.ValueType.NUMBER},{fieldName:"Amount",dataType:r.exports.ValueType.NUMBER},{fieldName:"BalNo",dataType:r.exports.ValueType.TEXT},{fieldName:"BalSeq",dataType:r.exports.ValueType.TEXT}],de=[{fieldName:"GoodNo",type:"data",width:"300",header:{text:"\uD488\uBC88",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{fieldName:"UnitNm",type:"data",width:"50",header:{text:"\uB2E8\uC704"}},{name:"BalQty",fieldName:"BalQty",type:"data",width:"100",header:{text:"\uBC1C\uC8FC\uC218\uB7C9",showTooltip:!0},styleName:"right-column",numberFormat:"#,##0.##"},{name:"NapQty",fieldName:"NapQty",type:"data",width:"100",header:{text:"\uC785\uACE0\uC218\uB7C9",showTooltip:!0},footer:{text:"",expression:"sum",numberFormat:"#,##0.##"},styleName:"right-column",numberFormat:"#,##0.##"},{name:"Weight",fieldName:"Weight",type:"data",width:"100",header:{text:"\uC785\uACE0\uC911\uB7C9"},footer:{text:"",expression:"sum",numberFormat:"#,##0.##"},styleName:"right-column",numberFormat:"#,##0.##"},{name:"Su",fieldName:"Su",type:"data",width:"100",header:{text:"\uC785\uACE0\uAE38\uC774"},footer:{text:"",expression:"sum",numberFormat:"#,##0.##"},styleName:"right-column",numberFormat:"#,##0.##"},{name:"MiQty",fieldName:"MiQty",type:"data",width:"100",header:{text:"\uBBF8\uC785\uACE0\uB7C9"},styleName:"right-column",numberFormat:"#,##0.##"},{name:"Price",fieldName:"Price",type:"data",width:"60",header:{text:"\uB2E8\uAC00",showTooltip:!0},footer:{text:"",expression:"sum",numberFormat:"#,##0"},styleName:"right-column",numberFormat:"#,##0"},{name:"Amount",fieldName:"Amount",type:"data",width:"80",header:{text:"\uACF5\uAE09\uAC00\uC561"},footer:{text:"",expression:"sum",numberFormat:"#,##0"},styleName:"right-column",numberFormat:"#,##0"},{name:"BalNo",fieldName:"BalNo",type:"data",width:"120",header:{text:"\uBC1C\uC8FC\uBC88\uD638",showTooltip:!0}},{name:"BalSeq",fieldName:"BalSeq",type:"data",width:"80",header:{text:"\uBC1C\uC8FC\uC21C\uBC88",showTooltip:!0}}],me=(e,a)=>{e({SchAccunit:a.user.accunit,SchFactory:a.user.factory,SchPno:a.user.userid,SchCustCd:"",SchCustCdNm:"",SchFrDate:h().subtract(1,"month"),SchToDate:new Date,SchDelvYn:"1",DeptCd:a.user.deptcd})},P=async(e,a,m,n,o)=>{if(e.Util.Common.fValidate(!h(a.SchFrDate,"YYYY-MM-DD").isValid()||!h(a.SchToDate,"YYYY-MM-DD").isValid(),"\uC870\uD68C\uAE30\uAC04\uC744 \uBC14\uB974\uAC8C \uC785\uB825\uD574 \uC8FC\uC138\uC694.")||e.Util.Common.fValidate(h(a.SchFrDate).format("YYYYMMDD")>h(a.SchToDate).format("YYYYMMDD"),"\uC870\uD68C\uAE30\uAC04\uC744 \uD655\uC778\uD574 \uC8FC\uC138\uC694."))return;const i={...a};i.SchFrDate=h(i.SchFrDate).format("YYYYMMDD"),i.SchToDate=h(i.SchToDate).format("YYYYMMDD"),o&&(i.SchDelvYn="0"),await e.Util.Command.fSearch(m,"/@api/purchase/orderToDelv/selectByList",i,n)},Ce=async(e,a,m,n,o)=>{const i={...a};i.SupNo=o.current,i.CustCd=n.current;try{const p=await e.Util.Command.fSearchByReturn("/@api/purchase/orderToDelv/selectByDetailList",i);m.setRows(p)}catch{e.setAlert({visible:!0,desc:"\uC0C1\uC138\uB0B4\uC5ED \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}},ce=async(e,a,m,n)=>{const o={...a};let i=[];n.getCheckedItems(!0).forEach(C=>{const l=m.getJsonRow(C);i.push(l)});try{const l=(await q.post("/@api/purchase/orderToDelv/insertByList",{header:o,detail:i})).data;if(l.errmess!==""){e.setAlert({visible:!0,desc:l.errmess,type:"E"});return}return e.setAlert({visible:!0,desc:"\uC785\uACE0\uAC00 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),setTimeout(async()=>{await P(e,a,m,"","fromsave")},100),l.SupNo}catch(C){e.setAlert({visible:!0,desc:`\uC800\uC7A5 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${C}`})}},Ne=A(()=>{const e="ORDERTODELV",{$CommonStore:a,$UserStore:m}=U(),n=pe(),{searchVO:o,setSearchVO:i,alert:p,setAlert:C,confirm:l,setConfirm:D}=ie(),s=new j(e,C,!0,!0,!0,!0,!1),v=c.exports.useRef(0),b=c.exports.useRef(""),F=c.exports.useRef(""),V=()=>{me(i,m)},[E]=c.exports.useState({Util:s,User:m,fInit:V,setAlert:C}),L=u=>{S=u},O=u=>{B=u},H=u=>{Y=u},X=u=>{k=u},Q=(u,y)=>{Y.commit(!0),b.current=B.getValue(y,"SupNo"),F.current=B.getValue(y,"CustCd"),Ce(E,o,k,F,b),setTimeout(()=>{v.current=y},200)},K=(u,y,z)=>{switch(u){case"schCustNm":s.Common.fMultiFieldChange(i,{SchCustCd:y,SchCustCdNm:z});return}},g=(u,y)=>{u&&i({...o,SchDelvYn:y})},I=()=>{},R=async()=>{await P(E,o,B,"\uB0A9\uD488 \uBAA9\uB85D")},G=async()=>{if(s.Common.fValidate(S.getCheckedItems(!0).length<1,"\uC800\uC7A5\uD560 \uB0A9\uD488 \uB0B4\uC5ED\uC744 \uC120\uD0DD\uD558\uC138\uC694."))return;const u=S.getCheckedItems(!0).length;D({visible:!0,desc:u+"\uAC74\uC744 \uC785\uACE0\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",id:"Save"})},W=()=>{D({visible:!1,desc:"",id:""})},$=async()=>{D({visible:!1,desc:"",id:""}),l.id==="Save"&&(i({...o,SchDelvYn:"0"}),await ce(E,o,B,S))};return c.exports.useEffect(()=>{s.Common.fHotKey(a,a.isPopup,I,R,G)},[a.HotKey]),c.exports.useEffect(()=>(V(),()=>{a.fSetHotKey()}),[]),t.createElement(t.Fragment,null,t.createElement(te,{pgmid:e,visible:"01100",onNew:I,onSearch:R,onSave:G}),t.createElement(J,{className:"mainCon"},t.createElement(d,{style:{display:"flex",alignItems:"center",padding:1,border:"1px solid #e2e2e2",borderRadius:5,backgroundColor:"#f9f9f9"}},t.createElement(d,{style:{marginTop:2,marginLeft:5,display:"flex",alignItems:"center"}},t.createElement(ae,{title:"\uAC70\uB798\uCC98\uBA85",inputCls:"inputCls",pgmid:e,inputType:"Cust",id:"schCustNm",helper:s.CodeHelper.helperCust,ComponentCode:o.SchCustCd,ComponentValue:o.SchCustCdNm,SetValue:K,labelStyles:{width:70,height:25,margin:"0px 3px 5px 3px",padding:5,fontSize:12,display:"flex",alignItems:"center",fontWeight:600},inputStyles:{width:235,margin:"0px 0px 5px 7px"}})),t.createElement(d,{className:n.SC4,style:{marginLeft:15}},t.createElement(d,{className:n.SC1},"\uAE30\uAC04")),t.createElement(d,{style:{display:"flex",alignItems:"center"}},t.createElement(d,null,t.createElement(M,{inputCls:"inputCls",selected:o.SchFrDate,inputId:s.Common.fMakeId("SchFrDate"),onHandleDateChange:u=>s.Common.fFieldChange(i,"SchFrDate",u)})),t.createElement(d,{style:{margin:"0 3px",width:"10px"}},"~"),t.createElement(M,{inputCls:"inputCls",selected:o.SchToDate,inputId:s.Common.fMakeId("SchToDate"),onHandleDateChange:u=>s.Common.fFieldChange(i,"SchToDate",u)})),t.createElement(d,{style:{marginTop:2,marginLeft:15,display:"flex",alignItems:"center"}},t.createElement(d,{className:n.SC4},t.createElement(d,{className:n.SC1},"\uC804\uD45C\uBC1C\uD589\uC870\uAC74")),t.createElement(d,{style:{height:27,display:"flex",flexDirection:"row",border:"1px solid #9ac9ed",borderRadius:5,alignItems:"center",justifyContent:"center"}},t.createElement(x.exports.RadioButton,{className:n.Radio,inputId:s.Common.fMakeId("all"),inputCls:"inputCls",value:"0",groupValue:o.SchDelvYn,onChange:u=>g(u,"0"),style:{marginLeft:5}}),t.createElement(x.exports.Label,{htmlFor:s.Common.fMakeId("all"),className:n.RadioLabel},"\uC804\uCCB4"),t.createElement(d,null,t.createElement(x.exports.RadioButton,{className:n.Radio,inputId:s.Common.fMakeId("mi"),inputCls:"inputCls",value:"1",groupValue:o.SchDelvYn,onChange:u=>g(u,"1"),style:{marginLeft:5}}),t.createElement(x.exports.Label,{htmlFor:s.Common.fMakeId("mi"),className:n.RadioLabel},"\uBBF8\uBC1C\uD589")),t.createElement(d,null,t.createElement(x.exports.RadioButton,{className:n.Radio,inputId:s.Common.fMakeId("bal"),inputCls:"inputCls",value:"2",groupValue:o.SchDelvYn,onChange:u=>g(u,"2"),style:{marginLeft:5}}),t.createElement(x.exports.Label,{htmlFor:s.Common.fMakeId("bal"),className:n.RadioLabel},"\uBC1C\uD589"))))),t.createElement(d,{style:{marginTop:5}},t.createElement(oe,{Util:s,id:"Grid1",currentIndex:v,GridFields:ne,GridColumns:le,RowChanged:Q,DataProviderBind:O,GridViewBind:L})),t.createElement(d,{style:{marginTop:5}},t.createElement(ue,{Util:s,id:"Grid2",GridFields:se,GridColumns:de,DataProviderBind:X,GridViewBind:H}))),t.createElement(Z,{visible:l.visible,description:l.desc,onCancel:W,onConfirm:$}),t.createElement(ee,{visible:p.visible,description:p.desc,type:p.type,onConfirm:()=>C({visible:!1})}))});let S,Y,B,k;const pe=_(re);export{Ne as default};
