import{r as m,R as c}from"./index.da6908f5.js";import{o as se,c as ae,u as le,f as ne,B as b,F as ie,r as oe,A as ce,t as re,d as de}from"./App.11263b70.js";const Ce=se(({inputCls:W,pgmid:A,inputType:v,id:l,title:$,placeHolder:M,helper:g,onConfirm:w,inputValue:T,codeValue:R,labelStyles:G,inputStyles:_,disabled:z,editable:J,onTabEvent:h,inputRequired:O=!1})=>{const{$CommonStore:u}=le(),k=ue(),r=new re(A),K=m.exports.useRef(0),[F,Q]=m.exports.useState(null),[S,L]=m.exports.useState(null),[y,I]=m.exports.useState({visible:!1,desc:"",type:"N"}),[f,B]=m.exports.useState({visible:!1,description:"",value:"",codeValue:"",datas:{},id:"",viewId:"",selectedData:{}}),X=()=>{const e=u.Codeclass.selData;Q(e),B({visible:!1}),u.fSetCodeclassPopup(!1)},Y=()=>{document.getElementById(f.id).focus(),B({visible:!1}),u.fSetCodeclassPopup(!1)},Z=(e,a)=>{e.key==="Enter"?e.target.value||O?E(a,v,e.target.value,!0):N():e.key==="Tab"&&!u.fGetShift()&&(e.target.value||O?E(a,v,e.target.value,!0):h?h():N()),e.ctrlKey&&e.which===32&&E(a,v,e.target.value,!0)},q=e=>{(e.key==="Backspace"||e.key==="Delete")&&(u.fSetCodeclass({selData:{},inputId:r.fMakeId(l),inputName:l,inputType:"DEL",isHelper:g}),w())},N=()=>{const e=document.getElementsByClassName("inputCls"),a=Object.values(e).filter(t=>t.id.includes(A)),n=Number(document.getElementById(r.fMakeId(l)).getAttribute("tabindex"))+1;for(let t=a.length;t--;){const d=Number(a[t].getAttribute("tabindex"));n===d&&setTimeout(()=>{a[t].focus()})}},P=(e,a,n,t)=>{a==="CODECLASS"&&(u.fSetChangeValue({inputId:r.fMakeId(l),inputName:l,inputValue:ee(l,n,t),inputType:a}),u.fSetCodeclass({selData:n,inputId:r.fMakeId(l),inputName:l,inputType:a,isHelper:g}),w()),L(e)},E=async(e,a,n="",t=!0)=>{let d="selectByTSqlItem",i={...g};a==="Cust"&&(d="selectByCustClass",i.iCustNm=n);try{let s=await de.get(`/@api/common/codeclass/${d}`,{params:i}),x=s.data[1],o={},C=0;x.map((D,j,H)=>{if(a==="Cust")D.custnm===(n.length>0&&n)&&(o={...o,...H[j]},C+=1);else{const te=U=>a==="Pno"?U.trim()===(n.length>0&&n):U===(n.length>0&&n);Object.values(D).some(te)&&(o={...o,...H[j]},C+=1)}});let p=0;s.data[0].map(D=>{p+=Number(D.Size)}),K.current=p<470?470:p+80,Object.keys(o).length<1&&t?(B({visible:!0,datas:s.data,desc:s.data[2][0].Remark,value:S,codeValue:R,id:r.fMakeId(l),viewId:e,selectedData:F}),u.fSetCodeclassPopup(!0)):Object.keys(o).length>0&&(C>1?(B({visible:!0,datas:s.data,desc:s.data[2][0].Remark,value:S,codeValue:R,id:r.fMakeId(l),viewId:e,selectedData:F}),u.fSetCodeclassPopup(!0)):(h?h():N(),P(S,"CODECLASS",o,a),document.removeEventListener("keydown",V)))}catch(s){if(s.response&&s.response.status===404){I({visible:!0,desc:"\uC870\uD68C\uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."});return}else{I({visible:!0,desc:"\uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."+s});return}}},ee=(e,a,n)=>{let t={};const d=(i,s,x,o)=>{const C=[i],p=[s];C.indexOf(x)>-1&&(t={...t,minorcd:o.trim()}),p.indexOf(x)>-1&&(t={...t,minornm:o.trim()})};for(const[i,s]of Object.entries(a))if(s)switch(n){case"Cust":d("custcd","custnm",i,s);break;case"Dept":d("deptcd","deptnm",i,s);break;case"Pno":d("pno","name",i,s);break;case"Shop":d("shopcd","shopnm",i,s);break;case"Class4":{const x=["minorcd"],o=["minornm"],C=["item1"],p=["item2"];x.indexOf(i)>-1&&(t={...t,minorcd:s.trim()}),o.indexOf(i)>-1&&(t={...t,minornm:s.trim()}),C.indexOf(i)>-1&&(t={...t,item1:s.trim()}),p.indexOf(i)>-1&&(t={...t,item2:s.trim()})}break;default:d("minorcd","minornm",i,s);break}return t},V=m.exports.useCallback(e=>{e.key==="Enter"&&y.visible&&I({visible:!1,disc:""})},[]);return m.exports.useEffect(()=>{document.addEventListener("keydown",V)},[]),m.exports.useEffect(()=>{L(T)},[T]),c.createElement(c.Fragment,null,c.createElement(ne,{visible:f.visible,description:f.desc,value:f.value,datas:f.datas,id:f.id,codeValue:f.codeValue,viewId:f.viewId,selectedData:f.selectedData,width:K.current,onConfirm:w,onCancel:()=>r.fCancel(l),setVisibleData:X,setVisibleCancel:Y}),c.createElement(b,{className:k.BoxAlignStyle},c.createElement(b,{className:k.TitleBox,style:G},c.createElement("span",{className:k.TitleText},$),O&&c.createElement(b,{className:k.TitleBoxR},c.createElement(ie,{size:10}))),g&&c.createElement(b,{onKeyDown:e=>{Z(e,l)},onKeyUp:e=>{q(e)}},c.createElement(oe.exports.TextBox,{key:r.fMakeId(l),inputCls:W,inputId:r.fMakeId(l),placeholder:M||"",className:k.InputBox,onChange:e=>P(e),value:S,style:_,name:l,disabled:z,editable:J,addonRight:()=>c.createElement(b,{className:"textbox-icon icon-search",title:"Codeclass",onClick:()=>{z||E(r.fMakeId(l),v,"",!0)}})}))),c.createElement(ce,{visible:y.visible,description:y.desc,type:y.type,onConfirm:()=>I({visible:!1})}))}),ue=ae({TitleBox:{margin:"3px 15px",backgroundColor:"#e0ecff",color:"#163971",padding:5,height:25,fontSize:"12px",alignItems:"center",width:110,fontWeight:600,display:"inline-block",position:"relative"},TitleBoxR:{position:"absolute",right:5,top:4,color:"#ffa8a8"},TitleText:{width:100},InputBox:{width:185,height:25,"& input":{fontSize:"12px !important"},"& textarea":{fontSize:"12px !important",fontFamily:"Noto Sans KR"}},RadioLabel:{display:"flex",alignItems:"center",height:20,width:50,fontSize:12,margin:"0px 1px"},BoxAlignStyle:{marginTop:3,display:"flex",alignItems:"end"}});export{Ce as C};
