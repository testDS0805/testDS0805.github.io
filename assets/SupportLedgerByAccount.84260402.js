import{r as u,R as t}from"./index.da6908f5.js";import{m as i,h as f,o as z,B as d,u as pe,c as Ye,U as ke,P as le,r as B,ad as Ue,A as Pe,C as Le}from"./App.11263b70.js";import{C as Oe}from"./CommonButton.0b792d77.js";import{C as ce}from"./CommonDatePicker.d7bc57f8.js";import{A as $e}from"./AccountCodeHelper.ec946c1a.js";import{C as He}from"./CodeHelperPopup.3932fdb9.js";import{E as se}from"./ExcelCreate.944bd0b9.js";import"./index.6f186c21.js";const Xe=[{fieldName:"Gldref",dataType:i.exports.ValueType.TEXT},{fieldName:"GldRefNm",dataType:i.exports.ValueType.TEXT}],ze=[{name:"Gldref",fieldName:"Gldref",type:"data",width:"100",header:{text:"\uAD00\uB9AC\uCF54\uB4DC",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"GldrefNm",fieldName:"GldrefNm",type:"data",width:"150",header:{text:"\uAD00\uB9AC\uCF54\uB4DC\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"}],We=[{fieldName:"ActCod",dataType:i.exports.ValueType.TEXT},{fieldName:"ACTNME",dataType:i.exports.ValueType.TEXT},{fieldName:"AMT001",dataType:i.exports.ValueType.NUMBER},{fieldName:"AMT002",dataType:i.exports.ValueType.NUMBER},{fieldName:"AMT003",dataType:i.exports.ValueType.NUMBER},{fieldName:"AMT004",dataType:i.exports.ValueType.NUMBER},{fieldName:"Class",dataType:i.exports.ValueType.TEXT},{fieldName:"date1",dataType:i.exports.ValueType.TEXT},{fieldName:"date2",dataType:i.exports.ValueType.TEXT},{fieldName:"detail",dataType:i.exports.ValueType.TEXT},{fieldName:"Drcdcd",dataType:i.exports.ValueType.TEXT},{fieldName:"factorynm",dataType:i.exports.ValueType.TEXT},{fieldName:"Gldref",dataType:i.exports.ValueType.TEXT},{fieldName:"Gldrnm",dataType:i.exports.ValueType.TEXT},{fieldName:"Remark",dataType:i.exports.ValueType.TEXT},{fieldName:"seq",dataType:i.exports.ValueType.TEXT},{fieldName:"Seqno",dataType:i.exports.ValueType.TEXT},{fieldName:"Slipno",dataType:i.exports.ValueType.TEXT},{fieldName:"SlpDat",dataType:i.exports.ValueType.TEXT},{fieldName:"Spline",dataType:i.exports.ValueType.TEXT}],qe=[{name:"SlpDat",fieldName:"SlpDat",type:"data",width:"100",header:{text:"\uC804\uD45C\uC77C\uC790",showTooltip:!0},editable:!1,renderer:{type:"text",showTooltip:!0},styleName:"center-column"},{name:"Remark",fieldName:"Remark",type:"data",width:"350",header:{text:"\uC801\uC694",showTooltip:!0},editable:!0,renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"AMT001",fieldName:"AMT001",type:"data",width:"150",header:{text:"\uCC28\uBCC0\uAE08\uC561",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editable:!1,styleName:"right-column",numberFormat:"#,##0",zeroText:""},{name:"AMT002",fieldName:"AMT002",type:"data",width:"150",header:{text:"\uB300\uBCC0\uAE08\uC561",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editable:!1,styleName:"right-column",numberFormat:"#,##0",zeroText:""},{name:"AMT003",fieldName:"AMT003",type:"data",width:"150",header:{text:"\uC794\uC561",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editable:!1,styleName:"right-column",numberFormat:"#,##0",zeroText:""}],Je=[{fieldName:"Factory",dataType:i.exports.ValueType.TEXT},{fieldName:"Factorynm",dataType:i.exports.ValueType.TEXT},{fieldName:"SLIPNO",dataType:i.exports.ValueType.TEXT},{fieldName:"SPLINE",dataType:i.exports.ValueType.TEXT},{fieldName:"ACTCD",dataType:i.exports.ValueType.TEXT},{fieldName:"ACTNM",dataType:i.exports.ValueType.TEXT},{fieldName:"DRSAMT",dataType:i.exports.ValueType.NUMBER},{fieldName:"CRSAMT",dataType:i.exports.ValueType.NUMBER},{fieldName:"RMKNM1",dataType:i.exports.ValueType.TEXT}],Ke=[{name:"Factorynm",fieldName:"Factorynm",type:"data",width:"60",header:{text:"\uACF5\uC7A5",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"center-column"},{name:"SLIPNO",fieldNames:"SLIPNO,SPLINE",type:"series",width:"100",header:{text:"\uC804\uD45C\uBC88\uD638",showTooltip:!0},renderer:{type:"series",valueSeparator:"-",showTooltip:!0},styleName:"center-column"},{name:"ACTNM",fieldName:"ACTNM",type:"data",width:"150",header:{text:"\uACC4\uC815\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"center-column"},{name:"DRSAMT",fieldName:"DRSAMT",type:"data",width:"120",header:{text:"\uCC28\uBCC0",showTooltip:!0},renderer:{type:"text",showTooltip:!0},footer:{text:"\uCC28\uBCC0 \uD569\uACC4",expression:"sum",numberFormat:"#,##0"},styleName:"right-column",numberFormat:"#,###"},{name:"CRSAMT",fieldName:"CRSAMT",type:"data",width:"120",header:{text:"\uB300\uBCC0",showTooltip:!0},renderer:{type:"text",showTooltip:!0},footer:{text:"\uB300\uBCC0 \uD569\uACC4",expression:"sum",numberFormat:"#,##0"},styleName:"right-column",numberFormat:"#,###"},{name:"RMKNM1",fieldName:"RMKNM1",type:"data",width:"650",header:{text:"\uC801\uC694",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"}],je={DateTitleBox:{margin:"5px 10px 0px 15px",backgroundColor:"#e0ecff",padding:5,color:"#163971",height:25,fontSize:"12px",display:"flex",width:85,alignItems:"center",fontWeight:600},TitleBox4:{backgroundColor:"#fccf76",color:"#163971",padding:5,height:20,fontSize:"12px",display:"flex",alignItems:"center",width:"100%",fontWeight:600},TitleText3:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},ValueBox:{width:162,height:25,margin:"4px 0px 4px 5px"},ComboBox:{width:120,margin:"1px 0px 4px 0px",height:25},SearchBox:{width:285,height:25,margin:"1px 0px 4px 0px"},InputBox3:{marginTop:5,width:120,height:25,"& input":{fontSize:"12px !important"}},Scroll:{"& .mainCon":{height:"700px",padding:"10px"}},SA1:{width:80,height:25,margin:"3px 3px",backgroundColor:"#e0ecff",color:"#163971",paddingTop:3,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SA2:{marginTop:-2,marginLeft:5,alignItems:"center",textAlign:"center"},SA3:{width:"15px!important",height:"15px!important",border:"1px solid #3c96ff",marginTop:"1px","& .checkbox-checked":{border:0,background:"#3c96ff"}},SA4:{width:90,height:25,"& input":{fontSize:"12px !important"}},SA5:{marginLeft:5,width:140,height:25,"& input":{fontSize:"12px !important"}},SA6:{width:70,height:25,margin:"3px 3px",backgroundColor:"#fccf76",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600},SB1:{width:253,height:32,"& input":{fontSize:"16px !important",textAlign:"center",color:"#0070c0"}},SB2:{fontSize:12,paddingBottom:2,fontWeight:500},SC1:{width:90,height:25,margin:"3px 10px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SC2:{width:80},SC3:{width:200,height:25,"& input":{fontSize:"12px !important"}},SC4:{width:200,height:25,"& input":{fontSize:"12px !important",textAlign:"right"}},SC5:{fontSize:12,paddingBottom:2,fontWeight:500,marginLeft:5},SC6:{width:150,height:25,"& input":{fontSize:"12px !important",textAlign:"center"}},SC7:{width:80,height:29,margin:"3px 1px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SC8:{"& textarea":{fontSize:"12px !important"}}};function Ce(){const[e,l]=u.exports.useState({Factory:"",FactoryNm:"",SchFrDate:f().startOf("month"),SchToDate:new Date,ActCd:"",ActNm:"",SchAccountGroupCd:"",SchAccountGroupNm:""}),[n,r]=u.exports.useState({a:""}),[a,c]=u.exports.useState([]),[s,h]=u.exports.useState(""),[y,E]=u.exports.useState({visible:!1,desc:"",type:"N"}),[v,g]=u.exports.useState({visible:!1,desc:"",id:""}),[Y,$]=u.exports.useState({visible:!1,description:"",value:"",datas:{},id:"",viewId:"",selectedData:{}});return String.prototype.DateValidation=function(G){return new Date(this)instanceof Date&&!isNaN(new Date(this))?f(this).format(G):null},{searchVO:e,setSearchVO:l,headerVO:n,setHeaderVO:r,gridFocus:s,setGridFocus:h,alert:y,setAlert:E,confirm:v,setConfirm:g,codeClassInputs:Y,setCodeClassInputs:$,accountGroup:a,setAccountGroup:c}}const _e=async(e,l,n)=>{e({Factory:n.User.user.factory,FactoryNm:n.User.user.factorynm,SchFrDate:f().startOf("month"),SchToDate:new Date,ActCd:"",ActNm:"",SchAccountGroupCd:"",SchAccountGroupNm:""},50),l({a:""},50)},Qe=async(e,l,n)=>{if(e.ActCd===""||e.ActCd===void 0||e.ActCd===null)return;const r={};r.ActCd=e.ActCd;try{const a=await n.Util.Command.fSearchByReturn("/@api/account/supportLedgerByAccount/selectByActGroup",r);let c=[];a.length!==0&&a.forEach(s=>{s.Sort!=="HND"&&c.push({value:s.GroupCd,text:s.GroupNm})}),setTimeout(()=>{l(c)},50)}catch(a){n.setAlert({visible:!0,desc:`\uAD00\uB9AC \uD56D\uBAA9 \uBD84\uB958 \uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.
${a}`,type:"E"})}},Ze=async(e,l,n)=>{const r={...e};r.Accunit=n.User.user.accunit,r.SchFrDate=f(r.SchFrDate).format("YYYYMMDD"),r.SchToDate=f(r.SchToDate).format("YYYYMMDD");try{const a=await n.Util.Command.fSearchByReturn("/@api/account/supportLedgerByAccount/selectByList",r);l.setRows(a)}catch(a){n.setAlert({visible:!0,desc:`\uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.
${a}`,type:"E"})}},et=async(e,l,n)=>{const r={...e};try{const a=await n.Util.Command.fSearchByReturnTrim("/@api/account/supportLedgerByAccount/selectByHeaderList",r);l.setRows(a)}catch(a){n.setAlert({visible:!0,desc:`\uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.
${a}`,type:"E"})}},tt=async(e,l)=>{const n={...e};try{const r=await l.Util.Command.fSearchByReturnTrim("/@api/account/supportLedgerByAccount/selectByExcelList",n);return r===void 0?[{Seq:1,Slpdat:"",Amount:"",Remark:"",DrsAmt:"",CrsAmt:"",Gubun:n.GldRef}]:r}catch(r){l.setAlert({visible:!0,desc:`\uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.
${r}`,type:"E"})}},rt=async(e,l,n,r)=>{await Promise.all(l.map(async a=>{const c={...e};c.GldRef=a;try{const s=await r.Util.Command.fSearchByReturnTrim("/@api/account/supportLedgerByAccount/selectByExcelList",c);s===void 0?n.push([{Seq:1,Slpdat:"",Amount:"",Remark:"",DrsAmt:"",CrsAmt:"",Gubun:a}]):n.push(s),r.Common.fSetLoading(!0)}catch(s){r.setAlert({visible:!0,desc:`\uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.
${s}`,type:"E"})}}))},at=async(e,l,n)=>{const r={};r.Slpdat=e.SlpDat,r.Slipno=e.Slipno,r.Factory=n.User.user.factory,r.Accunit=n.User.user.accunit;const a={};a.Factory=n.User.user.factory,a.Slpdat=e.SlpDat,a.Slipno=e.Slipno;try{const c=await n.Util.Command.fSearchByReturnTrim("/@api/account/supportLedgerByAccount/selectByDetailList",r);return c===void 0||c.length<1?null:(l.setRows(c),await n.Util.Command.fSearchByReturn("/@api/account/supportLedgerByAccount/selectByDoc",a))}catch(c){return n.setAlert({visible:!0,desc:`\uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.
${c}`,type:"E"}),null}},nt=z(e=>{const l=u.exports.useRef(null),n=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),j=new i.exports.LocalDataProvider(!1),b=new i.exports.GridView(l.current),e.Util.Grid.fInitGridHeader(b,j,e.GridFields,e.GridColumns,25,r,a,c),b.displayOptions.rowHeight=25,b.setEditOptions({editable:!0}),b.onItemChecked=()=>{e.setGridFocus("R")},b.setRowStyleCallback((s,h)=>{const y=s.getValue(h.index,"Slpdat");if(y.substring(6,8)==="99"||y.substring(6,8)==="98"||y.substring(6,8)==="00")return"rg-green-color"}),e.DataProviderBind(j),e.GridViewBind(b)},r=async(s,h,y)=>{y>=0&&e.RowChanged(s,y)},a=(s,h)=>{e.currentIndex.current===h&&h>=0&&e.RowChanged(s,h.dataRow)},c=async(s,h)=>{switch(e.setGridFocus("R"),h.key){}};return u.exports.useEffect(()=>{n()},[]),t.createElement(t.Fragment,null,t.createElement(d,{ref:l,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:345}}))});let j,b;const ot=z(e=>{const l=u.exports.useRef(null),n=[""];pe(),Ce();const r=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),_=new i.exports.LocalDataProvider(!1),M=new i.exports.GridView(l.current),e.Util.Grid.fInitGridHeader(M,_,e.GridFields,e.GridColumns,null,null,a),M.displayOptions.rowHeight=25,M.onItemChecked=()=>{e.setGridFocus("R")},M.onValidateColumn=(c,s,h,y)=>{const E={};return n[0].includes(s.fieldName)&&(!y||y===void 0)&&(E.level="warning",E.message="\uD544\uC218 \uC785\uB825 \uAC12\uC785\uB2C8\uB2E4."),E},e.DataProviderBind(_),e.GridViewBind(M)},a=async(c,s)=>{switch(e.setGridFocus("R"),s.key){}};return u.exports.useEffect(()=>{r()},[]),t.createElement(t.Fragment,null,t.createElement(d,{ref:l,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:380}}))});let _,M;const ut=z(e=>{const l=u.exports.useRef(null),n=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),Q=new i.exports.LocalDataProvider(!1),L=new i.exports.GridView(l.current),e.Util.Grid.fInitGridHeader(L,Q,e.GridFields,e.GridColumns,25,r,a,null),L.displayOptions.rowHeight=25,L.onItemChecked=()=>{e.setGridFocus("S")},e.DataProviderBind(Q),e.GridViewBind(L)},r=async(c,s,h)=>{h>=0&&e.RowChanged(c,h)},a=(c,s)=>{e.currentIndex.current===s&&s>=0&&e.RowChanged(c,s.dataRow)};return u.exports.useEffect(()=>{n()},[]),t.createElement(t.Fragment,null,t.createElement(d,{ref:l,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:635}}))});let Q,L;const ht=z(()=>{const e="SUPPORTLEDGERBYACCOUNT",{$CommonStore:l,$UserStore:n}=pe(),r=it(),{searchVO:a,setSearchVO:c,headerVO:s,setHeaderVO:h,gridFocus:y,setGridFocus:E,alert:v,setAlert:g,confirm:Y,setConfirm:$,accountGroup:G,setAccountGroup:ee}=Ce(),x=new ke(e,g,!0,!0,!0,!0,!0),W=u.exports.useRef(0),q=u.exports.useRef(!1),J=u.exports.useRef(""),H=u.exports.useRef(""),w=u.exports.useRef(""),X=u.exports.useRef(0),me=u.exports.useRef(!0),V=u.exports.useRef(""),K=u.exports.useRef(""),k=u.exports.useRef(""),fe=u.exports.useRef(""),N=u.exports.useRef(f().startOf("month")),U=u.exports.useRef(new Date),te=u.exports.useRef(""),P=u.exports.useRef(""),[he,re]=u.exports.useState(""),[ae,ne]=u.exports.useState(),[xe,ye]=u.exports.useState(0),oe=async()=>{l.fSetBinding(!0),await _e(c,h,R),l.fSetBinding(!1),x.Common.fSetTabIndex()},[R]=u.exports.useState({Util:x,User:n,Common:l,fInit:oe,setAlert:g,setHeaderVO:h}),ge=o=>{T=o},Te=o=>{Z=o},Ae=o=>{de=o},De=o=>{},Se=o=>{},we=o=>{},ue=(o,C,p)=>{if(!l.fGetBinding())switch(o){case"ActCd":x.Common.fMultiFieldChange(c,{ActCd:C,ActNm:p}),x.Common.fMultiFieldChange(c,{SchAccountGroupCd:"",SchAccountGroupNm:""});break}},Be=async()=>{$({visible:!1,desc:"",id:""}),Y.id},Ee=o=>{if(O===void 0)return;re(o),P.current=o,T.clearRows();const C=P.current.split(",");C.length>1?T.setRows(O.filter(p=>String(p.Gldref).toUpperCase().includes(C[0].toUpperCase())||String(p.GldRefNm).toUpperCase().includes(C[0].toUpperCase())||String(p.Gldref).toUpperCase().includes(C[1].toUpperCase())||String(p.GldRefNm).toUpperCase().includes(C[1].toUpperCase()))):T.setRows(O.filter(p=>String(p.Gldref).toUpperCase().includes(P.current.toUpperCase())||String(p.GldRefNm).toUpperCase().includes(P.current.toUpperCase())))},Ne=()=>{const p=window.screenX+(window.outerWidth-790)/2,m=window.screenY+(window.outerHeight-900)/2,F=`/imagePopup?DocSource=${H.current}&DocNo=${J.current}&FilePath=${w.current}`,A=window.open(F,"ImagePopup",`width=${790},height=${900},left=${p},top=${m}`);ne(A)},Ge=()=>{$({visible:!1,desc:"",id:""})},ie=async()=>{if(a.SchAccountGroupCd===""){g({visible:!0,desc:"\uAD00\uB9AC\uD56D\uBAA9\uBD84\uB958\uB294 \uD544\uC218\uD56D\uBAA9\uC785\uB2C8\uB2E4",type:"E"});return}await Ze(a,T,R),T.getJsonRows().length===0&&T.getJsonRows().every((o,C)=>o===[][C])?O=[]:O=T.getJsonRows(),k.current=a.SchAccountGroupCd,V.current=a.ActCd,K.current=a.ActNm},Re=async(o,C)=>{const p=T.getJsonRow(C),m={};m.Factory=n.user.factory,m.Accunit=n.user.accunit,m.FrDate=f(N.current).format("YYYYMMDD"),m.ToDate=f(U.current).format("YYYYMMDD"),m.GldCd=k.current,m.ActCd=V.current,m.GldRef=p.Gldref,await et(m,Z,R),W.current=C,fe.current=p.GldRefNm},Fe=async(o,C)=>{const p=Z.getJsonRow(C),m=await at(p,de,R);m!==null?(J.current=m[0].DocNo,H.current=m[0].DocSource,X.current=m[0].Seq,Ie(H.current)):(J.current="",H.current="",w.current="",X.current=0)},Ie=async o=>{switch(o){case"CO":w.current="costamount";break;case"NEGO":w.current="NEGO";break;case"EI":w.current="importexpenses";break;case"EE":w.current="ExportExpenses";break;case"PO":w.current="delv";break;case"PM":w.current="delv";break;case"OD":w.current="OD";break;case"OF":break;case"AC":w.current="salesslip";break}},be=async()=>{let o=[],C=["","\uC804\uD45C\uC77C\uC790","\uC801\uC694","\uCC28\uBCC0\uAE08\uC561","\uB300\uBCC0\uAE08\uC561","\uC794\uC561"],p=[],m=[{wpx:20},{wpx:100},{wpx:550},{wpx:120},{wpx:120},{wpx:120}],F=[];try{const A=T.getJsonRow(W.current),D={};D.Factory=n.user.factory,D.Accunit=n.user.accunit,D.FrDate=f(N.current).format("YYYYMMDD"),D.ToDate=f(U.current).format("YYYYMMDD"),D.GldCd=k.current,D.ActCd=V.current,D.GldRef=A.Gldref,F.push(`\uAC80\uC0C9\uAE30\uAC04 : ${f(N.current).format("YYYYMMDD")} ~ ${f(N.current).format("YYYYMMDD")}  \uACF5 \uC7A5 \uBA85 : \uBCF8\uC0AC  \uACC4\uC815\uCF54\uB4DC : ${V.current} \uACC4\uC815\uCF54\uB4DC\uBA85: ${K.current}  \uAD6C\uBD84: ${A.Gldref} / ${A.GldRefNm}`),p.push(A.GldRefNm!==null?A.GldRefNm.substring(0,31):"");const S=await tt(D,R);return S===null||S.length===0?(g({visible:!0,desc:"error",type:"E"}),!1):(o.push(S),{fileName:`\uACC4\uC815\uBCC4\uBCF4\uC870\uC6D0\uC7A5_${k.current}`,excelData:o,excelHeaderName:C,excelSheetName:p,excelCellSize:m,excelRemark:F})}catch{return g({visible:!0,desc:"ERROR!",type:"E"}),null}},Ve=async()=>{let o=[],C=["","\uC804\uD45C\uC77C\uC790","\uC801\uC694","\uCC28\uBCC0\uAE08\uC561","\uB300\uBCC0\uAE08\uC561","\uC794\uC561"],p=[],m=[{wpx:20},{wpx:100},{wpx:550},{wpx:120},{wpx:120},{wpx:120}],F=[],A=[];const D=T.getJsonRows();if(D.length===0)return g({visible:!0,desc:"\uADF8\uB9AC\uB4DC\uC5D0 \uC790\uB8CC\uAC00 \uC788\uC5B4\uC57C \uAC00\uB2A5\uD569\uB2C8\uB2E4!"}),null;const S={};return S.Factory=n.user.factory,S.Accunit=n.user.accunit,S.FrDate=f(N.current).format("YYYYMMDD"),S.ToDate=f(U.current).format("YYYYMMDD"),S.GldCd=k.current,S.ActCd=V.current,await D.forEach(async I=>{F.push(`\uAC80\uC0C9\uAE30\uAC04 : ${f(N.current).format("YYYYMMDD")} ~ ${f(N.current).format("YYYYMMDD")}  \uACF5 \uC7A5 \uBA85 : \uBCF8\uC0AC  \uACC4\uC815\uCF54\uB4DC : ${V.current} \uACC4\uC815\uCF54\uB4DC\uBA85: ${K.current}  \uAD6C\uBD84: ${I.Gldref} / ${I.GldRefNm}`),A.push(I.Gldref),p.push(I.GldRefNm!==null?I.GldRefNm:"")}),await rt(S,A,o,R),o.sort((I,ve)=>I[0].Gubun-ve[0].Gubun),{fileName:`\uACC4\uC815\uBCC4\uBCF4\uC870\uC6D0\uC7A5/${f(N.current).format("YYYYMMDD")}_${f(U.current).format("YYYYMMDD")}`,excelData:o,excelHeaderName:C,excelSheetName:p,excelCellSize:m,excelRemark:F}};return u.exports.useEffect(()=>{x.Common.fHotKey(l,l.isPopup,null,ie,null,null,null)},[l.HotKey]),u.exports.useEffect(()=>{oe();const o=setInterval(()=>{ye(C=>C+1)},1e3);return()=>{clearInterval(o)}},[]),u.exports.useEffect(()=>{if(ae)ae.closed?(ne(),q.current=!1):q.current=!0;else{q.current=!1;return}},[xe]),u.exports.useEffect(()=>{ee([]),Qe(a,ee,R)},[a.ActCd]),u.exports.useEffect(()=>{G.length!==0&&x.Common.fMultiFieldChange(c,{SchAccountGroupCd:G[0].value,SchAccountGroupNm:G[0].text})},[G]),t.createElement(t.Fragment,null,t.createElement(Oe,{pgmid:e,visible:"010000",onSearch:ie}),t.createElement(le,{className:"mainCon"},t.createElement(B.exports.Layout,{style:{width:"100%",height:775}},t.createElement(B.exports.LayoutPanel,{region:"west",split:!0,style:{minWidth:440,maxWidth:440,height:775}},t.createElement(le,{className:r.Scroll},t.createElement(d,{style:{marginTop:5}},t.createElement(d,{style:{display:"flex",alignItems:"center"}},t.createElement(d,{className:r.SA1,style:{width:80,height:25,margin:"1px 10px 4px 5px"}},t.createElement(d,{className:r.SA2},"\uAC80\uC0C9\uAE30\uAC04")),t.createElement(d,{style:{display:"flex",alignItems:"center"}},t.createElement(ce,{style:{width:80,height:19,borderRadius:"4px"},inputeCls:"inputCls",selected:a.SchFrDate,inputId:x.Common.fMakeId("SchFrDate"),onHandleDateChange:o=>{x.Common.fFieldChange(c,"SchFrDate",o),N.current=o}}),t.createElement(d,{style:{margin:"0 3px",width:"10px"}},"~"),t.createElement(ce,{style:{width:80,height:19,borderRadius:"4px"},inputeCls:"inputCls",selected:a.SchToDate,inputId:x.Common.fMakeId("SchToDate"),onHandleDateChange:o=>{x.Common.fFieldChange(c,"SchToDate",o),U.current=o}}))),t.createElement(d,{display:"flex",alignItems:"center"},t.createElement($e,{inputCls:"inputCls",pgmid:e,inputType:"Act",id:"ActCd",Init:me.current,title:"\uACC4\uC815\uACFC\uBAA9",helper:x.CodeHelper.helperActcode,ComponentValue:a.ActCd,SetValue:ue,boxStyles:{display:"flex",alignItems:"center"},labelStyles:{width:80,height:25,margin:"1px 10px 4px 5px",padding:5,fontSize:12,display:"flex",alignItems:"center",fontWeight:600},inputStyles:{width:120,height:25,margin:"1px 0px 4px 0px"},inputRequired:!0}),t.createElement(B.exports.TextBox,{className:r.ValueBox,editable:!1,value:a.ActNm})),t.createElement(d,{display:"flex",alignItems:"center"},t.createElement(d,{className:r.SA1,style:{width:80,height:25,margin:"1px 10px 4px 5px"}},t.createElement(d,{className:r.SA2},"\uAD00\uB9AC\uD56D\uBAA9\uBD84\uB958")),t.createElement(B.exports.ComboBox,{inputCls:"inputCls",inputId:x.Common.fMakeId("SchAccountGroupCd"),data:G,value:a.SchAccountGroupCd,editable:!1,onChange:o=>{x.Common.fFieldChange(c,"SchAccountGroupCd",o),T.clearRows()},panelStyle:{height:100},className:r.ComboBox}),t.createElement(He,{inputCls:"inputCls",pgmid:e,inputType:"",id:"Factory",title:"\uACF5\uC7A5\uBA85",helper:x.CodeHelper.helperFactory,ComponentCode:a.Factory,ComponentValue:a.FactoryNm,SetValue:ue,labelStyles:{width:70,height:25,margin:"1px 10px 4px 5px",padding:5,fontSize:12,display:"flex",alignItems:"center",fontWeight:600},inputStyles:{width:80,height:25,margin:"1px 0px 4px 0px"},inputRequired:!0})),t.createElement(d,{style:{display:"flex",alignItems:"center"}},t.createElement(d,{className:r.SA1,style:{width:80,height:25,margin:"1px 10px 4px 5px"}},t.createElement(d,{className:r.SA2},"\uAC80\uC0C9\uB2E8\uC5B4")),t.createElement(B.exports.TextBox,{ref:te,className:r.SearchBox,onChange:Ee,value:he,name:"iClass4",addonRight:()=>t.createElement(d,{className:"textbox-icon icon-clear",title:"Clear value",onClick:()=>{re(""),te.current="",P.current=""}})})),t.createElement(d,{style:{marginTop:5}},t.createElement(ut,{Util:x,Id:"SearchGrid",GridTitle:"Search",currentIndex:W,GridFields:Xe,GridColumns:ze,RowChanged:Re,setGridFocus:E,setAlert:g,DataProviderBind:ge,GridViewBind:De}))))),t.createElement(B.exports.LayoutPanel,{region:"center",split:!0,style:{minWidth:400,maxWidth:1400,height:774}},t.createElement(B.exports.Layout,null,t.createElement(B.exports.LayoutPanel,{region:"north",style:{height:"50%"}},t.createElement(d,{style:{height:"10%",display:"flex",alignItems:"center",justifyContent:"flex-end"}},t.createElement(d,{style:{marginRight:15}},t.createElement(d,{style:{display:"flex",alignItems:"center"}},t.createElement(B.exports.LinkButton,{disabled:X.current===0,onClick:()=>Ne()},X.current,"\uAC74",t.createElement(Ue,{style:{marginLeft:10}})),t.createElement(se,{buttonName:"\uC5D1\uC140\uCD94\uCD9C(\uB2E8\uC77C)",getExcelData:be,type:"SupportLedger"}),t.createElement(se,{buttonName:"\uC5D1\uC140\uCD94\uCD9C(\uC804\uCCB4)",getExcelData:Ve,type:"SupportLedger"})))),t.createElement(d,{style:{width:"100%"}},t.createElement(nt,{Util:x,Id:"HeaderGrid",GridTitle:"Header",GridFields:We,GridColumns:qe,RowChanged:Fe,setGridFocus:E,setAlert:g,DataProviderBind:Te,GridViewBind:Se}))),t.createElement(B.exports.LayoutPanel,{region:"center"},t.createElement(d,{style:{width:"100%"}},t.createElement(ot,{Util:x,Id:"DetailGrid",GridTitle:"Detail",GridFields:Je,GridColumns:Ke,setGridFocus:E,setAlert:g,DataProviderBind:Ae,GridViewBind:we}))))))),t.createElement(Pe,{visible:v.visible,description:v.desc,type:v.type,onConfirm:()=>g({visible:!1})}),t.createElement(Le,{visible:Y.visible,description:Y.desc,onCancel:Ge,onConfirm:Be}))});let T,Z,de,O;const it=Ye(je);export{ht as default};
