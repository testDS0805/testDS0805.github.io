import{r as B,R as e}from"./index.da6908f5.js";import{m as u,o as z,B as l,d as U,h as T,u as de,c as Ie,b as Me,U as ve,P as Ue,r as w,a7 as Ge,a8 as ke,a9 as Pe,C as Ye,A as Le,q as _e}from"./App.11263b70.js";import{S as Qe}from"./ReturnSalesStyle.00990502.js";import{C as Xe,e as We}from"./CommonButton.0b792d77.js";import{C as q}from"./CommonDatePicker.d7bc57f8.js";import"./index.6f186c21.js";const He=[{fieldName:"BalNo",dataType:u.exports.ValueType.TEXT},{fieldName:"BalSeq",dataType:u.exports.ValueType.TEXT},{fieldName:"GoodCd",dataType:u.exports.ValueType.TEXT},{fieldName:"GoodNo",dataType:u.exports.ValueType.TEXT},{fieldName:"GoodNm",dataType:u.exports.ValueType.TEXT},{fieldName:"Spec",dataType:u.exports.ValueType.TEXT},{fieldName:"UnitCd",dataType:u.exports.ValueType.TEXT},{fieldName:"BalQty",dataType:u.exports.ValueType.NUMBER},{fieldName:"UnitNm",dataType:u.exports.ValueType.TEXT},{fieldName:"Weight",dataType:u.exports.ValueType.NUMBER},{fieldName:"Su",dataType:u.exports.ValueType.NUMBER},{fieldName:"NapQty",dataType:u.exports.ValueType.NUMBER},{fieldName:"MiNapQty",dataType:u.exports.ValueType.NUMBER},{fieldName:"MiWeight",dataType:u.exports.ValueType.NUMBER},{fieldName:"Price",dataType:u.exports.ValueType.NUMBER},{fieldName:"Amount",dataType:u.exports.ValueType.NUMBER},{fieldName:"BalDate",dataType:u.exports.ValueType.TEXT,datetimeFormat:"yyyyMMdd"},{fieldName:"NapDate",dataType:u.exports.ValueType.TEXT,datetimeFormat:"yyyyMMdd"},{fieldName:"Remark",dataType:u.exports.ValueType.TEXT},{fieldName:"Clstype",dataType:u.exports.ValueType.TEXT},{fieldName:"isSelected",dataType:u.exports.ValueType.TEXT}],Je=[{fieldName:"BalNo",type:"data",width:95,header:{text:"\uBC1C\uC8FC\uBC88\uD638"},styleName:"center-column"},{fieldName:"BalSeq",type:"data",width:60,header:{text:"\uBC1C\uC8FC\uC21C\uBC88"},styleName:"center-column"},{fieldName:"BalDate",type:"data",width:75,numberFormat:"#,##0",styleName:"center-column",datetimeFormat:"yyyy-MM-dd",header:{text:"\uBC1C\uC8FC\uC77C"}},{fieldName:"GoodNo",type:"data",width:180,header:{text:"\uD488\uBC88"},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{fieldName:"GoodNm",type:"data",width:180,header:{text:"\uD488\uBA85"},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{fieldName:"Spec",type:"data",width:180,header:{text:"\uADDC\uACA9"},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{fieldName:"BalQty",type:"data",width:60,numberFormat:"#,##0.##",header:{text:"\uBC1C\uC8FC\uB7C9"},styleName:"right-column rg-text-red-color"},{fieldName:"UnitNm",type:"data",width:40,header:{text:"\uB2E8\uC704"},styleName:"center-column"},{fieldName:"Weight",type:"data",width:60,numberFormat:"#,##0.##",header:{text:"\uC911\uB7C9"},styleName:"right-column"},{fieldName:"Su",type:"data",width:60,numberFormat:"#,##0.##",styleName:"right-column ",header:{text:"\uAE38\uC774"}},{fieldName:"NapQty",type:"data",width:60,numberFormat:"#,##0.##",styleName:"right-column",header:{text:"\uB0A9\uD488\uB7C9"}},{fieldName:"MiNapQty",type:"data",width:60,numberFormat:"#,##0.##",styleName:"right-column rg-text-red-color",header:{text:"\uBBF8\uB0A9\uB7C9"}},{fieldName:"Price",type:"data",width:60,numberFormat:"#,##0.##",styleName:"right-column",header:{text:"\uBC1C\uC8FC\uB2E8\uAC00"}},{fieldName:"Amount",type:"data",width:70,numberFormat:"#,##0",styleName:"right-column",header:{text:"\uBC1C\uC8FC\uAE08\uC561"}},{fieldName:"NapDate",type:"data",width:75,styleName:"center-column",datetimeFormat:"yyyy-MM-dd",header:{text:"\uB0A9\uAE30\uC77C"}},{fieldName:"Remark",type:"data",width:180,numberFormat:"#,##0",styleName:"left-column",header:{text:"\uBE44\uACE0"},renderer:{type:"text",showTooltip:!0}},{fieldName:"Clstype",type:"data",width:40,numberFormat:"#,##0",styleName:"center-column",header:{text:"\uB9C8\uAC10"}}],qe=[{fieldName:"Accunit",dataType:u.exports.ValueType.TEXT},{fieldName:"Factory",dataType:u.exports.ValueType.TEXT},{fieldName:"No",dataType:u.exports.ValueType.TEXT},{fieldName:"SupNo",dataType:u.exports.ValueType.TEXT},{fieldName:"SupSeq",dataType:u.exports.ValueType.TEXT},{fieldName:"BalNo",dataType:u.exports.ValueType.TEXT},{fieldName:"BalSeq",dataType:u.exports.ValueType.TEXT},{fieldName:"DelvGuid",dataType:u.exports.ValueType.TEXT},{fieldName:"GoodCd",dataType:u.exports.ValueType.TEXT},{fieldName:"GoodNo",dataType:u.exports.ValueType.TEXT},{fieldName:"Spec",dataType:u.exports.ValueType.TEXT},{fieldName:"UnitCd",dataType:u.exports.ValueType.TEXT},{fieldName:"GoodNm",dataType:u.exports.ValueType.TEXT},{fieldName:"BalQty",dataType:u.exports.ValueType.NUMBER},{fieldName:"UnitNm",dataType:u.exports.ValueType.TEXT},{fieldName:"NapQty",dataType:u.exports.ValueType.NUMBER},{fieldName:"Qty",dataType:u.exports.ValueType.NUMBER},{fieldName:"Su",dataType:u.exports.ValueType.NUMBER},{fieldName:"MiNapQty",dataType:u.exports.ValueType.NUMBER},{fieldName:"ErrorQty",dataType:u.exports.ValueType.NUMBER},{fieldName:"Price",dataType:u.exports.ValueType.NUMBER},{fieldName:"Tax",dataType:u.exports.ValueType.NUMBER},{fieldName:"Amount",dataType:u.exports.ValueType.NUMBER},{fieldName:"OkAmt",dataType:u.exports.ValueType.NUMBER},{fieldName:"BalAmount",dataType:u.exports.ValueType.NUMBER},{fieldName:"SupplyDate",dataType:u.exports.ValueType.TEXT,datetimeFormat:"yyyyMMdd"},{fieldName:"Clstype",dataType:u.exports.ValueType.TEXT},{fieldName:"QcPno",dataType:u.exports.ValueType.TEXT},{fieldName:"QcDate",dataType:u.exports.ValueType.TEXT},{fieldName:"QcOkQty",dataType:u.exports.ValueType.TEXT},{fieldName:"isSelected",dataType:u.exports.ValueType.TEXT},{fieldName:"Remark",dataType:u.exports.ValueType.TEXT},{fieldName:"Hcn",dataType:u.exports.ValueType.TEXT},{fieldName:"RealWeight",dataType:u.exports.ValueType.NUMBER}],Ke=[{fieldName:"No",type:"data",width:30,editable:!1,styleName:"center-column ",header:{text:"No"}},{fieldName:"BalNo",type:"data",width:100,editable:!1,styleName:"center-column ",header:{text:"\uBC1C\uC8FC\uBC88\uD638"}},{fieldName:"BalSeq",type:"data",width:55,editable:!1,header:{text:"\uBC1C\uC8FC\uC21C\uBC88"},styleName:"center-column "},{fieldName:"GoodNo",type:"data",width:180,editable:!1,header:{text:"\uD488\uBC88"},renderer:{type:"text",showTooltip:!0},styleName:"left-column "},{fieldName:"GoodNm",type:"data",width:180,editable:!1,header:{text:"\uD488\uBA85"},renderer:{type:"text",showTooltip:!0},styleName:"left-column "},{fieldName:"Spec",type:"data",width:180,editable:!1,header:{text:"\uADDC\uACA9"},renderer:{type:"text",showTooltip:!0},styleName:"left-column "},{fieldName:"BalAmount",type:"data",width:80,styleName:"right-column ",numberFormat:"#,##0",editable:!1,header:{text:"\uBC1C\uC8FC\uAE08\uC561"},renderer:{type:"text",showTooltip:!0},footer:{numberFormat:"#,##0",expression:"sum"}},{fieldName:"BalQty",type:"data",width:60,numberFormat:"#,##0.##",editable:!1,styleName:"right-column  ",header:{text:"\uBC1C\uC8FC\uB7C9"},footer:{numberFormat:"#,##0.##",expression:"sum"}},{fieldName:"UnitNm",type:"data",width:40,editable:!1,header:{text:"\uB2E8\uC704"},renderer:{type:"text"},styleName:"center-column "},{fieldName:"NapQty",type:"data",width:60,numberFormat:"#,##0.##",styleName:"right-column rg-text-red-color",header:{template:"<span style='color:#ff6000'>\uB0A9\uD488\uB7C9 *</span>"},footer:{numberFormat:"#,##0.##",expression:"sum"}},{fieldName:"RealWeight",type:"data",width:60,numberFormat:"#,##0.##",styleName:"right-column ",header:{template:"<span style='color:#ff6000'>\uC2E4\uC911\uB7C9</span>"},renderer:{type:"text",showTooltip:!0},footer:{numberFormat:"#,##0.##",expression:"sum"}},{fieldName:"Qty",type:"data",width:60,editable:!1,numberFormat:"#,##0.##",styleName:"right-column ",header:{text:"\uC911\uB7C9"},renderer:{type:"text",showTooltip:!0},footer:{numberFormat:"#,##0.##",expression:"sum"}},{fieldName:"Su",type:"data",width:60,editable:!1,numberFormat:"#,##0.##",styleName:"right-column ",header:{text:"\uAE38\uC774"},footer:{numberFormat:"#,##0.##",expression:"sum"}},{fieldName:"MiNapQty",type:"data",width:60,numberFormat:"#,##0.##",editable:!1,styleName:"right-column ",header:{text:"\uBBF8\uB0A9\uB7C9"},footer:{numberFormat:"#,##0.##",expression:"sum"}},{fieldName:"ErrorQty",type:"data",width:60,numberFormat:"#,##0.##",editable:!1,styleName:"right-column ",header:{text:"\uBD88\uB7C9\uC218\uB7C9"},footer:{numberFormat:"#,##0.##",expression:"sum"}},{fieldName:"Price",type:"data",width:60,numberFormat:"#,##0",editable:!1,styleName:"right-column ",header:{text:"\uBC1C\uC8FC\uB2E8\uAC00"},footer:{numberFormat:"#,##0",expression:"sum"}},{fieldName:"Amount",type:"data",width:80,editable:!1,numberFormat:"#,##0",styleName:"right-column ",header:{text:"\uB0A9\uD488\uAE08\uC561"},renderer:{type:"text",showTooltip:!0},footer:{numberFormat:"#,##0",expression:"sum"}},{fieldName:"Hcn",type:"data",width:50,header:{template:"<span style='color:#ff6000'>HCN</span>"},renderer:{type:"text",showTooltip:!0},editor:{maxLength:5,textCase:"upper"},styleName:"center-column "},{fieldName:"Remark",type:"data",width:240,header:{template:"<span style='color:#ff6000'>\uBE44\uACE0</span>"},renderer:{type:"text",showTooltip:!0},editor:{maxLength:50},styleName:"left-column "}],ze=z(t=>{const n=B.exports.useRef(null),d=async()=>{t.Util.Grid.fContainerInit(t.Util.Common.fMakeId(t.Id)),_=new u.exports.LocalDataProvider(!1),v=new u.exports.GridView(n.current),t.Util.Grid.fInitGridHeader(v,_,t.GridFields,t.GridColumns,30,r,o,h,t.GridTitle),v.setRowIndicator({visible:!1}),v.displayOptions.rowHeight=25,v.setRowStyleCallback((D,m)=>{if(D.getValue(m.index,"isSelected")==="Y")return"rg-column-color-2";if(D.getValue(m.index,"Clstype")==="\uC644\uB8CC"||D.getValue(m.index,"Clstype")==="\uBCF4\uB958")return"rg-column-color-3"}),v.onCellDblClicked=function(D,m){const C=_.getJsonRow(m.dataRow);t.DoubleClicked(C,m.dataRow)},t.DataProviderBind(_),t.GridViewBind(v)},r=async(D,m,C)=>{C>=0&&t.RowChanged(D,C)},o=(D,m)=>{t.currentIndex.current===m.dataRow&&m.dataRow>=0&&t.RowChanged(D,m.dataRow)},h=async(D,m)=>{const C=v.getCurrent(),p=_.getJsonRow(C.dataRow);switch(m.key){case"Enter":t.DoubleClicked(p,C.dataRow);break;case"Tab":t.TabKey();break}};return B.exports.useEffect(()=>{d()},[]),e.createElement(e.Fragment,null,e.createElement(l,{ref:n,key:t.Util.Common.fMakeId(t.id),id:t.Util.Common.fMakeId(t.Id),style:{width:"100%",height:t.Height}}))});let _,v;const Oe=(t,n)=>{t({SchAccunit:"",SchFactory:"",SchCustCd:n.user.custcd,SchCustNm:n.user.custnm,SchBalNo:"",SchDateType:"1",SchGoodNo:"",SchStatus:"4",SchFrDate:T().subtract(1,"month"),SchToDate:new Date,SchNapDate:new Date})},O=async(t,n,d,r)=>{if(t.Util.Common.fValidate(!T(n.SchFrDate,"YYYY-MM-DD").isValid()||!T(n.SchToDate,"YYYY-MM-DD").isValid(),"\uBC1C\uC8FC\uAE30\uAC04\uC744 \uBC14\uB974\uAC8C \uC785\uB825\uD574 \uC8FC\uC138\uC694.")||t.Util.Common.fValidate(T(n.SchFrDate).format("YYYYMMDD")>T(n.SchToDate).format("YYYYMMDD"),"\uC870\uD68C\uAE30\uAC04\uC744 \uD655\uC778\uD574 \uC8FC\uC138\uC694."))return;const o={...n};o.SchFrDate=T(o.SchFrDate).format("YYYYMMDD"),o.SchToDate=T(o.SchToDate).format("YYYYMMDD"),o.SchAccunit=t.User.user.accunit,o.SchFactory=t.User.user.factory,await t.Util.Command.fSearch(d,"/@api/supply/supplyItem/selectByList",o,r)},$=async(t,n,d,r,o)=>{if(!(r.current==="NEW"||r.current===""||r.current.includes("\uC0AD"))&&!t.Util.Common.fValidate(!T(o,"YYYY-MM-DD").isValid(),"\uB0A9\uD488\uC77C\uC790\uB97C \uD655\uC778\uD574 \uC8FC\uC138\uC694."))try{const h=await U.get("@api/supply/supplyItem/selectBySupplyList",{params:{SupplyDate:T(o).format("YYYYMMDD"),CustCd:n.SchCustCd,SupNo:r.current}});d.setRows(h.data)}catch{t.setAlert({visible:!0,desc:"\uB0A9\uD488 \uC0C1\uC138 \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."})}},j=async(t,n,d,r)=>{if(!t.Util.Common.fValidate(!T(n.SchNapDate,"YYYY-MM-DD").isValid(),"\uB0A9\uD488\uC77C\uC790\uB97C \uBC14\uB974\uAC8C \uC785\uB825\uD574 \uC8FC\uC138\uC694.")){d([]);try{const o=await U.get("@api/supply/supplyItem/selectBySupNoList",{params:{supplyDate:T(r).format("YYYYMMDD"),custCd:n.SchCustCd}}),h=o.data;let D=[],m=[];return h.map((C,p)=>{(p==0||!m.includes(C.value.substr(0,12)))&&D.push(C),m.push(C.value.substr(0,12))}),D.unshift({value:"NEW",text:"\uC2E0\uADDC"}),d(D),o.data}catch{t.setAlert({visible:!0,desc:"\uB0A9\uD488\uBC88\uD638 \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."})}}},$e=async(t,n,d)=>{let r="";d&&(r=T(d).format("YYYYMMDD"));try{return(await U.get("@api/supply/supplyItem/countIncomplateSupplyList",{params:{custCd:n.SchCustCd,supplyDate:r}})).data}catch{t.setAlert({visible:!0,desc:"\uB0A9\uD488\uBAA9\uB85D \uC870\uD68C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."})}},je=async(t,n,d,r,o,h,D,m,C)=>{r.commit();const p={...n};p.SchAccunit=t.User.user.accunit,p.SchFactory=t.User.user.factory,p.SupNo=o.current,p.SupplyDate=T(h).format("YYYYMMDD");let c=[];t.Util.Grid.fCheckGridData(d,c,"","");let N=0;if(c.forEach(i=>{(i.MiNapSu<0&&i.UnitNm==="M"||i.MiNapQty<0&&i.UnitNm!=="M")&&(N+=1)}),N>0){t.setAlert({visible:!0,desc:"\uBBF8\uB0A9\uB7C9\uC744 \uD655\uC778\uD558\uC138\uC694."});return}c.forEach(i=>{for(const[s,V]of Object.entries(i))typeof i[s]=="string"&&(i[s]=V.trim())});try{const s=(await U.post("/@api/supply/supplyItem/updateByList",{header:p,detail:c})).data;return s.errmess!==""?(t.setAlert({visible:!0,desc:s.errmess,type:"E"}),o.current):(t.setAlert({visible:!0,desc:"\uBB38\uC11C \uC800\uC7A5\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4. "}),o.current=s.SupNo,setTimeout(async()=>{await O(t,n,C,""),await $(t,n,d,o,h),await j(t,n,D,h),m({value:s.SupNo,text:s.SupNo})},100),s.SupNo)}catch(i){t.setAlert({visible:!0,desc:`\uC800\uC7A5 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${i}`})}},Ze=async(t,n,d,r,o,h,D,m,C)=>{const p={...n};p.Accunit=t.User.user.accunit,p.Factory=t.User.user.factory,p.SupNo=o.current,p.supplyDate=T(h).format("YYYYMMDD");let c=[];r.getCheckedItems(!0).forEach(i=>{const s=d.getJsonRow(i);c.push(s)});try{const s=(await U.post("/@api/supply/supplyItem/deleteByItem",{data:p,item:c})).data;return s.errmess!==""?(t.setAlert({visible:!0,desc:s.errmess,type:"E"}),o.current):(t.setAlert({visible:!0,desc:"\uB0A9\uD488\uC11C \uB0B4\uC5ED\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),o.current=s.SupNo,setTimeout(async()=>{await O(t,n,C,""),await $(t,n,d,o,h),await j(t,n,D,h,m,o),d.getJsonRows().length<1&&m({value:"NEW",text:"\uC2E0\uADDC"})},100),s.SupNo)}catch{t.setAlert({visible:!0,desc:"\uB0A9\uD488\uC11C \uB0B4\uC5ED \uC0AD\uC81C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."})}},et=async(t,n,d,r)=>{try{const o=await U.get("@api/purchase/purchaseStorage/searchConvertValue",{params:{SchGoodcd:r,SchConvertUnit:d,SchConvertValue:n}});if(!o.data)return;if(o.data.returnValue!==0)return o.data.returnValue}catch{t.setAlert({visible:!0,desc:"\uB2E8\uC704 \uD658\uC0B0 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."})}},tt=async(t,n,d,r)=>{try{const o=await U.get("@api/supply/supplyItem/selectByPrint",{params:{CustCd:n.SchCustCd,SupNo:r.current,SchAccunit:t.User.user.accunit,SchFactory:t.User.user.factory}});if(!o.data)t.setAlert({visible:!0,desc:"\uCD9C\uB825\uC790\uB8CC \uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."});else{d(!0);const h='{ "data": '+JSON.stringify(o.data)+" }";t.Util.Report.fReport(h,"/\uC8FC\uBB38\uBC1C\uC8FC\uCC98\uB9AC_\uAC70\uB798\uBA85\uC138\uC11C.mrd","http://report.ehansun.co.kr/ReportingServer","http://hseerp.ehansun.co.kr/report")}}catch{t.setAlert({visible:!0,desc:"\uCD9C\uB825\uC790\uB8CC \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."})}};function ce(){const{$UserStore:t}=de(),[n,d]=B.exports.useState({SchAccunit:"",SchFactory:"",SchCustCd:t.user.custcd,SchCustNm:t.user.custnm,SchGoodNo:"",SchStatus:"0",SchBalNo:"",SchDateType:"1",SchFrDate:T().subtract(1,"month"),SchToDate:new Date,SchNapDate:new Date}),[r,o]=B.exports.useState(""),[h,D]=B.exports.useState("\uBC1C\uC8FC\uC77C\uC790"),[m,C]=B.exports.useState(""),[p,c]=B.exports.useState(""),[N,i]=B.exports.useState(new Date),[s,V]=B.exports.useState([]),[F,x]=B.exports.useState(!1),[P,X]=B.exports.useState({visible:!1,desc:"",type:"N"}),[Y,W]=B.exports.useState({visible:!1,desc:"",id:""}),[G]=B.exports.useState([{value:"0",text:"\uC791\uC131"},{value:"1",text:"\uC9C4\uD589"},{value:"2",text:"\uBCF4\uB958"},{value:"3",text:"\uC644\uB8CC"},{value:"4",text:"\uBAA8\uB450"}]);return{searchVO:n,setSearchVO:d,gridFocus:r,setGridFocus:o,cboSchType:G,alert:P,setAlert:X,confirm:Y,setConfirm:W,supplyDate:N,setSupplyDate:i,supNoList:m,setSupNoList:C,supNo:p,setSupNo:c,dateLabel:h,setDateLabel:D,incompleteSupply:s,setIncompleteSupply:V,printView:F,setPrintView:x}}const at=z(t=>{const{setAlert:n}=ce(),d=B.exports.useRef(null),[r]=B.exports.useState({setAlert:n}),o=async()=>{t.Util.Grid.fContainerInit(t.Util.Common.fMakeId(t.Id)),E=new u.exports.LocalDataProvider(!1),R=new u.exports.GridView(d.current),t.Util.Grid.fInitGridDetail(R,E,t.GridFields,t.GridColumns,D,m,p),R.setRowIndicator({visible:!1}),R.setFooters({visible:!0}),R.setDisplayOptions({fitStyle:"fill",rowHeight:25}),R.setCheckBar({visible:!0}),R.setRowStyleCallback((c,N)=>{if(c.getValue(N.index,"DelvGuid")!==""&&c.getValue(N.index,"DelvGuid")!==void 0)return"rg-column-color-1"}),t.DataProviderBind(E),t.GridViewBind(R),R.onShowEditor=function(c,N){if(N.column==="RealWeight"&&E.getValue(N.dataRow,"UnitNm")!=="M")return!1},R.onCellDblClicked=function(){h()},R.setCheckableExpression("values['DelvGuid'] = ''",!0)},h=()=>{const{dataRow:c}=R.getCurrent();if(c===-1)return;const N=E.getJsonRow(c);if(t.DoubleClicked(N,c),E.getRowState(c)==="created"){E.removeRow(c);const i=E.getJsonRows();for(let s=1;s<i.length+1;s++)E.setValue(s-1,"No",s.toString().padStart(3,"0"))}},D=async()=>{},m=async c=>{c.commit();const{column:N,dataRow:i}=c.getCurrent(),s=c.getValue(i,N),V=E.getValue(i,"Price");if(s&&N==="NapQty")if(E.getValue(i,"UnitNm")==="M"){const F=E.getValue(i,"GoodCd"),x=await et(r,s,"Kg",F);E.setValue(i,"Qty",x),E.setValue(i,"Su",s),E.setValue(i,"Amount",Math.round(V*x));const P=await C(i,s,x);E.setValue(i,"MiNapQty",P[0].CurrentMiSu)}else{E.setValue(i,"Amount",Math.round(s*V)),E.setValue(i,"Qty",s),E.setValue(i,"Su",0);const F=await C(i,0,s);E.setValue(i,"MiNapQty",F[0].CurrentMiQty)}},C=async(c,N,i)=>{const s=E.getValue(c,"BalNo"),V=E.getValue(c,"BalSeq"),F=E.getValue(c,"SupNo");try{return(await U.get("@api/supply/supplyItem/calculateMiNap",{params:{CustCd:t.CustCd,BalNo:s,BalSeq:V,SupNo:F,SuValue:N,QtyValue:i}})).data}catch{t.Util.setAlert({visible:!0,desc:"\uBBF8\uB0A9\uB7C9 \uACC4\uC0B0 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}},p=async(c,N)=>{switch(N.key){case"Escape":h();break;case"Tab":N.preventDefault(),t.TabKey();break}};return B.exports.useEffect(()=>{o()},[]),e.createElement(e.Fragment,null,e.createElement(l,{ref:d,key:t.Util.Common.fMakeId(t.Id),id:t.Util.Common.fMakeId(t.Id),style:{width:"99.99999%",height:336}}))});let E,R;const Ct=z(()=>{const t="SUPPLYITEM",{$CommonStore:n,$UserStore:d}=de(),r=ut(),o=Me(),[h]=B.exports.useState(d.fCheckAuth(`${t}|SUPPLYSAVE`)),[D]=B.exports.useState(d.fCheckAuth(`${t}|SUPPLYDELETE`)),[m]=B.exports.useState(d.fCheckAuth(`${t}|SUPPLYPRINT`)),{searchVO:C,setSearchVO:p,setGridFocus:c,cboSchType:N,alert:i,setAlert:s,confirm:V,setConfirm:F,supplyDate:x,setSupplyDate:P,supNoList:X,setSupNoList:Y,supNo:W,setSupNo:G,dateLabel:me,setDateLabel:Z,printView:pe,setPrintView:ee}=ce(),f=new ve(t,s,!0,!0,!0,!0,!0),H=B.exports.useRef(0),b=B.exports.useRef(""),te=()=>{Oe(p,d),setTimeout(()=>{f.Common.fSetTabIndex(),document.getElementById(f.Common.fMakeId("SchFrDate")).focus()},100)},[k]=B.exports.useState({Util:f,User:d,fInit:te,setAlert:s}),ye=a=>{K=a},fe=a=>{g=a},Be=a=>{I=a},he=a=>{S=a},De=()=>{I.setFocus()},Ne=()=>{K.setFocus()},Ee=(a,y)=>{I.commit(!0),c("H"),H.current=y},ae=async(a,y)=>{if(b.current.includes("\uC644\uB8CC")){s({visible:!0,desc:"\uB0A9\uD488\uBC88\uD638 : "+b.current.substring(0,12)+` 
\uAD6C\uB9E4\uC785\uACE0 \uC644\uB8CC \uB41C \uB0A9\uD488\uBC88\uD638\uB294 \uCD94\uAC00 \uC800\uC7A5\uC774 \uBD88\uAC00\uD569\uB2C8\uB2E4. `,type:"W"});return}if(b.current.includes("\uC0AD\uC81C")){s({visible:!0,desc:"\uB0A9\uD488\uBC88\uD638 : "+b.current.substring(0,12)+` 
\uC0AD\uC81C\uB41C \uB0A9\uD488\uBC88\uD638\uC5D0\uB294 \uC800\uC7A5\uC774 \uBD88\uAC00\uD569\uB2C8\uB2E4. `,type:"W"});return}if(g.getValue(y,"isSelected")!=="Y"&&g.getValue(y,"Clstype")!=="\uC644\uB8CC"){const A=a.BalNo,M=a.BalSeq;if(!S.getJsonRows().some(L=>L.BalNo===A&&L.BalSeq===M)){const L={BalNo:a.BalNo,BalSeq:a.BalSeq,GoodCd:a.GoodCd,GoodNo:a.GoodNo,GoodNm:a.GoodNm,Spec:a.Spec,UnitCd:a.UnitCd,BalQty:a.BalQty,UnitNm:a.UnitNm,NapQty:a.MiNapQty,Qty:a.UnitNm==="M"?a.MiWeight:a.MiNapQty,Su:a.UnitNm==="M"?a.MiNapQty:0,MiNapQty:0,Price:a.Price,Clstype:a.Clstype,BalAmount:a.Amount,Amount:a.UnitNm==="M"?Math.round(a.MiWeight*a.Price):Math.round(a.MiNapQty*a.Price),Remark:a.Remark};S.addRow(L);const Re=S.getJsonRows();for(let Q=1;Q<Re.length+1;Q++)S.setValue(Q-1,"No",Q.toString().padStart(3,"0"));g.setValue(y,"isSelected","Y")}}},Te=async()=>{const y=g.getJsonRow(H.current).BalNo;g.getJsonRows().forEach((A,M)=>{A.BalNo===y&&ae(g.getJsonRow(M),M)})},ge=(a,y)=>{const A=S.getValue(y,"BalNo"),M=S.getValue(y,"BalSeq");g.getJsonRows().forEach((J,L)=>{J.BalNo===A&&J.BalSeq===M&&g.setValue(L,"isSelected","N")})},Se=()=>(S.getAllStateRows().created.length>0,0),xe=()=>{f.Grid.fTab(I,Se()===0,"No")},ue=(a,y)=>{y&&(p({...C,SchDateType:a}),a==="1"&&Z("\uBC1C\uC8FC\uC77C\uC790"),a==="2"&&Z("\uB0A9\uAE30\uC77C\uC790"))},Ae=()=>e.createElement("div",{style:{width:400,fontSize:13}},e.createElement("span",null,"\u2299\uBC1C\uC8FC \uC624\uB354\uC758 \uD56D\uBAA9\uC744 \uC120\uD0DD\uD558\uACE0 \uC2F6\uB2E4\uBA74 \uC704 \uADF8\uB9AC\uB4DC\uC758 \uD574\uB2F9 \uD56D\uBAA9\uC744 \uB354\uBE14\uD074\uB9AD\uD558\uAC70\uB098 \uD0A4\uBCF4\uB4DC\uC758 Enter \uD0A4\uB97C \uB204\uB985\uB2C8\uB2E4."),e.createElement("p",null,"\u2299\uC544\uB798 \uADF8\uB9AC\uB4DC\uC758 \uC120\uD0DD\uD55C \uD56D\uBAA9\uC744 \uCDE8\uC18C\uD558\uACE0 \uC2F6\uB2E4\uBA74 \uD574\uB2F9 \uD56D\uBAA9\uC744 \uB354\uBE14\uD074\uB9AD\uD558\uAC70\uB098 \uD0A4\uBCF4\uB4DC\uC758 Esc \uD0A4\uB97C \uB204\uB985\uB2C8\uB2E4."),e.createElement("span",null,"\u2299[\uBC1C\uC8FC\uBC88\uD638+]\uBC84\uD2BC\uC740 \uC704 \uADF8\uB9AC\uB4DC\uC758 \uC120\uD0DD\uD55C \uBC1C\uC8FC\uBC88\uD638\uC640 \uAC19\uC740 \uBC1C\uC8FC\uB97C \uD55C \uBC88\uC5D0 \uC120\uD0DD\uD569\uB2C8\uB2E4. "));window.onkeydown=function(a){o.pathname==="/supplyitem"&&(a.key==="F8"?(a.preventDefault(),oe()):a.key==="F10"?(a.preventDefault(),ne()):a.key==="F11"?(a.preventDefault(),ie()):a.key==="F12"&&(a.preventDefault(),Ce()))};const le=()=>{},re=async()=>{await O(k,C,g,"\uBC1C\uC8FC \uBAA9\uB85D"),K.setFocus()},se=async()=>{const a=await j(k,C,Y,x);for(let y=0;y<a.length;y++)if(a[y].value.length===12){G({value:a[y].value,text:a[y].value});return}},we=async()=>{const a=await $e(k,C,"");a.length>0?P(T(a[0].SupNo.substring(0,8),"YYYY-MM-DD").toDate()):se()},oe=async()=>{S.clearRows(),b.current="",G({value:"NEW",text:"\uC2E0\uADDC"}),g.getJsonRows().forEach((a,y)=>{g.setValue(y,"isSelected","N")})},ne=()=>{if(I.commit(),S.getJsonRows().length<=0)return;let a=0;if(S.getJsonRows().forEach((A,M)=>{S.getRowState(M)==="none"&&(a+=1)}),a===S.getJsonRows().length){s({visible:!0,desc:"\uBAA9\uB85D\uC911\uC5D0 \uC785\uB825/\uBCC0\uACBD \uD55C \uB0B4\uC5ED\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"});return}if(b.current&&b.current.includes("\uC0AD\uC81C")){s({visible:!0,desc:"\uB0A9\uD488\uBC88\uD638\uB97C \uD655\uC778\uD558\uC138\uC694",type:"W"});return}const y=S.getJsonRows();if(y.some(A=>A.NapQty<=0)){s({visible:!0,desc:"\uB0A9\uD488\uB7C9\uC744 \uD655\uC778\uD558\uC138\uC694.",type:"W"});return}if(y.some(A=>A.Su<=0&&A.UnitNm==="M")){s({visible:!0,desc:"\uB0A9\uD488\uAE38\uC774\uB97C \uD655\uC778\uD558\uC138\uC694.",type:"W"});return}if(y.some(A=>A.MiNapQty<0)){s({visible:!0,desc:"\uBBF8\uB0A9\uB7C9\uC744 \uD655\uC778\uD558\uC138\uC694.",type:"W"});return}F({visible:!0,desc:T(x).format("YYYY-MM-DD")+" \uB0A0\uC9DC\uC5D0 \uB0A9\uD488\uC790\uB8CC\uB97C \uC800\uC7A5 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",id:"SAVE"})},be=async()=>{I.commit(),S.clearRows(),await $(k,C,S,b,x)},ie=async()=>{I.commit(!0),!f.Common.fValidate(I.getCheckedItems(!0).length<1,"\uC0AD\uC81C\uD560 \uB0A9\uD488 \uB0B4\uC5ED\uC744 \uC120\uD0DD\uD558\uC138\uC694.")&&F({visible:!0,desc:`${T(x).format("YYYY-MM-DD")}\uB0A0\uC9DC\uC758 \uB0A9\uD488 \uB0B4\uC5ED\uC744 \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`,id:"DELETE_ITEM"})},Ce=async()=>{await tt(k,C,ee,b)},Ve=async()=>{if(F({visible:!1,desc:"",id:""}),V.id==="SAVE"){const a=await je(k,C,S,I,b,x,Y,G,g);b.current=a}else if(V.id==="DELETE_ITEM"){const a=await Ze(k,C,S,I,b,x,Y,G,g);b.current=a}},Fe=()=>{F({visible:!1,desc:"",id:""})};return B.exports.useEffect(()=>{C.SchCustCd&&T(x).isValid()&&setTimeout(()=>{se()},1)},[x]),B.exports.useEffect(()=>{f.Common.fHotKey(n,n.isPopup,le,re)},[n.HotKey]),B.exports.useEffect(()=>(te(),we(),()=>{n.fSetHotKey()}),[]),e.createElement(e.Fragment,null,e.createElement(Xe,{pgmid:t,visible:"01000",onNew:le,onSearch:re}),e.createElement(Ue,{className:"mainCon"},e.createElement(l,{display:"flex",flexDirection:"column",alignItems:"flex-start",style:{padding:1,border:"1px solid #e2e2e2",borderRadius:5,backgroundColor:"#f9f9f9"}},e.createElement(l,{style:{display:"flex",alignItems:"center "}},e.createElement(l,{style:{marginTop:2,marginLeft:5,display:"flex",alignItems:"center"}},e.createElement(l,{className:r.SC4},e.createElement(l,{className:r.SC1},"\uC870\uD68C\uC870\uAC74")),e.createElement(l,{id:f.Common.fMakeId("radioBox"),className:"inputCls",style:{height:27,display:"flex",flexDirection:"row",border:"1px solid #9ac9ed",borderRadius:5,alignItems:"center",justifyContent:"center"}},e.createElement(w.exports.RadioButton,{className:r.Radio,inputId:f.Common.fMakeId("bal"),inputCls:"inputCls",value:"1",groupValue:C.SchDateType,onChange:a=>ue("1",a),style:{marginLeft:5}}),e.createElement(w.exports.Label,{htmlFor:f.Common.fMakeId("bal"),className:r.RadioLabel,style:{width:100}},"\uBC1C\uC8FC\uC77C\uC790"),e.createElement(l,null,e.createElement(w.exports.RadioButton,{inputCls:"inputCls",inputId:f.Common.fMakeId("nap"),value:"2",groupValue:C.SchDateType,onChange:a=>ue("2",a),className:r.Radio}),e.createElement(w.exports.Label,{htmlFor:f.Common.fMakeId("nap"),className:r.RadioLabel,style:{width:100}},"\uB0A9\uAE30\uC77C\uC790")))),e.createElement(l,{className:r.SC4},e.createElement(l,{className:r.SC1},me),e.createElement(q,{inputCls:"inputCls",selected:C.SchFrDate,inputId:f.Common.fMakeId("SchFrDate"),onHandleDateChange:a=>f.Common.fFieldChange(p,"SchFrDate",a)}),e.createElement(l,{style:{margin:"0 3px",width:"10px"}},"~"),e.createElement(q,{inputCls:"inputCls",selected:C.SchToDate,inputId:f.Common.fMakeId("SchToDate"),onHandleDateChange:a=>f.Common.fFieldChange(p,"SchToDate",a)})),e.createElement(l,{className:r.SC4},e.createElement(l,{className:r.SC1},"\uBC1C\uC8FC\uBC88\uD638"),e.createElement(w.exports.TextBox,{inputId:f.Common.fMakeId("BalNo"),inputCls:"inputCls",className:r.SC3,onChange:a=>{f.Common.fFieldChange(p,"SchBalNo",a.toUpperCase())},value:C.SchBalNo})),e.createElement(l,{className:r.SC4},e.createElement(l,{className:r.SC1},"\uD488\uBC88\uAC80\uC0C9"),e.createElement(w.exports.TextBox,{inputId:f.Common.fMakeId("GoodNo"),inputCls:"inputCls",className:r.SC3,onChange:a=>{f.Common.fFieldChange(p,"SchGoodNo",a.toUpperCase())},value:C.SchGoodNo})),e.createElement(l,{className:r.SC4},e.createElement(l,{className:r.SC1},"\uB0A9\uD488\uC0C1\uD0DC"),e.createElement(w.exports.ComboBox,{inputCls:"inputCls",inputId:f.Common.fMakeId("SchType"),data:N,value:C.SchStatus,onChange:a=>f.Common.fFieldChange(p,"SchStatus",a),className:r.SA4,panelStyle:{height:160}})))),e.createElement(l,{style:{marginTop:5}},e.createElement(ze,{Util:f,id:"Grid1",Height:355,currentIndex:H,GridFields:He,GridColumns:Je,RowChanged:Ee,DoubleClicked:ae,DataProviderBind:fe,GridViewBind:ye,TabKey:De})),e.createElement(l,{display:"flex",flexDirection:"column",alignItems:"flex-start",style:{marginTop:5,marginBottom:5}},e.createElement(l,{display:"flex",flexDirection:"row"},e.createElement(l,{style:{marginRight:12}},e.createElement(w.exports.LinkButton,{style:{width:100,height:30,color:"#424242",borderRadius:3},onClick:Te},e.createElement(l,{style:{width:100,height:30,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(l,{style:{marginLeft:5,fontSize:15,paddingBottom:2,fontWeight:500}},"\uBC1C\uC8FC\uBC88\uD638 +")))),e.createElement(l,{style:{marginRight:12}},e.createElement(w.exports.LinkButton,{style:{width:100,height:30,color:"#424242",borderRadius:3},onClick:oe},e.createElement(l,{style:{width:100,height:30,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(We,{size:16}),e.createElement(l,{style:{marginLeft:5,fontSize:15,paddingBottom:2,fontWeight:500}},"\uC2E0\uADDC"),e.createElement(l,{style:{fontSize:"x-small"}},"F8")))),e.createElement(l,{style:{marginRight:12}},e.createElement(w.exports.LinkButton,{className:"c4",style:{width:100,height:30,color:"#424242",borderRadius:3},onClick:ne,disabled:!h},e.createElement(l,{style:{width:100,height:30,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(Ge,{size:16}),e.createElement(l,{style:{marginLeft:5,fontSize:15,paddingBottom:2,fontWeight:500}},"\uC800\uC7A5"),e.createElement(l,{style:{fontSize:"x-small"}},"F10")))),e.createElement(l,{style:{marginRight:12}},e.createElement(w.exports.LinkButton,{className:"c11",style:{width:100,height:30,color:"#424242",borderRadius:3},onClick:ie,disabled:!D},e.createElement(l,{style:{width:100,height:30,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(ke,{size:16}),e.createElement(l,{style:{marginLeft:5,fontSize:15,paddingBottom:2,fontWeight:500}},"\uC0AD\uC81C"),e.createElement(l,{style:{fontSize:"x-small"}},"F11")))),e.createElement(l,{style:{marginRight:12}},e.createElement(w.exports.LinkButton,{className:"c12",style:{width:100,height:30,color:"#424242",borderRadius:3},onClick:Ce,disabled:!m},e.createElement(l,{style:{width:100,height:30,display:"flex",alignItems:"center",justifyContent:"center"}},e.createElement(Pe,{size:16}),e.createElement(l,{style:{marginLeft:5,fontSize:15,paddingBottom:2,fontWeight:500}},"\uCD9C\uB825"),e.createElement(l,{style:{fontSize:"x-small"}},"F12")))),e.createElement(l,{style:{display:"flex",alignItems:"center"}},e.createElement(l,{className:r.SC4},e.createElement(l,{className:r.SC1},"\uB0A9\uD488\uC77C\uC790")),e.createElement(l,{style:{display:"flex",alignItems:"center"}},e.createElement(q,{inputCls:"inputCls",selected:x,inputId:f.Common.fMakeId("supplyDate"),onHandleDateChange:a=>{Y([]),P(a),G({value:"NEW",text:"\uC2E0\uADDC"}),g.getJsonRows().forEach((y,A)=>{g.setValue(A,"isSelected","N")})}})),e.createElement(l,{className:r.SC4},e.createElement(l,{className:r.SC1},"\uB0A9\uD488\uBC88\uD638")),e.createElement(l,{style:{display:"flex",alignItems:"center"}},e.createElement(w.exports.ComboBox,{inputCls:"inputCls",inputId:f.Common.fMakeId("SupNo"),data:X,value:W,onChange:a=>{b.current=a,be(),g.getJsonRows().forEach((y,A)=>{g.setValue(A,"isSelected","N")})},className:r.SA4,panelStyle:{height:130},style:{width:180}}))),e.createElement(l,{style:{marginLeft:20,width:30,height:30,color:"#424242",borderRadius:3}},e.createElement(w.exports.Tooltip,{position:"right",content:Ae},e.createElement(w.exports.LinkButton,{style:{width:30,height:30,color:"#424242",borderRadius:3,fontWeight:500}},"?"))))),e.createElement(l,{style:{marginTop:5}},e.createElement(at,{Util:f,Id:"Grid2",GridFields:qe,GridColumns:Ke,setGridFocus:c,setAlert:s,TabGrid:xe,DoubleClicked:ge,DataProviderBind:he,GridViewBind:Be,CustCd:C.SchCustCd,TabKey:Ne}))),e.createElement(Ye,{visible:V.visible,description:V.desc,onCancel:Fe,onConfirm:Ve}),e.createElement(Le,{visible:i.visible,description:i.desc,type:i.type,onConfirm:()=>s({visible:!1})}),pe&&e.createElement(w.exports.Dialog,{title:e.createElement(l,{style:{display:"flex"}},e.createElement("img",{src:_e,alt:"logo",style:{width:"50px"}}),e.createElement(l,{style:{marginLeft:15}},"\uAC70\uB798\uBA85\uC138\uC11C \uCD9C\uB825")),style:{width:"1870px",height:"900px"},bodyCls:"f-column",closable:!0,draggable:!0,modal:!0,onClose:()=>ee(!1)},e.createElement(l,{className:"f-full"},e.createElement("div",{id:"crownix-viewer",style:{position:"absolute",width:"100%",height:"100%"}}))))});let K,I,g,S;const ut=Ie(Qe);export{Ct as default};
