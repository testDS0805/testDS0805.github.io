import{r as g,R as o}from"./index.da6908f5.js";import{m as l,u as ce,h as N,d as se,o as me,f as Se,B as c,n as Ve,c as ke,U as Re,P as xe,r as V,F as De,q as Ie,A as ve,C as Ue}from"./App.11263b70.js";import{C as be}from"./CommonButton.0b792d77.js";import{A as Pe}from"./Approval.69c4f070.js";import{A as Me}from"./Attachments.19d97d2b.js";import{C as Te}from"./CodeHelperPopup.3932fdb9.js";import{C as ue}from"./CommonDatePicker.d7bc57f8.js";import"./EvidenceViewer.5aab9677.js";import"./index.6f186c21.js";const Fe=[{fieldName:"Accunit",dataType:l.exports.ValueType.TEXT},{fieldName:"Factory",dataType:l.exports.ValueType.TEXT},{fieldName:"ExpExpenseno",dataType:l.exports.ValueType.TEXT},{fieldName:"ExpExpenseDate",dataType:l.exports.ValueType.DATE,datetimeFormat:"yyyyMMdd"},{fieldName:"GeneDate",dataType:l.exports.ValueType.DATE,datetimeFormat:"yyyyMMdd"},{fieldName:"Slpdat",dataType:l.exports.ValueType.TEXT},{fieldName:"Slipyn",dataType:l.exports.ValueType.TEXT},{fieldName:"LCNO",dataType:l.exports.ValueType.TEXT},{fieldName:"CINO",dataType:l.exports.ValueType.TEXT},{fieldName:"Custcd",dataType:l.exports.ValueType.TEXT},{fieldName:"Custnm",dataType:l.exports.ValueType.TEXT},{fieldName:"Mediator",dataType:l.exports.ValueType.TEXT},{fieldName:"Mediatornm",dataType:l.exports.ValueType.TEXT},{fieldName:"Pno",dataType:l.exports.ValueType.TEXT},{fieldName:"Pnonm",dataType:l.exports.ValueType.TEXT},{fieldName:"Deptcd",dataType:l.exports.ValueType.TEXT},{fieldName:"Deptnm",dataType:l.exports.ValueType.TEXT},{fieldName:"CrePno",dataType:l.exports.ValueType.TEXT},{fieldName:"CreDate",dataType:l.exports.ValueType.TEXT},{fieldName:"ModPno",dataType:l.exports.ValueType.TEXT},{fieldName:"ModDate",dataType:l.exports.ValueType.TEXT},{fieldName:"Amand",dataType:l.exports.ValueType.TEXT},{fieldName:"Shipdeg",dataType:l.exports.ValueType.TEXT},{fieldName:"RemarkM",dataType:l.exports.ValueType.TEXT},{fieldName:"CustList",dataType:l.exports.ValueType.TEXT},{fieldName:"ApprDocProg",dataType:l.exports.ValueType.TEXT},{fieldName:"DocStatus",dataType:l.exports.ValueType.TEXT}],Ge=[{name:"ApprDocProg",fieldName:"ApprDocProg",width:70,styleName:"center-column",header:{text:"\uACB0\uC7AC\uC0C1\uD0DC",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"ExpExpenseDate",fieldName:"ExpExpenseDate",width:85,styleName:"center-column",header:{text:"\uC791\uC131\uC77C",showTooltip:!0},renderer:{type:"text",showTooltip:!0},datetimeFormat:"yyyy-MM-dd"},{name:"ExpExpenseno",fieldName:"ExpExpenseno",width:90,styleName:"center-column",header:{text:"\uC791\uC131\uBC88\uD638",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"CustList",fieldName:"CustList",width:145,styleName:"left-column",header:{text:"\uAC70\uB798\uCC98",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Deptnm",fieldName:"Deptnm",width:70,styleName:"left-column",header:{text:"\uBD80\uC11C\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Slipyn",fieldName:"Slipyn",width:75,styleName:"center-column",header:{text:"\uD68C\uACC4\uCC98\uB9AC",showTooltip:!0},renderer:{type:"text",showTooltip:!0}}],Ye=[{fieldName:"Accunit",dataType:l.exports.ValueType.TEXT},{fieldName:"ExpExpenseno",dataType:l.exports.ValueType.TEXT},{fieldName:"ExpExpenseseq",dataType:l.exports.ValueType.TEXT},{fieldName:"No",dataType:l.exports.ValueType.TEXT},{fieldName:"Jukyocd",dataType:l.exports.ValueType.TEXT},{fieldName:"ToFactory",dataType:l.exports.ValueType.TEXT},{fieldName:"Currcd",dataType:l.exports.ValueType.TEXT},{fieldName:"ExchangeDate",dataType:l.exports.ValueType.TEXT},{fieldName:"Exchange",dataType:l.exports.ValueType.NUMBER},{fieldName:"CostAmt",dataType:l.exports.ValueType.NUMBER},{fieldName:"KorCostAmt",dataType:l.exports.ValueType.NUMBER},{fieldName:"Cardno",dataType:l.exports.ValueType.TEXT},{fieldName:"Deptcd",dataType:l.exports.ValueType.TEXT},{fieldName:"Custcd",dataType:l.exports.ValueType.TEXT},{fieldName:"Bankcd",dataType:l.exports.ValueType.TEXT},{fieldName:"Goodcd",dataType:l.exports.ValueType.TEXT},{fieldName:"LCNO",dataType:l.exports.ValueType.TEXT},{fieldName:"Vatcd",dataType:l.exports.ValueType.TEXT},{fieldName:"Amount",dataType:l.exports.ValueType.NUMBER},{fieldName:"Tax",dataType:l.exports.ValueType.NUMBER},{fieldName:"Total",dataType:l.exports.ValueType.NUMBER},{fieldName:"Remark",dataType:l.exports.ValueType.TEXT},{fieldName:"Jukyonm",dataType:l.exports.ValueType.TEXT},{fieldName:"ToFactorynm",dataType:l.exports.ValueType.TEXT},{fieldName:"Krname",dataType:l.exports.ValueType.TEXT},{fieldName:"Deptnm",dataType:l.exports.ValueType.TEXT},{fieldName:"Custnm",dataType:l.exports.ValueType.TEXT},{fieldName:"Banknm",dataType:l.exports.ValueType.TEXT},{fieldName:"Accountno",dataType:l.exports.ValueType.TEXT},{fieldName:"Goodnm",dataType:l.exports.ValueType.TEXT},{fieldName:"Vatnm",dataType:l.exports.ValueType.TEXT},{fieldName:"Minornm",dataType:l.exports.ValueType.TEXT},{fieldName:"Account",dataType:l.exports.ValueType.TEXT},{fieldName:"Currnm",dataType:l.exports.ValueType.TEXT},{fieldName:"CINO",dataType:l.exports.ValueType.TEXT},{fieldName:"CiCustcd",dataType:l.exports.ValueType.TEXT},{fieldName:"CiCustnm",dataType:l.exports.ValueType.TEXT},{fieldName:"Protype",dataType:l.exports.ValueType.TEXT},{fieldName:"Protypenm",dataType:l.exports.ValueType.TEXT}],Le=[{name:"No",fieldName:"No",width:50,styleName:"center-column",editable:!1,header:{text:"NO",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"CiCustnm",fieldName:"CiCustnm",width:170,styleName:"left-column",button:"action",editable:!0,header:{text:"\uC218\uCD9C\uAC70\uB798\uCC98",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"CINO",fieldName:"CINO",width:100,styleName:"left-column",button:"action",editable:!0,header:{text:"CINO",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{type:"line",textCase:"upper"}},{name:"Jukyonm",fieldName:"Jukyonm",width:150,styleName:"left-column",button:"action",editable:!0,header:{text:"\uD68C\uACC4\uCC98\uB9AC\uCF54\uB4DC\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Jukyocd",fieldName:"Jukyocd",width:80,styleName:"left-column",header:{text:"\uD68C\uACC4\uCC98\uB9AC\uCF54\uB4DC",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Protypenm",fieldName:"Protypenm",width:120,styleName:"left-column",button:"action",editable:!0,header:{text:"\uC99D\uBE59\uC885\uB958",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Currnm",fieldName:"Currnm",width:60,styleName:"left-column",button:"action",editable:!0,header:{text:"\uD1B5\uD654",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{type:"line",textCase:"upper"}},{name:"ExchangeDate",fieldName:"ExchangeDate",width:80,styleName:"left-column",yearNavigation:!0,editable:!0,header:{text:"\uD658\uC728\uC77C\uC790",showTooltip:!0},renderer:{type:"text",showTooltip:!1},editor:{type:"date",maxLength:10,yearNavigation:!0,datetimeFormat:"yyyy-MM-dd"},datetimeFormat:"yyyy-MM-dd"},{name:"Exchange",fieldName:"Exchange",width:60,styleName:"right-column",editable:!1,header:{text:"\uC6D0\uD654\uD658\uC728",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{type:"number",editFormat:"#,##0.##"},numberFormat:"#,##0.##"},{name:"CostAmt",fieldName:"CostAmt",width:80,styleName:"right-column",editable:!0,header:{text:"\uD1B5\uD654\uAE08\uC561",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{type:"number",editFormat:"#,##0.##"},numberFormat:"#,##0.##"},{name:"KorCostAmt",fieldName:"KorCostAmt",width:80,styleName:"right-column",editable:!0,header:{text:"\uC6D0\uD654\uAE08\uC561",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{type:"number",editFormat:"#,##0"},numberFormat:"#,##0"},{name:"Remark",fieldName:"Remark",width:220,styleName:"left-column",placeHolder:"\uCD5C\uB30060\uC790",header:{text:"\uBE44\uACE0",showTooltip:!0},renderer:{type:"text",showTooltip:!0},editor:{maxLength:60}},{name:"Banknm",fieldName:"Banknm",width:80,styleName:"left-column",button:"action",editable:!0,header:{text:"\uC740\uD589\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Accountno",fieldName:"Accountno",width:120,styleName:"left-column",header:{text:"\uACC4\uC88C\uBC88\uD638",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Custnm",fieldName:"Custnm",width:150,styleName:"left-column",button:"action",editable:!0,header:{text:"\uAC70\uB798\uCC98",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Deptnm",fieldName:"Deptnm",width:70,styleName:"left-column",button:"action",editable:!0,header:{text:"\uBD80\uC11C",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Vatnm",fieldName:"Vatnm",width:150,styleName:"left-column",button:"action",editable:!0,header:{text:"\uBD80\uAC00\uC138\uC885\uB958",showTooltip:!0},renderer:{type:"text",showTooltip:!0}},{name:"Amount",fieldName:"Amount",width:80,styleName:"right-column",editable:!0,header:{text:"\uACF5\uAE09\uAC00\uC561",showTooltip:!0},renderer:{type:"text",showTooltip:!0},footer:{numberFormat:"#,##0",expression:"sum"},editor:{type:"number",editFormat:"#,##0"},numberFormat:"#,##0"},{name:"Tax",fieldName:"Tax",width:80,styleName:"right-column",editable:!0,header:{text:"\uBD80\uAC00\uC138",showTooltip:!0},renderer:{type:"text",showTooltip:!0},footer:{numberFormat:"#,##0",expression:"sum"},editor:{type:"number",editFormat:"#,##0"},numberFormat:"#,##0"},{name:"Total",fieldName:"Total",width:80,styleName:"right-column",editable:!0,header:{text:"\uD569\uACC4\uAE08\uC561",showTooltip:!0},renderer:{type:"text",showTooltip:!0},footer:{numberFormat:"#,##0",expression:"sum"},editor:{type:"number",editFormat:"#,##0"},numberFormat:"#,##0"}],Xe={SA1:{width:70,height:25,margin:"3px 3px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SA2:{width:60},SA3:{width:"15px!important",height:"15px!important",border:"1px solid #3c96ff",marginTop:"1px","& .checkbox-checked":{border:0,background:"#3c96ff"}},SA4:{width:90,height:25,"& input":{fontSize:"12px !important"}},SA5:{marginLeft:5,width:140,height:25,"& input":{fontSize:"12px !important"}},SB1:{width:253,height:32,"& input":{fontSize:"16px !important",textAlign:"center",color:"#0070c0"}},SB2:{fontSize:12,paddingBottom:2,fontWeight:500},SC1:{width:90,height:25,margin:"3px 10px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SC2:{width:80},SC3:{width:200,height:25,"& input":{fontSize:"12px !important"}},SC4:{width:200,height:25,"& input":{fontSize:"12px !important",textAlign:"right"}},SC5:{fontSize:12,paddingBottom:2,fontWeight:500,marginLeft:5},SC6:{width:150,height:25,"& input":{fontSize:"12px !important",textAlign:"center"}},SC7:{width:80,height:29,margin:"3px 1px",backgroundColor:"#e0ecff",color:"#163971",padding:5,fontSize:"12px",alignItems:"center",fontWeight:600,display:"flex"},SC8:{"& textarea":{fontSize:"12px !important"}}};function ge(){const{$UserStore:e}=ce(),[d,E]=g.exports.useState({SchAccunit:"",SchFactory:"",SchFrDate:new Date,SchToDate:new Date,SchWriting:"Y",SchType:"0",SchText:""}),[s,h]=g.exports.useState({Accunit:"001",Factory:e.user.factory,ExpExpenseno:"",ExpExpenseDate:new Date,GeneDate:new Date,Slpdat:"",Slipyn:"",LCNO:"",CINO:"",Custcd:"",Mediator:"",Pno:e.user.userid,Deptcd:"",CrePno:"",CreDate:"",ModPno:"",ModDate:"",Amand:"",Shipdeg:"",RemarkM:"",Pnonm:e.user.username.trim(),Deptnm:"",Mediatornm:"",Custnm:"",CustList:"",ApprDocProg:""}),[y,f]=g.exports.useState(""),[p,A]=g.exports.useState(!1),[S,v]=g.exports.useState(!1),[Y,P]=g.exports.useState({visible:!1,desc:"",type:"N"}),[H,k]=g.exports.useState({visible:!1,desc:"",id:""}),[F]=g.exports.useState([{value:"0",text:"\uC791\uC131\uC77C"},{value:"1",text:"\uC791\uC131\uBC88\uD638"},{value:"2",text:"\uAC70\uB798\uCC98\uBA85"},{value:"3",text:"\uBD80\uC11C\uBA85"}]),[U]=g.exports.useState({ExpExpenseDate:"required",GeneDate:"required",Pnonm:"required",Deptnm:"required"}),L=["CiCustnm","CINO","Jukyonm","Jukyocd","Protypenm","Currnm","Banknm","Custnm","Deptnm","Vatnm"],W=["No","CINO","Jukyocd","Jukyonm"],ee=["KorCostAmt","Tax","Total"],te=["No","CINO","KorCostAmt","Total"],Q=["103011","103013","103015"],R=["Exchange","CostAmt"],Z=["Amount"],[J,ae]=g.exports.useState({visible:!1,description:"",value:"",datas:{},id:"",viewId:"",selectedData:{}});return{searchVO:d,setSearchVO:E,headerVO:s,setHeaderVO:h,gridFocus:y,setGridFocus:f,alert:Y,setAlert:P,attachView:p,setAttachView:A,printView:S,setPrintView:v,confirm:H,setConfirm:k,cboSchType:F,ValidationRules:U,helperField:L,validationField1:W,validationField2:ee,vatField:Q,calcField1:R,calcField2:Z,codeClassInputs:J,setCodeClassInputs:ae,keyConfigField:te}}const _e=(e,d,E)=>{d({SchAccunit:"",SchFactory:"",SchFrDate:N().clone().startOf("month").toDate(),SchToDate:new Date,SchWriting:"Y",SchType:"0",SchText:""},50),E({Accunit:"001",Factory:e.User.user.factory,ExpExpenseno:"",ExpExpenseDate:new Date,GeneDate:new Date,Slpdat:"",Slipyn:"",LCNO:"",CINO:"",Custcd:"",Mediator:"",Pno:e.User.user.userid,Deptcd:e.User.user.deptcd,CrePno:"",CreDate:"",ModPno:"",ModDate:"",Amand:"",Shipdeg:"",RemarkM:"",Pnonm:e.User.user.username.trim(),Deptnm:e.User.user.deptnm,Mediatornm:"",Custnm:"",CustList:"",ApprDocProg:""},50),document.getElementById(e.Util.Common.fMakeId("RemarkM")).maxLength=120},Oe=(e,d)=>{d({Accunit:"001",Factory:e.User.user.factory,ExpExpenseno:"",ExpExpenseDate:new Date,GeneDate:new Date,Slpdat:"",Slipyn:"",LCNO:"",CINO:"",Custcd:"",Mediator:"",Pno:e.User.user.userid,Deptcd:e.User.user.deptcd,CrePno:"",CreDate:"",ModPno:"",ModDate:"",Amand:"",Shipdeg:"",RemarkM:"",Pnonm:e.User.user.username,Deptnm:e.User.user.deptnm,Mediatornm:"",Custnm:"",CustList:"",ApprDocProg:""},50)},le=async(e,d,E,s,h,y,f)=>{if(e.Util.Common.fValidate(!N(d.SchFrDate,"YYYY-MM-DD").isValid()||!N(d.SchToDate,"YYYY-MM-DD").isValid(),"\uC870\uD68C\uAE30\uAC04\uC744 \uBC14\uB974\uAC8C \uC785\uB825\uD574 \uC8FC\uC138\uC694.")||e.Util.Common.fValidate(N(d.SchFrDate).format("YYYYMMDD")>N(d.SchToDate).format("YYYYMMDD"),"\uC870\uD68C\uAE30\uAC04\uC744 \uD655\uC778\uD574 \uC8FC\uC138\uC694."))return;const p={...d};if(f!=null&&f!=null&&f!=""){const A=N(f.current).format("YYYY-MM-DD"),S=N(d.SchFrDate).format("YYYY-MM-DD"),v=N(d.SchToDate).format("YYYY-MM-DD");A<S?(p.SchFrDate=N(A).format("YYYYMMDD"),Ee(A,"fr",e,E)):A>v&&(p.SchToDate=N(A).format("YYYYMMDD"),Ee(A,"to",e,E))}y!=null&&y!=null&&y!=""&&(p.SchWriting=y.current==="\uACB0\uC7AC \xB7 \uC9C4\uD589\uC911"?"":p.SchWriting),p.SchFrDate=N(p.SchFrDate).format("YYYYMMDD"),p.SchToDate=N(p.SchToDate).format("YYYYMMDD"),p.SchAccunit=e.User.user.accunit,p.SchFactory=e.User.user.factory,await e.Util.Command.fSearch(s,"/@api/expense/exportexpenses/selectByList",p,h)},Ee=(e,d,E,s)=>{d==="fr"?E.Util.Common.fFieldChange(s,"SchFrDate",e):E.Util.Common.fFieldChange(s,"SchToDate",e)},Ae=async(e,d,E,s)=>{try{const y=(await se.get("/@api/expense/exportexpenses/selectByDetailList",{params:{SchExpenseNo:s,SchAccunit:e.User.user.accunit,SchFactory:e.User.user.factory,UserId:e.User.user.userid}})).data;y.dList.forEach(f=>{(f.ExchangeDate===void 0||f.ExchangeDate==="Invalid date")&&(f.ExchangeDate="")}),y.dList===void 0||y.dList.length<1?e.Util.Grid.fNewRow(d,{No:"001"}):d.setRows(y.dList),E.clearCurrent()}catch{e.setAlert({visible:!0,desc:"\uC0C1\uC138\uB0B4\uC5ED \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}},Ke=async(e,d,E,s,h,y,f,p,A,S)=>{p.commit(!0);const v={...s};v.ExpExpenseDate=N(s.ExpExpenseDate).format("YYYYMMDD"),v.GeneDate=N(s.GeneDate).format("YYYYMMDD"),v.Accunit=e.User.user.accunit,v.Factory=e.User.user.factory,v.UserId=e.User.user.userid;let Y=[];if(e.Util.Grid.fCheckGridData(y,Y,A,"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9 \uC0C1\uC138")===void 0)try{const k=(await se.post("/@api/expense/exportexpenses/updateByList",{header:v,detail:Y})).data;if(k.errmess!==""){e.setAlert({visible:!0,desc:k.errmess,type:"E"});return}const F=k.ExpExpenseno?k.ExpExpenseno.trim():s.ExpExpenseno.trim();e.setAlert({visible:!0,desc:"\uBB38\uC11C \uC800\uC7A5\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),setTimeout(()=>{le(e,d,E,h,"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9 \uBAA9\uB85D","",S),e.setHeaderVO({...s,ExpExpenseno:F}),setTimeout(async()=>{const U=h.searchData({fields:["ExpExpenseno"],value:F,partialMatch:!0});U!=null&&f.setCurrent({dataRow:U.dataRow,column:0})},500)},700)}catch(H){e.setAlert({visible:!0,desc:`\uC800\uC7A5 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${H}`})}},He=async(e,d,E,s,h)=>{const y={...E};y.Accunit=e.User.user.accunit,y.Factory=e.User.user.factory;try{const p=(await se.post("/@api/expense/exportexpenses/deleteByList",{data:y})).data;return p.errmess!==""?(e.setAlert({visible:!0,desc:p.errmess,type:"E"}),p):(p.errmess===""&&await e.Util.Command.fDeleteFiles("ExportExpenses",p.List),setTimeout(async()=>{await le(e,d,"",s,"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9 \uBAA9\uB85D"),h.setCurrent({dataRow:0,column:0})},700),p)}catch(f){e.setAlert({visible:!0,desc:`\uC0AD\uC81C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${f}`})}},Je=async(e,d,E,s,h)=>{const y={...d};y.Accunit=e.User.user.accunit,y.Factory=e.User.user.factory,await e.Util.Command.fDeleteCheckItem(E,s,"/@api/expense/exportexpenses/deleteByItem",y,"\uBD80\uB300\uBE44\uC6A9 \uC0C1\uC138\uB0B4\uC5ED"),setTimeout(()=>{Ae(e,s,E,h)},100)},ze=async(e,d,E)=>{const s={...d};s.SchFrDate=N(s.SchFrDate).format("YYYYMMDD"),s.SchToDate=N(s.SchToDate).format("YYYYMMDD"),s.SchAccunit=e.User.user.accunit,s.SchFactory=e.User.user.factory;try{const h=await e.Util.Command.fSearchByReturn("/@api/expense/exportexpenses/selectByPrint",s);if(!h)e.setAlert({visible:!0,desc:"\uCD9C\uB825\uC790\uB8CC \uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."});else{E(!0);const y='{ "data": '+JSON.stringify(h)+" }";e.Util.Report.fReport(y,"/\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9\uB300\uC7A5.mrd","http://report.ehansun.co.kr/ReportingServer","http://hseerp.ehansun.co.kr/report")}}catch{e.setAlert({visible:!0,desc:"\uC790\uB8CC \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"W"})}},We=me(e=>{const d="EXPORTEXPENSES",E=g.exports.useRef(null),s=g.exports.useRef(0),{$CommonStore:h,$UserStore:y}=ce(),[f,p]=g.exports.useState({visible:!1,desc:"",type:"N"}),{headerVO:A,helperField:S,validationField1:v,validationField2:Y,vatField:P,calcField1:H,codeClassInputs:k,setCodeClassInputs:F,keyConfigField:U}=ge(),L=async(a,t,n)=>{if(!(a<0||!t||!n))try{const m=(await se.get("/@api/expense/exportexpenses/selectByExchange",{params:{SchAccunit:y.user.accunit,SchCurrcd:t,SchExchangeDate:N(n).format("YYYYMMDD")}})).data;m&&(i.setValue(a,"Exchange",m.Rate),setTimeout(()=>{W(a)},100))}catch{p({visible:!0,desc:"\uD658\uC728\uC815\uBCF4 \uC870\uD68C\uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.",type:"E"})}},W=a=>{const t=i.getJsonRow(a);if(t.Exchange!==void 0&&t.CostAmt!==void 0){let n=0;P.includes(t.Vatcd)&&(n=Math.round(Math.round(t.Exchange*t.CostAmt)*.1)),i.setValue(a,"KorCostAmt",Math.round(t.Exchange*t.CostAmt)),i.setValue(a,"Amount",Math.round(t.Exchange*t.CostAmt)),i.setValue(a,"Total",Math.round(t.Exchange*t.CostAmt)+n),e.Util.Grid.fSetMultiDataProvider(i,a,{Tax:n})}},ee=async()=>{w.commit(!0);const a=k.selectedData,t=a.dataRow,n=h.Codeclass.selData,C=i.getJsonRow(a.dataRow);if(a.column==="CiCustnm")e.Util.Grid.fSetMultiDataProvider(i,a.dataRow,{CiCustcd:n.custcd.trim(),CiCustnm:n.custnm});else if(a.column==="CINO")e.Util.Grid.fSetMultiDataProvider(i,a.dataRow,{CINO:n.cino.trim(),CiCustcd:n.imcustcd.trim(),CiCustnm:n.imcustnm}),w.setCurrent({dataRow:t,column:"Jukyonm"});else if(a.column==="Jukyonm")e.Util.Grid.fSetMultiDataProvider(i,a.dataRow,{Jukyocd:n.jukyocd,Jukyonm:n.jukyonm}),w.setCurrent({dataRow:t,column:"Protypenm"});else if(a.column==="Protypenm")e.Util.Grid.fSetDataProvider(i,a.dataRow,["Protype","Protypenm"],n);else if(a.column==="Currnm"){e.Util.Grid.fSetDataProvider(i,a.dataRow,["Currcd","Currnm"],n);const m=i.getValue(a.dataRow,"Currcd");L(a.dataRow,n.minorcd,C.ExchangeDate);let u=0;if(m!=="057001"&&m!==void 0)W(a.dataRow);else if(m==="057001"){const B=i.getValue(a.dataRow,"Vatcd");P.includes(B)&&(u=Math.round(Math.round(1*C.CostAmt)*.1)),i.setValue(a.dataRow,"Exchange",1),e.Util.Grid.fSetMultiDataProvider(i,a.dataRow,{Currcd:n.minorcd,Currnm:n.minornm,Exchange:1,KorCostAmt:Math.round(1*C.CostAmt),Amount:Math.round(1*C.CostAmt),Tax:u,ToTal:Math.round(1*C.CostAmt)+u})}}else if(a.column==="Banknm")e.Util.Grid.fSetMultiDataProvider(i,a.dataRow,{Bankcd:n.minorcd,Banknm:n.minornm,Accountno:n.item1}),w.setCurrent({dataRow:t,column:"Custnm"});else if(a.column==="Custnm")e.Util.Grid.fSetMultiDataProvider(i,a.dataRow,{Custcd:n.custcd.trim(),Custnm:n.custnm});else if(a.column==="Deptnm")e.Util.Grid.fSetMultiDataProvider(i,a.dataRow,{Deptcd:n.deptcd,Deptnm:n.deptnm});else if(a.column==="Vatnm"){const m=i.getValue(a.dataRow,"KorCostAmt"),u=i.getValue(a.dataRow,"Amount");let B=0;P.includes(n.minorcd)&&(B=Math.round(m*.1)),e.Util.Grid.fSetMultiDataProvider(i,a.dataRow,{Vatcd:n.minorcd,Vatnm:n.minornm,Tax:B,Total:u+B})}F({visible:!1,desc:"",value:"",datas:{},selectedData:{},id:"",viewId:""}),w.commit(!0),w.validateCells(),w.setFocus()},te=()=>{const a=w.getCurrent().itemIndex;w.setCurrent({itemIndex:a,fieldName:w.getCurrent().fieldName}),w.setFocus(),w.validateCells(),F({visible:!1})},Q=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),i=new l.exports.LocalDataProvider(!1),w=new l.exports.GridView(E.current),e.Util.Grid.fInitGridDetail(w,i,e.GridFields,e.GridColumns,Z,J,ae),w.setFooters({visible:!0}),w.displayOptions.rowHeight=25,w.setRowIndicator({visible:!1}),w.onCellClicked=function(a,t){t.dataRow>=0&&e.setGridFocus("D")},w.onValidateColumn=(a,t,n,C)=>{const m={};return v.includes(t.fieldName)?(!C||C===void 0)&&(m.level="warning",m.message="\uD544\uC218 \uC785\uB825 \uAC12\uC785\uB2C8\uB2E4."):Y.includes(t.fieldName)&&C===void 0&&(m.level="warning",m.message="\uD544\uC218 \uC785\uB825 \uAC12\uC785\uB2C8\uB2E4."),m},w.columnByField("Exchange").styleCallback=R,w.columnByField("CostAmt").styleCallback=R,w.orderBy([],[]),i.onRowInserted=(a,t)=>{e.Util.Grid.fSetMultiDataProvider(a,t,{No:Ve(t+1).format("000"),ToFactory:y.user.factory,ExchangeDate:N(A.ExpExpenseDate).format("YYYY-MM-DD"),Currcd:"057001",Currnm:"KOR",Exchange:1,CostAmt:0})},e.DataProviderBind(i),e.GridViewBind(w)},R=(a,t)=>{const n=a.getValue(t._index._itemIndex,"Currcd");let C={};return n==="057001"?(C.numberFormat="#,##0",C.editor={type:"number",editFormat:"#,##0"}):n==="057003"?(C.numberFormat="#,##0.####",C.editor={type:"number",editFormat:"#,##0.####"}):(C.numberFormat="#,##0.##",C.editor={type:"number",editFormat:"#,##0.##"}),C},Z=async(a,t)=>{a.commit(),e.setGridFocus("D");const n=a.getValue(a.getCurrent().itemIndex,t.fieldName);let C={};if(t.fieldName==="CiCustnm")C=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperCust,d,n,!0);else if(t.fieldName==="CINO"){const u=e.Util.CodeHelper.fRedefHelper(e.Util.CodeHelper.helperCino,{iInCode2:n,iInCode3:a.getValue(a.getCurrent().itemIndex,"CiCustcd")});C=await e.Util.Grid.gridCodeClass(a.getCurrent(),u,d,n,!0)}else t.fieldName==="Jukyonm"?C=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperJukyoNm,d,n,!0):t.fieldName==="Protypenm"?C=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperProtypeNm,d,n,!0):t.fieldName==="Currnm"?C=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperCurrNm,d,n,!0):t.fieldName==="Banknm"?C=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperBankDNm,d,n,!0):t.fieldName==="Custnm"?C=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperCust,d,n,!0):t.fieldName==="Deptnm"?C=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperDeptNm,d,n,!0):t.fieldName==="Vatnm"&&(C=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperExpenseVatNm,d,n,!0));let m=0;C.datas[0].map(u=>{m+=Number(u.Size)}),s.current=m<490?490:m+100,F(C)},J=async(a,t)=>{a.commit(),e.setGridFocus("D");const n=a.getCurrent(),C=a.getValue(n.itemIndex,n.column),m=i.getJsonRow(t);if((C===null||C==="")&&(n.column==="CiCustnm"?e.Util.Grid.fSetDataProvider(i,n.dataRow,["CiCustcd","CiCustnm"],void 0):n.column==="CINO"?e.Util.Grid.fSetDataProvider(i,n.dataRow,["CINO","CiCustcd","CiCustnm"],void 0):n.column==="Jukyonm"?e.Util.Grid.fSetDataProvider(i,n.dataRow,["Jukyocd","Jukyonm"],void 0):n.column==="Protypenm"?e.Util.Grid.fSetDataProvider(i,n.dataRow,["Protype","Protypenm"],void 0):n.column==="Currnm"?e.Util.Grid.fSetDataProvider(i,n.dataRow,["Currcd","Currnm"],void 0):n.column==="Banknm"?e.Util.Grid.fSetDataProvider(i,n.dataRow,["Bankcd","Banknm","Accountno"],void 0):n.column==="Custnm"?e.Util.Grid.fSetDataProvider(i,n.dataRow,["Custcd","Custnm"],void 0):n.column==="Deptnm"?e.Util.Grid.fSetDataProvider(i,n.dataRow,["Deptcd","Deptnm"],void 0):n.column==="Vatnm"&&(e.Util.Grid.fSetMultiDataProvider(i,n.dataRow,{Vatcd:void 0,Vatnm:void 0,Tax:0}),i.setValue(t,"Total",i.getValue(t,"Amount")))),H.includes(n.column)){const u=i.getJsonRow(t);let B=0;u.Exchange!==void 0&&u.CostAmt!==void 0&&u.CostAmt!==0?(P.includes(u.Vatcd)&&(B=Math.round(u.Exchange*u.CostAmt*.1)),i.setValue(t,"KorCostAmt",Math.round(u.Exchange*u.CostAmt)),i.setValue(t,"Amount",Math.round(u.Exchange*u.CostAmt)),i.setValue(t,"Tax",B),i.setValue(t,"Total",Math.round(u.Exchange*u.CostAmt)+B)):(P.includes(u.Vatcd)&&(B=Math.round(u.KorCostAmt*.1)),i.setValue(t,"Amount",u.CostAmt),i.setValue(t,"KorCostAmt",u.CostAmt*u.Exchange),i.setValue(t,"Tax",B),i.setValue(t,"Total",Math.round(u.KorCostAmt+B)))}else if(n.column==="KorCostAmt"){const u=i.getValue(t,"KorCostAmt");i.setValue(t,"Amount",u),i.setValue(t,"Total",u)}if(n.column==="ExchangeDate"){const u=i.getValue(t,"Currcd");if(u!==void 0){await L(t,u,C);let B=0;P.includes(m.Vatcd)&&(B=Math.round(Math.round(m.Exchange*m.CostAmt)*.1)),i.setValue(t,"KorCostAmt",Math.round(m.Exchange*m.CostAmt)),i.setValue(t,"Amount",Math.round(m.Exchange*m.CostAmt)),i.setValue(t,"Tax",B),i.setValue(t,"Total",Math.round(m.Exchange*m.CostAmt)+B)}}else if(n.column==="Amount"){const u=i.getValue(t,"Amount");let B=0;P.includes(m.Vatcd)&&(B=Math.round(Math.round(u)*.1)),i.setValue(t,"Tax",B),i.setValue(t,"Total",u+B)}else n.column==="Tax"&&i.setValue(t,"Total",i.getValue(t,"Amount")+i.getValue(t,"Tax"));a.validateCells()},ae=async(a,t)=>{const n="Total",C=a.getDataSource().getRowCount(),{fieldName:m}=a.getCurrent(),{itemIndex:u}=a.getCurrent(),B={fieldName:m},oe=i.getJsonRows(),ie=oe.length-1;switch(e.setGridFocus("D"),t.key){case"Enter":if(e.setAlert({visible:!1,desc:""}),a.commit(!0),m===n)e.Util.Grid.fEnterLastField(a,u,C,G()===0);else if(a.getDataSource().getValue(u,m)&&S.includes(m)){a.commit(),a.setCurrent({itemIndex:u,fieldName:m});const M=a.getValue(u,m);let x={};if(M!==""){if(m==="CiCustnm"){if(x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperCust,d,M,!1),!x.visible){const D=x.res;e.Util.Grid.fSetMultiDataProvider(i,u,{CiCustcd:D.custcd.trim(),CiCustnm:D.custnm})}}else if(m==="CINO"){const D=e.Util.Common.fTrim(a.getValue(a.getCurrent().itemIndex,"CiCustcd"));if(x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.fRedefHelper(e.Util.CodeHelper.helperCino,{iInCode2:M,iInCode3:D||null}),d,M,!1),!x.visible){const X=x.res;e.Util.Grid.fSetMultiDataProvider(i,u,{CINO:X.cino.trim(),CiCustcd:X.imcustcd,CiCustnm:X.imcustnm})}}else if(m==="Jukyonm"||m==="Jukyocd"){if(x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperJukyoNm,d,M,!1),!x.visible){const D=x.res;e.Util.Grid.fSetMultiDataProvider(i,u,{Jukyocd:D.jukyocd,Jukyonm:D.jukyonm})}}else if(m==="Protypenm")x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperProtypeNm,d,M,!1),x.visible||e.Util.Grid.fSetDataProvider(i,u,["Protype","Protypenm"],x.res);else if(m==="Currnm"){if(x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperCurrNm,d,M,!1),!x.visible){e.Util.Grid.fSetDataProvider(i,u,["Currcd","Currnm"],x.res);const D=x.res,X=i.getValue(u,"Currcd"),ne=i.getValue(u,"ExchangeDate");L(u,D.minorcd,ne),X!=="057001"||X===void 0||i.setValue(u,"Exchange",1),W(u)}}else if(m==="Banknm"){if(x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperBankDNm,d,M,!1),!x.visible){const D=x.res;e.Util.Grid.fSetMultiDataProvider(i,u,{Bankcd:D.minorcd,Banknm:D.minornm,Accountno:D.item1})}}else if(m==="Custnm"){if(x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperCust,d,M,!1),!x.visible){const D=x.res;e.Util.Grid.fSetMultiDataProvider(i,u,{Custcd:D.custcd.trim(),Custnm:D.custnm})}}else if(m==="Deptnm"){if(x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperDeptNm,d,M,!1),!x.visible){const D=x.res;e.Util.Grid.fSetMultiDataProvider(i,u,{Deptcd:D.deptcd,Deptnm:D.deptnm})}}else if(m==="Vatnm"&&(x=await e.Util.Grid.gridCodeClass(a.getCurrent(),e.Util.CodeHelper.helperExpenseVatNm,d,M,!1),!x.visible)){const D=x.res,X=i.getValue(u,"KorCostAmt"),ne=i.getValue(u,"Amount");let _=0;P.includes(D.minorcd)&&(_=Math.round(X*.1)),e.Util.Grid.fSetMultiDataProvider(i,u,{Vatcd:D.minorcd,Vatnm:D.minornm,Tax:_,Total:ne+_})}let re=0;x.datas[0].map(D=>{re+=Number(D.Size)}),s.current=re<490?490:re+100,F(x),w.validateCells()}}a.setFocus();break;case"Escape":e.Util.Grid.fEscape(a,u,C,"No");break;case"Insert":e.Util.Grid.fKeyInsert(a,u,G()===0,"No");break;case"ArrowDown":e.Util.Grid.fArrowDown(a,u,C,G()===0,"No");break;case"ArrowUp":oe[ie].CINO||oe[ie].Total||e.Util.Grid.fArrowUp(a,u,C,G(u)>0);break;case(t.shiftKey&&t.key==="Tab"):t.preventDefault(),document.getElementById(e.Util.Common.fMakeId("RemarkM")).focus();break;case"Tab":t.preventDefault(),document.getElementById(e.Util.Common.fMakeId("GeneDate")).focus();break;case(t.ctrlKey&&" "):S.includes(m)&&Z(a,B);break}},G=a=>{const t=i.getAllStateRows().created;if(t.length>0){let n=0;return t.map(C=>{if(a===void 0||C>=a){const m=w.getValues(C);for(let u=0;u<U.length;u++)Object.getOwnPropertyDescriptor(m,`${U[u]}`).value||(n+=1),!Object.getOwnPropertyDescriptor(m,`${U[u]}`).value===void 0&&(n+=1)}}),n}return 0};return g.exports.useEffect(()=>{Q()},[]),o.createElement(o.Fragment,null,o.createElement(Se,{visible:k.visible,description:k.desc,value:k.value,datas:k.datas,id:k.id,viewId:k.viewId,selectedData:k.selectedData,width:s.current,onConfirm:ee,onCancel:()=>te({target:k.id})}),o.createElement(c,{ref:E,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:390}}))});let i,w;const $e=me(e=>{const d=g.exports.useRef(null),E=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),Ce=new l.exports.LocalDataProvider(!1),j=new l.exports.GridView(d.current),e.Util.Grid.fInitGridHeader(j,Ce,e.GridFields,e.GridColumns,30,h,y,f,e.GridTitle),j.setRowIndicator({visible:!1}),j.setDisplayOptions({fitStyle:"none"}),j.setRowStyleCallback(s),j.onCellDblClicked=()=>{setTimeout(()=>{document.getElementById(e.Util.Common.fMakeId("GeneDate")).focus()},100)},e.DataProviderBind(Ce),e.GridViewBind(j)},s=(p,A)=>{const S=p.getValue(A.index,"ApprDocProg");if(S==="\uC644\uACB0")return"rg-column-color-3";if(S==="\uC9C4\uD589\uC911")return"rg-column-color-2";if(S==="\uBC18\uB824")return"rg-column-color-1"},h=async(p,A,S)=>{S>=0&&e.RowChanged(p,S)},y=async(p,A)=>{e.currentIndex.current===A.dataRow&&A.dataRow>=0&&e.RowChanged(p,A.dataRow)},f=async(p,A)=>{switch(A.key){case(A.shiftKey&&"Tab"):document.getElementById(e.Util.Common.fMakeId("SchText")).focus();break;case"Tab":setTimeout(()=>{document.getElementById(e.Util.Common.fMakeId("radioBox")).focus()},0);break}};return g.exports.useEffect(()=>{E()},[]),o.createElement(o.Fragment,null,o.createElement(c,{ref:d,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:664}}))});let Ce,j;const it=me(()=>{const e="EXPORTEXPENSES",{$CommonStore:d,$UserStore:E}=ce(),s=qe(),{searchVO:h,setSearchVO:y,headerVO:f,setHeaderVO:p,gridFocus:A,setGridFocus:S,alert:v,setAlert:Y,attachView:P,setAttachView:H,printView:k,setPrintView:F,confirm:U,setConfirm:L,cboSchType:W,ValidationRules:ee}=ge(),te={No:"No",CiCustnm:"\uC218\uCD9C\uAC70\uB798\uCC98",CINO:"CINO",Jukyocd:"\uD68C\uACC4\uCC98\uB9AC\uCF54\uB4DC",KorCostAmt:"\uC6D0\uD654\uAE08\uC561",Amount:"\uACF5\uAE09\uAC00\uC561",Total:"\uD569\uACC4\uAE08\uC561"},Q=g.exports.useRef(0),R=g.exports.useRef(null),Z=g.exports.useRef(null),J=g.exports.useRef("\uC791\uC131\uC911"),ae=g.exports.useRef(!1),G=g.exports.useRef(null),a=g.exports.useRef(!0),t=new Re(e,Y,!0,!0,!0,!0,!0),n=async()=>{_e(C,y,p),R.current="",setTimeout(()=>{document.getElementById(C.Util.Common.fMakeId("SchFrDate")).focus()},300),t.Grid.fNewRow($,{No:"001"}),t.Common.fSetTabIndex(),document.getElementById(t.Common.fMakeId("RemarkM")).maxLength=60},[C]=g.exports.useState({Util:t,User:E,Common:d,fInit:n,setAlert:Y,setHeaderVO:p}),m=r=>{O=r},u=r=>{$=r},B=r=>{z=r},oe=r=>{b=r},ie=(r,T)=>{z.commit(),b.commit(),S("H"),$.clearRows();const I=O.getJsonRow(T);R.current===I.ExpExpenseno&&(a.current=!a.current),R.current=I.ExpExpenseno,J.current=I.DocStatus,d.fSetBinding(!0),p(I),d.fSetBinding(!1),Ae(C,$,b,I.ExpExpenseno),setTimeout(()=>{Q.current=T},100)},M=()=>{L({visible:!1,desc:"",id:""})},x=async()=>{if(L({visible:!1,desc:"",id:""}),U.id==="SAVE"){const r=await Ke(C,h,y,f,O,$,z,b,te,G);R.current=r}else U.id==="DELETE"?await He(C,h,f,O,z):U.id==="DELETE_ITEM"&&await Je(C,f,b,$,R.current)},re=r=>{y(I=>({...I,SchText:r}));let T="";h.SchType==="0"?T=O.searchData({fields:["ExpExpenseDate"],value:r,partialMatch:!1}):h.SchType==="1"?T=O.searchData({fields:["ExpExpenseno"],value:r,partialMatch:!0}):h.SchType==="2"?T=O.searchData({fields:["CustList"],value:r,partialMatch:!0}):h.SchType==="3"&&(T=O.searchData({fields:["Deptnm"],value:r,partialMatch:!0})),T!=null&&z.setCurrent({dataRow:T.dataRow,column:0})},D=r=>{const T=$.getAllStateRows().created;if(T.length>0){let I=0;return T.map(K=>{if(r===void 0||K>=r){const q=b.getValues(K);(!q.CiCustcd||q.CiCustcd===void 0||!q.CINO||q.CINO===void 0||!q.Total||q.Total===void 0||q.Total<1)&&(I+=1)}}),I}return 0},X=(r,T,I)=>{if(!d.fGetBinding())switch(r){case"Pnonm":t.Common.fMultiFieldChange(p,{Pno:T,Pnonm:I});break;case"Deptnm":t.Common.fMultiFieldChange(p,{Deptcd:T,Deptnm:I});break}},ne=r=>{J.current=r,y({...h}),_("N","checked"),le(C,h,y,O,"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9 \uBAA9\uB85D",J,G).then(()=>{const T=O.searchData({fields:["ExpExpenseno"],value:R.current,partialMatch:!0});T!=null&&z.setCurrent({dataRow:T.dataRow,column:0})})},_=(r,T)=>{T&&y({...h,SchWriting:r})},we=r=>{r.preventDefault(),r.key==="1"&&_("Y","checked"),r.key==="2"&&_("N","checked"),r.shiftKey&&r.key==="Tab"?(r.preventDefault(),z.setFocus()):r.key==="Tab"&&document.getElementById(t.Common.fMakeId("SchFrDate")).focus();const T=["Y","N"];if(r.key==="ArrowRight"){let K=T.indexOf(h.SchWriting)+1;K>1&&(K=1),_(T[K],"checked")}else if(r.key==="ArrowLeft"){let K=T.indexOf(h.SchWriting)-1;K<0&&(K=0),_(T[K],"checked")}},de=()=>{Oe(C,p),J.current="\uACB0\uC7AC",R.current="",G.current=new Date,t.Grid.fNewRow($,{No:"001"}),setTimeout(()=>{document.getElementById(t.Common.fMakeId("ExpExpenseDate")).focus()},100)},pe=async()=>{de(),await le(C,h,y,O,"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9 \uBAA9\uB85D"),setTimeout(()=>{document.getElementById(t.Common.fMakeId("SchText")).focus()},100)},fe=async()=>{t.Common.fValidate(!N(f.ExpExpenseDate,"YYYY-MM-DD").isValid(),"\uC791\uC131\uC77C\uC790\uAC00 \uC81C\uB300\uB85C \uC785\uB825\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.")||t.Common.fValidate(!N(f.GeneDate,"YYYY-MM-DD").isValid(),"\uBE44\uC6A9\uBC1C\uC0DD\uC77C\uC774 \uC81C\uB300\uB85C \uC785\uB825\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.")||t.Common.fValidateElements({Deptnm:"\uBD80\uC11C\uBA85",Pnonm:"\uC0AC\uC6D0\uBA85"})||((G.current===null||G.current==="")&&(G.current=f.ExpExpenseDate),L({visible:!0,desc:"\uC800\uC7A5 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",id:"SAVE"}))},he=async()=>{if(!t.Common.fValidate(!f.ExpExpenseno,"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9\uC774 \uC120\uD0DD\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.")){if(A==="H")L({visible:!0,desc:`\uC8FC\uC758) ${R.current} \uBB38\uC11C\uB97C \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`,id:"DELETE"});else if(A==="D"){if(b.commit(!0),t.Common.fValidate(b.getCheckedItems(!0).length<1,"\uC0AD\uC81C\uD560 \uC138\uBD80\uB0B4\uC5ED\uC744 \uC120\uD0DD\uD558\uC138\uC694."))return;L({visible:!0,desc:`${R.current} \uC0C1\uC138\uB0B4\uC5ED\uC744 \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`,id:"DELETE_ITEM"})}}},ye=async()=>{await ze(C,h,F)},Be=async()=>{t.Common.fValidate(t.Common.fEmptyReturn(R.current)==="",`\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9\uBC88\uD638\uAC00 \uC120\uD0DD\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4. 
\uD655\uC778\uD574 \uC8FC\uC2ED\uC2DC\uC624.`)||H(!0)},Ne=()=>{H(!1)};return g.exports.useEffect(()=>{t.Common.fHotKey(d,d.isPopup,de,pe,fe,he,ye)},[d.HotKey]),g.exports.useEffect(()=>(n(),()=>{d.fSetHotKey()}),[]),o.createElement(o.Fragment,null,o.createElement(be,{pgmid:e,onNew:de,onSearch:pe,onSave:fe,onDelete:he,onPrint:ye,onAttachment:Be}),o.createElement(xe,{className:"mainCon"},o.createElement(V.exports.Layout,{style:{width:"100%",height:"100%"}},o.createElement(V.exports.LayoutPanel,{region:"west",split:!0,style:{minWidth:350,width:400,maxWidth:555,height:775}},o.createElement(xe,null,o.createElement(c,{style:{marginLeft:5,marginTop:5,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SA1,style:{width:70}},o.createElement(c,{className:s.SA2},"\uACB0\uC7AC\uC0C1\uD0DC")),o.createElement(c,{style:{height:25,border:"1px solid #9ac9ed",borderRadius:5,color:"#434343",width:"234px",display:"flex",padding:5,marginLeft:5},id:t.Common.fMakeId("radioBox"),className:"inputCls",onKeyDown:r=>we(r)},o.createElement(c,{display:"flex",alignItems:"center"},o.createElement(V.exports.RadioButton,{style:{width:"15px",height:"15px"},inputId:t.Common.fMakeId("Radio0"),value:"Y",groupValue:h.SchWriting,onChange:r=>_("Y",r)}),o.createElement(V.exports.Label,{htmlFor:t.Common.fMakeId("Radio0"),style:{marginLeft:"3px",width:120,fontSize:"12px"}},"\uC791\uC131\uC911+\uBC18\uB824\uBB38\uC11C")),o.createElement(c,{display:"flex",alignItems:"center"},o.createElement(V.exports.RadioButton,{style:{width:"15px",height:"15px"},inputId:t.Common.fMakeId("Radio1"),value:"N",groupValue:h.SchWriting,onChange:r=>_("N",r)}),o.createElement(V.exports.Label,{htmlFor:t.Common.fMakeId("Radio1"),style:{marginLeft:"3px",width:40,fontSize:"12px"}},"\uC804\uCCB4")))),o.createElement(c,{style:{marginLeft:5,marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SA1},o.createElement(c,{className:s.SA2},"\uAE30\uAC04")),o.createElement(c,{style:{display:"flex",alignItems:"center",marginLeft:5}},o.createElement(ue,{inputCls:"inputCls",selected:h.SchFrDate,inputId:t.Common.fMakeId("SchFrDate"),onHandleDateChange:r=>t.Common.fFieldChange(y,"SchFrDate",r)}),o.createElement(c,{style:{margin:"0 3px",width:"10px"}},"~"),o.createElement(ue,{inputCls:"inputCls",selected:h.SchToDate,inputId:t.Common.fMakeId("SchToDate"),onHandleDateChange:r=>t.Common.fFieldChange(y,"SchToDate",r)}))),o.createElement(c,{style:{marginLeft:5,marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SA1},o.createElement(c,{className:s.SA2},"\uAC80\uC0C9")),o.createElement(V.exports.ComboBox,{inputCls:"inputCls",inputId:t.Common.fMakeId("SchType"),data:W,value:h.SchType,editable:!1,onChange:r=>t.Common.fFieldChange(y,"SchType",r),onSelectionChange:r=>{t.Common.fGridSort(z,r.value,{0:"ExpExpenseDate",1:"ExpExpenseno",2:"CustList",3:"Deptnm"}),setTimeout(()=>{document.getElementById(t.Common.fMakeId("SchText")).focus()},100)},panelStyle:{height:130},className:s.SA4,style:{marginLeft:5}}),o.createElement(c,{onKeyDown:r=>{r.shiftKey&&r.key==="Tab"?(r.preventDefault(),document.getElementById(t.Common.fMakeId("SchType")).focus()):r.key==="Tab"&&(r.preventDefault(),z.setFocus())}},o.createElement(V.exports.TextBox,{inputCls:"inputCls",inputId:t.Common.fMakeId("SchText"),className:s.SA5,onChange:r=>re(r),value:h.SchText}))),o.createElement(c,{style:{marginTop:5}},o.createElement($e,{Util:t,Id:"Grid1",GridTitle:"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9",currentIndex:Q,GridFields:Fe,GridColumns:Ge,RowChanged:ie,DataProviderBind:m,GridViewBind:B})))),o.createElement(V.exports.LayoutPanel,{region:"center",style:{height:775}},o.createElement(c,{style:{paddingLeft:0}},o.createElement(c,{style:{display:"flex"}},o.createElement(V.exports.Form,{ref:Z,style:{maxWidth:"100%"},model:f,rules:ee},o.createElement(c,{style:{width:"100%",height:"100%",borderRadius:"5px",display:"flex",flexDirection:"column"}},o.createElement(c,{style:{marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"\uC791\uC131\uBC88\uD638")),o.createElement(V.exports.TextBox,{inputCls:"inputCls",name:"ExpExpenseno",inputId:t.Common.fMakeId("ExpExpenseno"),value:f.ExpExpenseno,onChange:r=>t.Common.fFieldChange(p,"ExpExpenseno",r),className:s.SC3,disabled:!0})),o.createElement(c,{style:{marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"\uC791\uC131\uC77C\uC790",o.createElement(De,{style:{marginLeft:25,color:"#ffa8a8"},size:10}))),o.createElement(ue,{inputCls:"inputCls",selected:f.ExpExpenseDate,inputId:t.Common.fMakeId("ExpExpenseDate"),disabled:!!R.current,onHandleDateChange:r=>{t.Common.fFieldChange(p,"ExpExpenseDate",r),G.current=r},style:{width:160},inputRequired:!0})),o.createElement(c,{style:{marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"\uC804\uD45C\uC77C\uC790")),o.createElement(V.exports.TextBox,{inputCls:"inputCls",name:"Slpdat",editable:!1,value:f.Slpdat,className:s.SC3,disabled:!0})),o.createElement(c,{style:{marginTop:3,display:"flex",alignItems:"center"},onKeyDown:r=>{r.shiftKey&&r.keyCode===9&&(r.preventDefault(),b.setFocus())}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"\uBE44\uC6A9\uBC1C\uC0DD\uC77C",o.createElement(De,{style:{marginLeft:14,color:"#ffa8a8"},size:10}))),o.createElement(ue,{inputCls:"inputCls",selected:f.GeneDate,inputId:t.Common.fMakeId("GeneDate"),onHandleDateChange:r=>t.Common.fFieldChange(p,"GeneDate",r),style:{width:160},inputRequired:!0})),o.createElement(Te,{inputCls:"inputCls",pgmid:e,inputType:"Pno",id:"Pnonm",title:"\uC0AC\uC6D0\uBA85",helper:t.CodeHelper.helperPnoNm2,ComponentCode:f.Pno,ComponentValue:f.Pnonm.trim(),SetValue:X,labelStyles:{width:90,height:25,margin:"3px 10px 5px 10px",padding:5,fontSize:12,display:"flex",alignItems:"center",fontWeight:600},inputStyles:{width:200,margin:"0px 0px 5px 0px"},inputRequired:!0}),o.createElement(Te,{inputCls:"inputCls",pgmid:e,inputType:"Dept",id:"Deptnm",title:"\uBD80\uC11C\uBA85",helper:t.CodeHelper.helperDeptNm,ComponentCode:f.Deptcd,ComponentValue:f.Deptnm,SetValue:X,labelStyles:{width:90,height:25,margin:"3px 10px 5px 10px",padding:5,fontSize:12,display:"flex",alignItems:"center",fontWeight:600},inputStyles:{width:200,margin:"0px 0px 5px 0px"},inputRequired:!0}),o.createElement(c,{style:{marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"Amand")),o.createElement(V.exports.TextBox,{inputCls:"inputCls",name:"Amand",inputId:t.Common.fMakeId("Amand"),value:f.Amand,onChange:r=>t.Common.fFieldChange(p,"Amand",r),className:s.SC3})),o.createElement(c,{style:{marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"\uC120\uC801\uCC28\uC218")),o.createElement(V.exports.TextBox,{inputCls:"inputCls",name:"Shipdeg",inputId:t.Common.fMakeId("Shipdeg"),value:f.Shipdeg,onChange:r=>t.Common.fFieldChange(p,"Shipdeg",r),className:s.SC3})),o.createElement(c,{style:{marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"\uCD5C\uCD08\uC791\uC131\uC77C")),o.createElement(V.exports.TextBox,{inputCls:"inputCls",name:"CreDate",editable:!1,value:N(f.CreDate,"YYYY-MM-DD").isValid()?N(f.CreDate).format("YYYY-MM-DD"):"",className:s.SC3,disabled:!0})),o.createElement(c,{style:{marginTop:3,display:"flex",alignItems:"center"}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"\uCD5C\uC885\uC218\uC815\uC77C")),o.createElement(V.exports.TextBox,{inputCls:"inputCls",name:"ModDate",editable:!1,value:N(f.ModDate,"YYYY-MM-DD").isValid()?N(f.ModDate).format("YYYY-MM-DD"):"",className:s.SC3,disabled:!0})),o.createElement(c,{style:{marginTop:3,marginBottom:5,display:"flex",alignItems:"center"},onKeyDown:r=>{!d.isShift&&r.key==="Tab"&&setTimeout(()=>{S("R1"),b.setFocus();const T=b.getDataSource().getRowCount();if(T<=0){const{itemIndex:I}=b.getCurrent();t.Grid.fArrowDown(b,I,T,D()===0,"No")}b.setCurrent({itemIndex:0,column:0})},0)}},o.createElement(c,{className:s.SC1},o.createElement(c,{className:s.SC2},"\uBE44\uACE0")),o.createElement(V.exports.TextBox,{inputCls:"inputCls",name:"RemarkM",inputId:t.Common.fMakeId("RemarkM"),value:f.RemarkM,onChange:r=>t.Common.fFieldChange(p,"RemarkM",r),className:s.SC3,placeholder:"\uCD5C\uB300 60\uC790",style:{width:400}}))))),o.createElement(c,{onKeyDown:r=>{r.shiftKey&&r.keyCode===9&&(r.preventDefault(),document.getElementById(t.Common.fMakeId("RemarkM")).focus())}},o.createElement(We,{Util:t,Id:"Grid2",GridTitle:"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9 \uC138\uBD80\uB0B4\uC5ED",GridFields:Ye,GridColumns:Le,setGridFocus:S,setAlert:Y,DataProviderBind:u,GridViewBind:oe})))),o.createElement(V.exports.LayoutPanel,{region:"east",title:J.current,collapsible:!0,collapsed:!0,expander:!0,style:{width:400}},o.createElement(c,{style:{marginTop:10}},o.createElement(Pe,{PGMID:e,Init:ae.current,ApprovalType:"A",ApprovalDocNo:R.current,ApprovalDocSource:"EE",ApprovalDocFlag:"A",AttachmentsKeyName:"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9\uBC88\uD638",RetrieveFlag:a.current,SetTitle:ne,isImageComponent:!0,isAttachments:!0,filepath:"ExportExpenses"}))))),P&&o.createElement(Me,{PGMID:e,FileTitle:"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9\uBC88\uD638",FileType:"EE",FileNo:R.current,FilePath:"ExportExpenses",setClose:Ne}),k&&o.createElement(V.exports.Dialog,{title:o.createElement(c,{style:{display:"flex"}},o.createElement("img",{src:Ie,alt:"logo",style:{width:"50px"}}),o.createElement(c,{style:{marginLeft:15}},"\uC218\uCD9C\uBD80\uB300\uBE44\uC6A9\uB300\uC7A5 \uCD9C\uB825")),style:{width:"1870px",height:"900px"},bodyCls:"f-column",closable:!0,draggable:!0,modal:!0,onClose:()=>F(!1)},o.createElement(c,{className:"f-full"},o.createElement("div",{id:"crownix-viewer",style:{position:"absolute",width:"100%",height:"100%"}}))),o.createElement(ve,{visible:v.visible,description:v.desc,type:v.type,onConfirm:()=>Y({visible:!1})}),o.createElement(Ue,{visible:U.visible,description:U.desc,onCancel:M,onConfirm:x}))});let O,$,z,b;const qe=ke(Xe);export{it as default};
