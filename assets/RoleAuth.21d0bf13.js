import{r as s,R as t}from"./index.da6908f5.js";import{m as r,h as Q,d as Z,o as v,B as p,c as _,u as ee,U as te,P as L,r as w,A as ae,C as ie}from"./App.11263b70.js";import{C as ne}from"./CommonButton.0b792d77.js";import{C as X}from"./CodeHelperPopup.3932fdb9.js";const re=[{fieldName:"Factory",dataType:r.exports.ValueType.TEXT},{fieldName:"KeyNo",dataType:r.exports.ValueType.TEXT},{fieldName:"MenuName",dataType:r.exports.ValueType.TEXT},{fieldName:"PgmId",dataType:r.exports.ValueType.TEXT},{fieldName:"PgmNm",dataType:r.exports.ValueType.TEXT},{fieldName:"PgmGb",dataType:r.exports.ValueType.TEXT},{fieldName:"PgmGbNm",dataType:r.exports.ValueType.TEXT},{fieldName:"Above",dataType:r.exports.ValueType.TEXT},{fieldName:"AboveNm",dataType:r.exports.ValueType.TEXT},{fieldName:"Path",dataType:r.exports.ValueType.TEXT},{fieldName:"Dept",dataType:r.exports.ValueType.TEXT},{fieldName:"SortNo",dataType:r.exports.ValueType.NUMBER},{fieldName:"UseYn",dataType:r.exports.ValueType.TEXT},{fieldName:"Checked",dataType:r.exports.ValueType.TEXT}],oe=[{name:"MenuName",fieldName:"MenuName",type:"data",width:"300",header:{text:"\uBA54\uB274\uBA85",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"PgmId",fieldName:"PgmId",type:"data",width:"300",header:{text:"\uD504\uB85C\uADF8\uB7A8ID",showTooltip:!0},renderer:{type:"text",showTooltip:!0},styleName:"left-column"}],se=[{fieldName:"PgmId",dataType:r.exports.ValueType.TEXT},{fieldName:"RoleId",dataType:r.exports.ValueType.TEXT},{fieldName:"RoleNm",dataType:r.exports.ValueType.TEXT},{fieldName:"UseYn",dataType:r.exports.ValueType.TEXT}],le=[{name:"RoleId",fieldName:"RoleId",type:"data",width:"200",header:{text:"\uAE30\uB2A5",showTooltip:!0},editable:!1,renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"RoleNm",fieldName:"RoleNm",type:"data",width:"250",header:{text:"\uAE30\uB2A5\uBA85",showTooltip:!0},editable:!1,renderer:{type:"text",showTooltip:!0},styleName:"left-column"},{name:"UseYn",fieldName:"UseYn",type:"data",width:"80",editable:!1,styleName:"center-column",header:{text:"\uC0AC\uC6A9\uC720\uBB34",showTooltip:!0},renderer:{type:"check",trueValues:"Y",falseValues:"N"}}],ue={DateTitleBox:{margin:"5px 10px 0px 15px",backgroundColor:"#e0ecff",padding:5,color:"#163971",height:25,fontSize:"12px",display:"flex",width:85,alignItems:"center",fontWeight:600},TitleBox4:{backgroundColor:"#fccf76",color:"#163971",padding:5,height:20,fontSize:"12px",display:"flex",alignItems:"center",width:"100%",fontWeight:600},TitleText3:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},InputBox3:{marginTop:5,width:120,height:25,"& input":{fontSize:"12px !important"}},Scroll:{"& .mainCon":{height:"700px",padding:"10px"}}};function de(){const[e,i]=s.exports.useState({Pno:"",PnoNm:"",PgmGb:"",PgmGbNm:""}),[u]=s.exports.useState({a:"required"}),[l,n]=s.exports.useState(""),[a,d]=s.exports.useState({visible:!1,desc:"",type:"N"}),[m,f]=s.exports.useState({visible:!1,desc:"",id:""}),[x,o]=s.exports.useState({visible:!1,description:"",value:"",datas:{},id:"",viewId:"",selectedData:{}});return String.prototype.DateValidation=function(y){return new Date(this)instanceof Date&&!isNaN(new Date(this))?Q(this).format(y):null},{searchVO:e,setSearchVO:i,gridFocus:l,setGridFocus:n,alert:a,setAlert:d,confirm:m,setConfirm:f,codeClassInputs:x,setCodeClassInputs:o,ValidationRules:u}}const ce=async e=>{e({Pno:"",PnoNm:"",PgmGb:"",PgmGbNm:""},50)},H=async(e,i,u,l)=>{const n={...i},a=await e.Util.Command.fSearchByReturn("/@api/admin/roleAuth/selectByList",n);a!==void 0&&(u.setRows(a,"KeyNo",!0,"","iconField"),l.expandAll())},me=async(e,i,u,l,n)=>{const a={};a.PgmId=u,a.Pno=l,a.PgmGb=n;const d=await e.Util.Command.fSearchByReturn("/@api/admin/roleAuth/selectByDetailList",a);i.setRows(d)},fe=async(e,i,u,l,n,a,d)=>{a.commit(!0);const m={...i};m.PgmId=d,m.Factory=e.User.user.factory,m.iUserPno=e.User.user.userid;let f=[];if(e.Util.Grid.fCheckGridData(l,f,{},"\uAE30\uB2A5\uAD8C\uD55C")===void 0)try{const y=(await Z.post("/@api/admin/roleAuth/updateByList",{header:m,detail:f})).data;if(y.errmess!==""){e.setAlert({visible:!0,desc:y.errmess,type:"E"});return}e.setAlert({visible:!0,desc:"\uBB38\uC11C \uC800\uC7A5\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."}),setTimeout(()=>{setTimeout(async()=>{await H(e,i,u,n);const g=u.searchData({fields:["PgmId"],value:d,partialMatch:!1});g!=null&&n.setCurrent({dataRow:g.dataRow,column:0})},500)},700)}catch(o){e.setAlert({visible:!0,desc:`\uC800\uC7A5 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.${o}`})}},Ce=v(e=>{const i=s.exports.useRef(null),u=[""],l=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),R=new r.exports.LocalTreeDataProvider(!1),T=new r.exports.TreeView(i.current),e.Util.Grid.fInitGridTree(T,R,e.GridFields,e.GridColumns),T.setRowIndicator({visible:!0}),T.displayOptions.rowHeight=27,T.onValidateColumn=(n,a,d,m)=>{const f={};return u[0].includes(a.fieldName)&&(!m||m===void 0)&&(f.level="warning",f.message="\uD544\uC218 \uC785\uB825 \uAC12\uC785\uB2C8\uB2E4."),f},T.onCurrentRowChanged=(n,a,d)=>{d>=0&&e.RowChanged(n,d)},T.onCellClicked=(n,a)=>{e.currentIndex===a.dataRow&&a.dataRow>=0&&e.RowChanged(n,a.dataRow)},e.DataProviderBind(R),e.GridViewBind(T)};return s.exports.useEffect(()=>{l()},[]),t.createElement(t.Fragment,null,t.createElement(p,{ref:i,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:e.Height}}))});let R,T;const pe=v(e=>{const i=s.exports.useRef(null),u=async()=>{e.Util.Grid.fContainerInit(e.Util.Common.fMakeId(e.Id)),S=new r.exports.LocalDataProvider(!1),B=new r.exports.GridView(i.current),e.Util.Grid.fInitGridDetail(B,S,e.GridFields,e.GridColumns,l,n),B.displayOptions.rowHeight=27,B.setCheckBar({visible:!1}),e.DataProviderBind(S),e.GridViewBind(B)},l=async a=>{a.commit()},n=a=>{a.commit(),B.validateCells()};return s.exports.useEffect(()=>{u()},[]),t.createElement(t.Fragment,null,t.createElement(p,{ref:i,key:e.Util.Common.fMakeId(e.Id),id:e.Util.Common.fMakeId(e.Id),style:{width:"100%",height:e.Height}}))});let S,B;const we=v(()=>{const e="ROLEAUTH",{$CommonStore:i,$UserStore:u}=ee(),l=ye(),{searchVO:n,setSearchVO:a,alert:d,setAlert:m,confirm:f,setConfirm:x}=de(),o=new te(e,m,!0,!0,!0,!0,!0),y=s.exports.useRef(""),g=s.exports.useRef(""),G=s.exports.useRef(0),M=s.exports.useRef(0),P=s.exports.useRef(null),V=async()=>{y.current="",g.current="",i.fSetBinding(!0),await ce(a),i.fSetBinding(!1),o.Common.fSetTabIndex()},[b]=s.exports.useState({Util:o,User:u,fInit:V,setAlert:m}),Y=C=>{E=C},O=C=>{N=C},K=C=>{A=C,A.onKeyDown=(c,h)=>{c.commit(),h.code==="Tab"&&!i.fGetShift()&&I.setFocus()}},$=C=>{I=C,I.onKeyDown=(c,h)=>{if(c.commit(),h.code==="Space"){const W=c.getCurrent().itemIndex,j=c.getValue(c.getCurrent().itemIndex,"UseYn");o.Grid.fSetMultiDataProvider(N,W,{UseYn:j==="Y"?"N":"Y"})}}},z=async(C,c)=>{const h=E.getJsonRow(c);setTimeout(async()=>{await me(b,N,h.PgmId,y.current,g.current),G.current=c},0)},q=async()=>{if(x({visible:!1,desc:"",id:""}),f.id==="SAVE"){const C=E.getJsonRow(G.current);await fe(b,n,E,N,A,I,C.PgmId)}},J=()=>{x({visible:!1,desc:"",id:""}),P.current.focus()},D=(C,c,h)=>{if(!i.fGetBinding())switch(C){case"PgmGbNm":o.Common.fMultiFieldChange(a,{PgmGb:c,PgmGbNm:h}),g.current=c;break;case"PnoNm":o.Common.fMultiFieldChange(a,{Pno:c,PnoNm:h}),y.current=c;break}},U=async()=>{V(),o.Common.fProviderClearRows(E),o.Common.fProviderClearRows(N)},k=async()=>{o.Common.fValidate(!n.PnoNm,"\uC0AC\uC6A9\uC790\uAC00 \uC120\uD0DD\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.")||await H(b,n,E,A)},F=async()=>{o.Common.fValidateElements({PnoNm:"\uC0AC\uC6A9\uC790"})||(P.current=document.activeElement,x({visible:!0,desc:"\uC800\uC7A5 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",id:"SAVE"}))};return s.exports.useEffect(()=>{o.Common.fHotKey(i,i.isPopup,U,k,F)},[i.HotKey]),s.exports.useEffect(()=>(V(),()=>{i.fSetHotKey()}),[]),t.createElement(t.Fragment,null,t.createElement(ne,{pgmid:e,visible:"111000",onNew:U,onSearch:k,onSave:F}),t.createElement(L,{className:"mainCon"},t.createElement(w.exports.Layout,{style:{width:"100%",height:775}},t.createElement(w.exports.LayoutPanel,{region:"north",style:{height:47}},t.createElement(L,{className:l.Scroll},t.createElement(p,{style:{marginTop:5}},t.createElement(p,{display:"flex",alignItems:"center"},t.createElement(p,{style:{display:"flex",alignItems:"center"}},t.createElement(X,{inputCls:"inputCls",pgmid:e,inputType:"Pno",id:"PnoNm",title:"\uC0AC\uC6A9\uC790",helper:o.Common.fCreateHelper("B0012","001"),ComponentCode:n.Pno,ComponentValue:n.PnoNm,SetValue:D,labelStyles:{margin:"0px 0px 0px 10px",width:85},inputStyles:{margin:"0px 0px 0px 10px",width:150},inputRequired:!0}),t.createElement(X,{inputCls:"inputCls",pgmid:e,inputType:"",id:"PgmGbNm",title:"\uBAA8\uB4C8",helper:o.Common.fCreateHelper("M003"),ComponentCode:n.PgmGb,ComponentValue:n.PgmGbNm,SetValue:D,labelStyles:{margin:"0px 0px 0px 10px",width:85},inputStyles:{margin:"0px 0px 0px 10px",width:150}})))))),t.createElement(w.exports.LayoutPanel,{region:"center"},t.createElement(w.exports.Layout,null,t.createElement(w.exports.LayoutPanel,{region:"west",style:{width:800,height:775}},t.createElement(p,{className:l.TitleBox4,style:{width:"100%"}},t.createElement(p,{className:l.TitleText3},"\uC0AC\uC6A9\uC790\uBCC4 \uBA54\uB274")),t.createElement(p,null,t.createElement(Ce,{Util:o,Id:"Grid1",GridTitle:"\uD5E4\uB354",Height:707,currentIndex:G,GridFields:re,GridColumns:oe,RowChanged:z,DataProviderBind:Y,GridViewBind:K}))),t.createElement(w.exports.LayoutPanel,{region:"center",style:{marginLeft:20,height:727}},t.createElement(p,{className:l.TitleBox4,style:{width:"100%"}},t.createElement(p,{className:l.TitleText3},"\uC0AC\uC6A9\uC790\uBCC4 \uBA54\uB274\uAE30\uB2A5")),t.createElement(p,null,t.createElement(pe,{Util:o,Id:"Grid2",GridTitle:"\uC0AC\uC6A9\uAE30\uB2A5",Height:705,currentIndex:M,GridFields:se,GridColumns:le,DataProviderBind:O,GridViewBind:$}))))))),t.createElement(ae,{visible:d.visible,description:d.desc,type:d.type,onConfirm:()=>{m({visible:!1}),P.current&&P.current.focus()}}),t.createElement(ie,{visible:f.visible,description:f.desc,onCancel:J,onConfirm:q}))});let E,N,A,I;const ye=_(ue);export{we as default};
